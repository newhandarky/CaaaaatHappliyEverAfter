import{a as L,_ as v}from"./config-1ccbba12.js";import"./admin_header-61c175db.js";import"./admin_searchBar-e91d2b86.js";import{S as y}from"./sweetalert2.all-daafc72c.js";import{h as S}from"./admin_config-2cf1d757.js";import{h as x}from"./moment-fbc5633a.js";let q=document.querySelector(".tbody");const I=document.querySelector(".date"),f=document.querySelector(".before"),M=document.querySelector(".after"),g=document.querySelector(".getPages");let b=`${localStorage.getItem("thisMonth")}`,p=[],a=1,r=0;const $=L.get(`${v}/660/bookings?_expand=user&_expand=room`,S);I.textContent=b;Promise.all([$]).then(([s])=>{console.log(s.data);const u=s.data;let l=0;u.forEach(function(t){if(t.checkIn.startsWith(b)){l++;const e={};e.id=t.id,e.name=t.user.name,e.checkIn=t.checkIn,e.quantity=t.quantity,e.roomName=t.room.name,e.state=t.state,e.price=t.price,e.remark=t.remark,e.userId=t.userId,p.push(e)}}),o(l),h(p.slice(0,8));function o(t){if(t===0)return g.innerHTML="";r=Math.ceil(t/8);let e=` <li class="page-item previous">
                        <a class="page-link py-3 px-6 previous">Previous</a>
                    </li> `,d=`<li class="page-item next">
                        <a class="page-link py-3 px-6 next">Next</a>
                    </li>`,i="";for(let n=1;n<=r;n++)i+=`<li class="page-item pageNum" data-page="${n}"><a class="page-link py-3 px-6"><span class="text-dark">${n}</span></a></li>`;g.innerHTML=e+i+d,k()}function k(){const t=document.querySelector(".previous"),e=document.querySelector(".next"),d=document.querySelector(".pageNum"),i=document.querySelectorAll(".pageNum");a==r&&(t.classList.add("disabled"),e.classList.add("disabled"),d.classList.add("active")),t.classList.add("disabled"),d.classList.add("active"),g.addEventListener("click",function(n){n.target.classList.contains("next")?(a++,a<=r+5&&(a>=r&&(a=r),document.querySelector(".active").classList.remove("active"),i.forEach(function(c){c.dataset.page==a&&c.classList.add("active")}),a==r&&e.classList.add("disabled"),t.classList.remove("disabled"))):n.target.classList.contains("previous")?(a--,a>=-5&&(a<=1&&(a=1),document.querySelector(".active").classList.remove("active"),i.forEach(function(c){c.dataset.page==a&&c.classList.add("active")}),a==1&&t.classList.add("disabled"),e.classList.remove("disabled"))):n.target.classList.contains("page-link")&&(a=n.target.parentElement.dataset.page,document.querySelector(".active").classList.remove("active"),i.forEach(function(c){c.dataset.page==a&&c.classList.add("active")}),a==r?e.classList.add("disabled"):e.classList.remove("disabled"),a==1?t.classList.add("disabled"):t.classList.remove("disabled"));const m=a-1;h(p.slice(m*8,(m+1)*8))})}}).catch(function(s){console.log(s)});function h(s){const u=document.querySelector(".tbody");let l="";s.forEach(function(o){l+=`<tr>
                <th class="text-nowrap border-0 text-center d-flex align-items-center justify-content-center" scope="row"><a class="bookingNum adminLink" data-bookingnum="${o.id}" data-userid="${o.userId}" href="admin_updateBooking.html">${o.id}</a></th>       
                <td class="text-nowrap text-center">${o.name}</td>
                <td class="text-nowrap text-center">${o.checkIn}</td>
                <td class="text-nowrap text-center">${o.quantity}</td>
                <td class="text-nowrap text-center">${o.roomName}</td>
                <td class="text-nowrap text-center">${o.state}</td>
                <td class="text-nowrap text-center">${o.price}</td>
                <td class="text-nowrap text-start">${o.remark}</td>
            </tr>`}),u.innerHTML=l}f.addEventListener("click",function(){let s=x(localStorage.getItem("thisMonth")).add(-1,"month").format("YYYY-MM");if(s==="2023-08"){y.fire({title:"抱歉並無2023-09以前的資料",icon:"error"}),f.setAttribute("disabled",!0);return}localStorage.setItem("thisMonth",s),location.reload()});M.addEventListener("click",function(){let s=x(localStorage.getItem("thisMonth")).add(1,"month").format("YYYY-MM");localStorage.setItem("thisMonth",s),location.reload()});q.addEventListener("click",function(s){s.target.classList.contains("bookingNum")&&(localStorage.setItem("bookingNum",s.target.dataset.bookingnum),localStorage.setItem("bookingUserId",s.target.dataset.userid))});
