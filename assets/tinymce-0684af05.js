var zm={},U4={get exports(){return zm},set exports(rc){zm=rc}};(function(rc){(function(){var Hm=function(e){if(e===null)return"null";if(e===void 0)return"undefined";var t=typeof e;return t==="object"&&(Array.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="Array")?"array":t==="object"&&(String.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="String")?"string":t},fx=function(e){return["undefined","boolean","number","string","function","xml","null"].indexOf(e)!==-1},dx=function(e,t){var n=Array.prototype.slice.call(e);return n.sort(t)},mx=function(e,t){return cr(function(n,s){return e.eq(t(n),t(s))})},cr=function(e){return{eq:e}},gx=cr(function(e,t){return e===t}),px=gx,Wm=function(e){return cr(function(t,n){if(t.length!==n.length)return!1;for(var s=t.length,o=0;o<s;o++)if(!e.eq(t[o],n[o]))return!1;return!0})},hx=function(e,t){return mx(Wm(e),function(n){return dx(n,t)})},Vm=function(e){return cr(function(t,n){var s=Object.keys(t),o=Object.keys(n);if(!hx(px).eq(s,o))return!1;for(var r=s.length,a=0;a<r;a++){var i=s[a];if(!e.eq(t[i],n[i]))return!1}return!0})},ac=cr(function(e,t){if(e===t)return!0;var n=Hm(e),s=Hm(t);return n!==s?!1:fx(n)?e===t:n==="array"?Wm(ac).eq(e,t):n==="object"?Vm(ac).eq(e,t):!1});const bx=Object.getPrototypeOf,jm=(e,t,n)=>{var s;return n(e,t.prototype)?!0:((s=e.constructor)===null||s===void 0?void 0:s.name)===t.name},Cx=e=>{const t=typeof e;return e===null?"null":t==="object"&&Array.isArray(e)?"array":t==="object"&&jm(e,String,(n,s)=>s.isPrototypeOf(n))?"string":t},ic=e=>t=>Cx(t)===e,lc=e=>t=>typeof t===e,qm=e=>t=>e===t,Ha=(e,t)=>Ct(e)&&jm(e,t,(n,s)=>bx(n)===s),Q=ic("string"),Ct=ic("object"),Km=e=>Ha(e,Object),Ge=ic("array"),wt=qm(null),_s=lc("boolean"),lt=qm(void 0),je=e=>e==null,M=e=>!je(e),ke=lc("function"),dn=lc("number"),bo=(e,t)=>{if(Ge(e)){for(let n=0,s=e.length;n<s;++n)if(!t(e[n]))return!1;return!0}return!1},ce=()=>{},kn=(e,t)=>(...n)=>e(t.apply(null,n)),Gm=(e,t)=>n=>e(t(n)),z=e=>()=>e,kt=e=>e,Ym=(e,t)=>e===t;function K(e,...t){return(...n)=>{const s=t.concat(n);return e.apply(null,s)}}const ur=e=>t=>!e(t),Xm=e=>()=>{throw new Error(e)},cc=e=>e(),fr=e=>{e()},$e=z(!1),We=z(!0);class m{constructor(t,n){this.tag=t,this.value=n}static some(t){return new m(!0,t)}static none(){return m.singletonNone}fold(t,n){return this.tag?n(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?m.some(t(this.value)):m.none()}bind(t){return this.tag?t(this.value):m.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:m.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t??"Called getOrDie on None")}static from(t){return M(t)?m.some(t):m.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}m.singletonNone=new m(!1);const uc=Array.prototype.slice,yx=Array.prototype.indexOf,vx=Array.prototype.push,Zm=(e,t)=>yx.call(e,t),Ex=(e,t)=>{const n=Zm(e,t);return n===-1?m.none():m.some(n)},Ne=(e,t)=>Zm(e,t)>-1,Ue=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];if(t(o,n))return!0}return!1},he=(e,t)=>{const n=e.length,s=new Array(n);for(let o=0;o<n;o++){const r=e[o];s[o]=t(r,o)}return s},P=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];t(o,n)}},Qm=(e,t)=>{for(let n=e.length-1;n>=0;n--){const s=e[n];t(s,n)}},Co=(e,t)=>{const n=[],s=[];for(let o=0,r=e.length;o<r;o++){const a=e[o];(t(a,o)?n:s).push(a)}return{pass:n,fail:s}},oe=(e,t)=>{const n=[];for(let s=0,o=e.length;s<o;s++){const r=e[s];t(r,s)&&n.push(r)}return n},dr=(e,t,n)=>(Qm(e,(s,o)=>{n=t(n,s,o)}),n),Tt=(e,t,n)=>(P(e,(s,o)=>{n=t(n,s,o)}),n),Jm=(e,t,n)=>{for(let s=0,o=e.length;s<o;s++){const r=e[s];if(t(r,s))return m.some(r);if(n(r,s))break}return m.none()},Ye=(e,t)=>Jm(e,t,$e),mr=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];if(t(o,n))return m.some(n)}return m.none()},eg=e=>{const t=[];for(let n=0,s=e.length;n<s;++n){if(!Ge(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);vx.apply(t,e[n])}return t},en=(e,t)=>eg(he(e,t)),rs=(e,t)=>{for(let n=0,s=e.length;n<s;++n){const o=e[n];if(t(o,n)!==!0)return!1}return!0},gr=e=>{const t=uc.call(e,0);return t.reverse(),t},Wa=(e,t)=>oe(e,n=>!Ne(t,n)),fc=(e,t)=>{const n={};for(let s=0,o=e.length;s<o;s++){const r=e[s];n[String(r)]=t(r,s)}return n},Ns=(e,t)=>{const n=uc.call(e,0);return n.sort(t),n},Va=(e,t)=>t>=0&&t<e.length?m.some(e[t]):m.none(),Rt=e=>Va(e,0),As=e=>Va(e,e.length-1),Lt=ke(Array.from)?Array.from:e=>uc.call(e),yo=(e,t)=>{for(let n=0;n<e.length;n++){const s=t(e[n],n);if(s.isSome())return s}return m.none()},Sx=(e,t)=>{const n=[],s=ke(t)?o=>Ue(n,r=>t(r,o)):o=>Ne(n,o);for(let o=0,r=e.length;o<r;o++){const a=e[o];s(a)||n.push(a)}return n},Pt=Object.keys,wx=Object.hasOwnProperty,Te=(e,t)=>{const n=Pt(e);for(let s=0,o=n.length;s<o;s++){const r=n[s],a=e[r];t(a,r)}},ja=(e,t)=>kx(e,(n,s)=>({k:s,v:t(n,s)})),kx=(e,t)=>{const n={};return Te(e,(s,o)=>{const r=t(s,o);n[r.k]=r.v}),n},dc=e=>(t,n)=>{e[n]=t},tg=(e,t,n,s)=>{Te(e,(o,r)=>{(t(o,r)?n:s)(o,r)})},xx=(e,t)=>{const n={},s={};return tg(e,t,dc(n),dc(s)),{t:n,f:s}},pr=(e,t)=>{const n={};return tg(e,t,dc(n),ce),n},qa=(e,t)=>{const n=[];return Te(e,(s,o)=>{n.push(t(s,o))}),n},mc=e=>qa(e,kt),Pe=(e,t)=>re(e,t)?m.from(e[t]):m.none(),re=(e,t)=>wx.call(e,t),vo=(e,t)=>re(e,t)&&e[t]!==void 0&&e[t]!==null,_x=(e,t,n=ac)=>Vm(n).eq(e,t),ng=e=>{const t={};return P(e,n=>{t[n]={}}),Pt(t)},sg=e=>e.length!==void 0,gc=Array.isArray,Nx=e=>{if(gc(e))return e;{const t=[];for(let n=0,s=e.length;n<s;n++)t[n]=e[n];return t}},Ka=(e,t,n)=>{if(!e)return!1;if(n=n||e,sg(e)){for(let s=0,o=e.length;s<o;s++)if(t.call(n,e[s],s,e)===!1)return!1}else for(const s in e)if(re(e,s)&&t.call(n,e[s],s,e)===!1)return!1;return!0},pc=(e,t)=>{const n=[];return Ka(e,(s,o)=>{n.push(t(s,o,e))}),n},hr=(e,t)=>{const n=[];return Ka(e,(s,o)=>{(!t||t(s,o,e))&&n.push(s)}),n},Ax=(e,t)=>{if(e){for(let n=0,s=e.length;n<s;n++)if(e[n]===t)return n}return-1},Ga=(e,t,n,s)=>{let o=lt(n)?e[0]:n;for(let r=0;r<e.length;r++)o=t.call(s,o,e[r],r);return o},og=(e,t,n)=>{for(let s=0,o=e.length;s<o;s++)if(t.call(n,e[s],s,e))return s;return-1},Ts=e=>e[e.length-1],Rs=e=>{let t=!1,n;return(...s)=>(t||(t=!0,n=e.apply(null,s)),n)},Tx=(e,t,n,s)=>{const o=e.isiOS()&&/ipad/i.test(n)===!0,r=e.isiOS()&&!o,a=e.isiOS()||e.isAndroid(),i=a||s("(pointer:coarse)"),l=o||!r&&a&&s("(min-device-width:768px)"),c=r||a&&!l,u=t.isSafari()&&e.isiOS()&&/safari/i.test(n)===!1,f=!c&&!l&&!u;return{isiPad:z(o),isiPhone:z(r),isTablet:z(l),isPhone:z(c),isTouch:z(i),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:z(u),isDesktop:z(f)}},Rx=(e,t)=>{for(let n=0;n<e.length;n++){const s=e[n];if(s.test(t))return s}},Px=(e,t)=>{const n=Rx(e,t);if(!n)return{major:0,minor:0};const s=o=>Number(t.replace(n,"$"+o));return hc(s(1),s(2))},Dx=(e,t)=>{const n=String(t).toLowerCase();return e.length===0?rg():Px(e,n)},rg=()=>hc(0,0),hc=(e,t)=>({major:e,minor:t}),br={nu:hc,detect:Dx,unknown:rg},Bx=(e,t)=>yo(t.brands,n=>{const s=n.brand.toLowerCase();return Ye(e,o=>{var r;return s===((r=o.brand)===null||r===void 0?void 0:r.toLowerCase())}).map(o=>({current:o.name,version:br.nu(parseInt(n.version,10),0)}))}),ag=(e,t)=>{const n=String(t).toLowerCase();return Ye(e,s=>s.search(n))},Ox=(e,t)=>ag(e,t).map(n=>{const s=br.detect(n.versionRegexes,t);return{current:n.name,version:s}}),Ix=(e,t)=>ag(e,t).map(n=>{const s=br.detect(n.versionRegexes,t);return{current:n.name,version:s}}),Lx=(e,t)=>e.substring(t),ig=(e,t,n)=>t===""||e.length>=t.length&&e.substr(n,n+t.length)===t,lg=(e,t)=>ct(e,t)?Lx(e,t.length):e,dt=(e,t,n=0,s)=>{const o=e.indexOf(t,n);return o!==-1?lt(s)?!0:o+t.length<=s:!1},ct=(e,t)=>ig(e,t,0),bc=(e,t)=>ig(e,t,e.length-t.length),Cc=e=>t=>t.replace(e,""),Eo=Cc(/^\s+|\s+$/g),$x=Cc(/^\s+/g),cg=Cc(/\s+$/g),xn=e=>e.length>0,Cr=e=>!xn(e),Fx=(e,t)=>t<=0?"":new Array(t+1).join(e),Ya=(e,t=10)=>{const n=parseInt(e,t);return isNaN(n)?m.none():m.some(n)},yc=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Hn=e=>t=>dt(t,e),Mx=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>dt(e,"edge/")&&dt(e,"chrome")&&dt(e,"safari")&&dt(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,yc],search:e=>dt(e,"chrome")&&!dt(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>dt(e,"msie")||dt(e,"trident")},{name:"Opera",versionRegexes:[yc,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Hn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Hn("firefox")},{name:"Safari",versionRegexes:[yc,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(dt(e,"safari")||dt(e,"mobile/"))&&dt(e,"applewebkit")}],Ux=[{name:"Windows",search:Hn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>dt(e,"iphone")||dt(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Hn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:Hn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Hn("linux"),versionRegexes:[]},{name:"Solaris",search:Hn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Hn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Hn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ug={browsers:z(Mx),oses:z(Ux)},fg="Edge",dg="Chromium",mg="IE",gg="Opera",pg="Firefox",hg="Safari",zx=()=>bg({current:void 0,version:br.unknown()}),bg=e=>{const t=e.current,n=e.version,s=o=>()=>t===o;return{current:t,version:n,isEdge:s(fg),isChromium:s(dg),isIE:s(mg),isOpera:s(gg),isFirefox:s(pg),isSafari:s(hg)}},Cg={unknown:zx,nu:bg,edge:z(fg),chromium:z(dg),ie:z(mg),opera:z(gg),firefox:z(pg),safari:z(hg)},yg="Windows",vg="iOS",Eg="Android",Sg="Linux",wg="macOS",kg="Solaris",xg="FreeBSD",_g="ChromeOS",Hx=()=>Ng({current:void 0,version:br.unknown()}),Ng=e=>{const t=e.current,n=e.version,s=o=>()=>t===o;return{current:t,version:n,isWindows:s(yg),isiOS:s(vg),isAndroid:s(Eg),isMacOS:s(wg),isLinux:s(Sg),isSolaris:s(kg),isFreeBSD:s(xg),isChromeOS:s(_g)}},Ag={unknown:Hx,nu:Ng,windows:z(yg),ios:z(vg),android:z(Eg),linux:z(Sg),macos:z(wg),solaris:z(kg),freebsd:z(xg),chromeos:z(_g)},Wx={detect:(e,t,n)=>{const s=ug.browsers(),o=ug.oses(),r=t.bind(l=>Bx(s,l)).orThunk(()=>Ox(s,e)).fold(Cg.unknown,Cg.nu),a=Ix(o,e).fold(Ag.unknown,Ag.nu),i=Tx(a,r,e,n);return{browser:r,os:a,deviceType:i}}},Vx=e=>window.matchMedia(e).matches;let jx=Rs(()=>Wx.detect(navigator.userAgent,m.from(navigator.userAgentData),Vx));const _n=()=>jx(),qx=navigator.userAgent,vc=_n(),Nn=vc.browser,An=vc.os,Ps=vc.deviceType,Kx=qx.indexOf("Windows Phone")!==-1,be={transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",documentMode:Nn.isIE()?document.documentMode||7:10,cacheSuffix:null,container:null,canHaveCSP:!Nn.isIE(),windowsPhone:Kx,browser:{current:Nn.current,version:Nn.version,isChromium:Nn.isChromium,isEdge:Nn.isEdge,isFirefox:Nn.isFirefox,isIE:Nn.isIE,isOpera:Nn.isOpera,isSafari:Nn.isSafari},os:{current:An.current,version:An.version,isAndroid:An.isAndroid,isChromeOS:An.isChromeOS,isFreeBSD:An.isFreeBSD,isiOS:An.isiOS,isLinux:An.isLinux,isMacOS:An.isMacOS,isSolaris:An.isSolaris,isWindows:An.isWindows},deviceType:{isDesktop:Ps.isDesktop,isiPad:Ps.isiPad,isiPhone:Ps.isiPhone,isPhone:Ps.isPhone,isTablet:Ps.isTablet,isTouch:Ps.isTouch,isWebView:Ps.isWebView}},Gx=/^\s*|\s*$/g,Tg=e=>je(e)?"":(""+e).replace(Gx,""),Yx=(e,t)=>t?t==="array"&&gc(e)?!0:typeof e===t:e!==void 0,Xx=(e,t,n={})=>{const s=Q(e)?e.split(t||","):e||[];let o=s.length;for(;o--;)n[s[o]]={};return n},Zx=re,Qx=(e,...t)=>{for(let n=0;n<t.length;n++){const s=t[n];for(const o in s)if(re(s,o)){const r=s[o];r!==void 0&&(e[o]=r)}}return e},Rg=function(e,t,n,s){s=s||this,e&&(n&&(e=e[n]),Ka(e,(o,r)=>t.call(s,o,r,n)===!1?!1:(Rg(o,t,n,s),!0)))},$={trim:Tg,isArray:gc,is:Yx,toArray:Nx,makeMap:Xx,each:Ka,map:pc,grep:hr,inArray:Ax,hasOwn:Zx,extend:Qx,walk:Rg,resolve:(e,t=window)=>{const n=e.split(".");for(let s=0,o=n.length;s<o&&(t=t[n[s]],!!t);s++);return t},explode:(e,t)=>Ge(e)?e:e===""?[]:pc(e.split(t||","),Tg),_addCacheSuffix:e=>{const t=be.cacheSuffix;return t&&(e+=(e.indexOf("?")===-1?"?":"&")+t),e}},So=(e,t,n=Ym)=>e.exists(s=>n(s,t)),Pg=(e,t,n=Ym)=>mt(e,t,n).getOr(e.isNone()&&t.isNone()),Jx=e=>{const t=[],n=s=>{t.push(s)};for(let s=0;s<e.length;s++)e[s].each(n);return t},mt=(e,t,n)=>e.isSome()&&t.isSome()?m.some(n(e.getOrDie(),t.getOrDie())):m.none(),e_=(e,t,n,s)=>e.isSome()&&t.isSome()&&n.isSome()?m.some(s(e.getOrDie(),t.getOrDie(),n.getOrDie())):m.none(),wo=(e,t)=>e?m.some(t):m.none(),t_=typeof window<"u"?window:Function("return this;")(),n_=(e,t)=>{let n=t??t_;for(let s=0;s<e.length&&n!==void 0&&n!==null;++s)n=n[e[s]];return n},Dg=(e,t)=>{const n=e.split(".");return n_(n,t)},s_=(e,t)=>Dg(e,t),o_=(e,t)=>{const n=s_(e,t);if(n==null)throw new Error(e+" not available on this browser");return n},r_=Object.getPrototypeOf,a_=e=>o_("HTMLElement",e),i_=e=>{const t=Dg("ownerDocument.defaultView",e);return Ct(e)&&(a_(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(r_(e).constructor.name))},Bg=8,Og=9,Ig=11,yr=1,Lg=3,pe=e=>e.dom.nodeName.toLowerCase(),$g=e=>e.dom.nodeType,Xa=e=>t=>$g(t)===e,l_=e=>$g(e)===Bg||pe(e)==="#comment",Za=e=>$t(e)&&i_(e.dom),$t=Xa(yr),Ht=Xa(Lg),c_=Xa(Og),u_=Xa(Ig),Qa=e=>t=>$t(t)&&pe(t)===e,Fg=(e,t,n)=>{if(Q(n)||_s(n)||dn(n))e.setAttribute(t,n+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple")},st=(e,t,n)=>{Fg(e.dom,t,n)},Wn=(e,t)=>{const n=e.dom;Te(t,(s,o)=>{Fg(n,o,s)})},Ft=(e,t)=>{const n=e.dom.getAttribute(t);return n===null?void 0:n},Vn=(e,t)=>m.from(Ft(e,t)),vr=(e,t)=>{const n=e.dom;return n&&n.hasAttribute?n.hasAttribute(t):!1},ot=(e,t)=>{e.dom.removeAttribute(t)},f_=e=>{const t=e.dom.attributes;return t==null||t.length===0},Mg=e=>Tt(e.dom.attributes,(t,n)=>(t[n.name]=n.value,t),{}),Ec=(e,t)=>{const n=Ft(e,t);return n===void 0||n===""?[]:n.split(" ")},d_=(e,t,n)=>{const o=Ec(e,t).concat([n]);return st(e,t,o.join(" ")),!0},m_=(e,t,n)=>{const s=oe(Ec(e,t),o=>o!==n);return s.length>0?st(e,t,s.join(" ")):ot(e,t),!1},Er=e=>e.dom.classList!==void 0,Ug=e=>Ec(e,"class"),zg=(e,t)=>d_(e,"class",t),Hg=(e,t)=>m_(e,"class",t),g_=(e,t)=>Ne(Ug(e),t)?Hg(e,t):zg(e,t),ko=(e,t)=>{Er(e)?e.dom.classList.add(t):zg(e,t)},Wg=e=>{(Er(e)?e.dom.classList:Ug(e)).length===0&&ot(e,"class")},Sr=(e,t)=>{Er(e)?e.dom.classList.remove(t):Hg(e,t),Wg(e)},p_=(e,t)=>{const n=Er(e)?e.dom.classList.toggle(t):g_(e,t);return Wg(e),n},Sc=(e,t)=>Er(e)&&e.dom.classList.contains(t),h_=(e,t)=>{const s=(t||document).createElement("div");if(s.innerHTML=e,!s.hasChildNodes()||s.childNodes.length>1){const o="HTML does not have a single root node";throw console.error(o,e),new Error(o)}return wr(s.childNodes[0])},b_=(e,t)=>{const s=(t||document).createElement(e);return wr(s)},C_=(e,t)=>{const s=(t||document).createTextNode(e);return wr(s)},wr=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},C={fromHtml:h_,fromTag:b_,fromText:C_,fromDom:wr,fromPoint:(e,t,n)=>m.from(e.dom.elementFromPoint(t,n)).map(wr)},Vg=(e,t)=>{const n=[],s=r=>(n.push(r),t(r));let o=t(e);do o=o.bind(s);while(o.isSome());return n},mn=(e,t)=>{const n=e.dom;if(n.nodeType!==yr)return!1;{const s=n;if(s.matches!==void 0)return s.matches(t);if(s.msMatchesSelector!==void 0)return s.msMatchesSelector(t);if(s.webkitMatchesSelector!==void 0)return s.webkitMatchesSelector(t);if(s.mozMatchesSelector!==void 0)return s.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},jg=e=>e.nodeType!==yr&&e.nodeType!==Og&&e.nodeType!==Ig||e.childElementCount===0,y_=(e,t)=>{const n=t===void 0?document:t.dom;return jg(n)?[]:he(n.querySelectorAll(e),C.fromDom)},v_=(e,t)=>{const n=t===void 0?document:t.dom;return jg(n)?m.none():m.from(n.querySelector(e)).map(C.fromDom)},ve=(e,t)=>e.dom===t.dom,jn=(e,t)=>{const n=e.dom,s=t.dom;return n===s?!1:n.contains(s)},qg=e=>C.fromDom(e.dom.ownerDocument),qn=e=>c_(e)?e:qg(e),E_=e=>C.fromDom(qn(e).dom.documentElement),kr=e=>C.fromDom(qn(e).dom.defaultView),tn=e=>m.from(e.dom.parentNode).map(C.fromDom),Ja=e=>m.from(e.dom.parentElement).map(C.fromDom),Kg=(e,t)=>{const n=ke(t)?t:$e;let s=e.dom;const o=[];for(;s.parentNode!==null&&s.parentNode!==void 0;){const r=s.parentNode,a=C.fromDom(r);if(o.push(a),n(a)===!0)break;s=r}return o},S_=e=>{const t=n=>oe(n,s=>!ve(e,s));return tn(e).map(rt).map(t).getOr([])},Ds=e=>m.from(e.dom.previousSibling).map(C.fromDom),xr=e=>m.from(e.dom.nextSibling).map(C.fromDom),Gg=e=>gr(Vg(e,Ds)),Yg=e=>Vg(e,xr),rt=e=>he(e.dom.childNodes,C.fromDom),xo=(e,t)=>{const n=e.dom.childNodes;return m.from(n[t]).map(C.fromDom)},wc=e=>xo(e,0),kc=e=>xo(e,e.dom.childNodes.length-1),xc=e=>e.dom.childNodes.length,w_=e=>e.dom.hasChildNodes(),k_=e=>{const t=e.dom.head;if(t==null)throw new Error("Head is not available yet");return C.fromDom(t)},_c=e=>u_(e)&&M(e.dom.host),Xg=ke(Element.prototype.attachShadow)&&ke(Node.prototype.getRootNode),x_=z(Xg),as=Xg?e=>C.fromDom(e.dom.getRootNode()):qn,Nc=e=>_c(e)?e:k_(qn(e)),__=e=>_c(e)?e:C.fromDom(qn(e).dom.body),N_=e=>{const t=as(e);return _c(t)?m.some(t):m.none()},A_=e=>C.fromDom(e.dom.host),Zg=e=>{if(x_()&&M(e.target)){const t=C.fromDom(e.target);if($t(t)&&T_(t)&&e.composed&&e.composedPath){const n=e.composedPath();if(n)return Rt(n)}}return m.from(e.target)},T_=e=>M(e.dom.shadowRoot),_o=e=>{const t=Ht(e)?e.dom.parentNode:e.dom;if(t==null||t.ownerDocument===null)return!1;const n=t.ownerDocument;return N_(C.fromDom(t)).fold(()=>n.body.contains(t),Gm(_o,A_))};var Qg=(e,t,n,s,o)=>e(n,s)?m.some(n):ke(o)&&o(n)?m.none():t(n,s,o);const Kn=(e,t,n)=>{let s=e.dom;const o=ke(n)?n:$e;for(;s.parentNode;){s=s.parentNode;const r=C.fromDom(s);if(t(r))return m.some(r);if(o(r))break}return m.none()},Bs=(e,t,n)=>Qg((o,r)=>r(o),Kn,e,t,n),R_=(e,t)=>{const n=e.dom;return n.parentNode?P_(C.fromDom(n.parentNode),s=>!ve(e,s)&&t(s)):m.none()},P_=(e,t)=>{const n=o=>t(C.fromDom(o));return Ye(e.dom.childNodes,n).map(C.fromDom)},Jg=(e,t)=>{const n=s=>{for(let o=0;o<s.childNodes.length;o++){const r=C.fromDom(s.childNodes[o]);if(t(r))return m.some(r);const a=n(s.childNodes[o]);if(a.isSome())return a}return m.none()};return n(e.dom)},_r=(e,t,n)=>Kn(e,s=>mn(s,t),n),Nr=(e,t)=>v_(t,e),Os=(e,t,n)=>Qg((o,r)=>mn(o,r),_r,e,t,n),D_=e=>Os(e,"[contenteditable]"),Is=(e,t=!1)=>_o(e)?e.dom.isContentEditable:D_(e).fold(z(t),n=>B_(n)==="true"),B_=e=>e.dom.contentEditable,Ar=e=>e.style!==void 0&&ke(e.style.getPropertyValue),ep=(e,t,n)=>{if(!Q(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Ar(e)&&e.style.setProperty(t,n)},O_=(e,t)=>{Ar(e)&&e.style.removeProperty(t)},tp=(e,t,n)=>{const s=e.dom;ep(s,t,n)},ei=(e,t)=>{const n=e.dom;Te(t,(s,o)=>{ep(n,o,s)})},Tn=(e,t)=>{const n=e.dom,o=window.getComputedStyle(n).getPropertyValue(t);return o===""&&!_o(e)?np(n,t):o},np=(e,t)=>Ar(e)?e.style.getPropertyValue(t):"",ti=(e,t)=>{const n=e.dom,s=np(n,t);return m.from(s).filter(o=>o.length>0)},Ac=e=>{const t={},n=e.dom;if(Ar(n))for(let s=0;s<n.style.length;s++){const o=n.style.item(s);t[o]=n.style[o]}return t},sp=(e,t)=>{const n=e.dom;O_(n,t),So(Vn(e,"style").map(Eo),"")&&ot(e,"style")},I_=e=>e.dom.offsetWidth,Dt=(e,t)=>{tn(e).each(s=>{s.dom.insertBefore(t.dom,e.dom)})},Gn=(e,t)=>{xr(e).fold(()=>{tn(e).each(o=>{Ve(o,t)})},s=>{Dt(s,t)})},Tc=(e,t)=>{wc(e).fold(()=>{Ve(e,t)},s=>{e.dom.insertBefore(t.dom,s.dom)})},Ve=(e,t)=>{e.dom.appendChild(t.dom)},op=(e,t)=>{Dt(e,t),Ve(t,e)},L_=(e,t)=>{P(t,(n,s)=>{const o=s===0?e:t[s-1];Gn(o,n)})},Ls=(e,t)=>{P(t,n=>{Ve(e,n)})},No=e=>{e.dom.textContent="",P(rt(e),t=>{De(t)})},De=e=>{const t=e.dom;t.parentNode!==null&&t.parentNode.removeChild(t)},Yn=e=>{const t=rt(e);t.length>0&&L_(e,t),De(e)},$_=(e,t)=>{const s=(t||document).createElement("div");return s.innerHTML=e,rt(C.fromDom(s))},Rc=e=>he(e,C.fromDom),rp=e=>e.dom.innerHTML,ni=(e,t)=>{const s=qg(e).dom,o=C.fromDom(s.createDocumentFragment()),r=$_(t,s);Ls(o,r),No(e),Ve(e,o)},F_=e=>{const t=C.fromTag("div"),n=C.fromDom(e.dom.cloneNode(!0));return Ve(t,n),rp(t)},M_=(e,t,n,s,o,r,a)=>({target:e,x:t,y:n,stop:s,prevent:o,kill:r,raw:a}),U_=e=>{const t=C.fromDom(Zg(e).getOr(e.target)),n=()=>e.stopPropagation(),s=()=>e.preventDefault(),o=kn(s,n);return M_(t,e.clientX,e.clientY,n,s,o,e)},z_=(e,t)=>n=>{e(n)&&t(U_(n))},H_=(e,t,n,s,o)=>{const r=z_(n,s);return e.dom.addEventListener(t,r,o),{unbind:K(V_,e,t,r,o)}},W_=(e,t,n,s)=>H_(e,t,n,s,!1),V_=(e,t,n,s)=>{e.dom.removeEventListener(t,n,s)},ap=(e,t)=>({left:e,top:t,translate:(s,o)=>ap(e+s,t+o)}),Ao=ap,j_=e=>{const t=e.getBoundingClientRect();return Ao(t.left,t.top)},si=(e,t)=>e!==void 0?e:t!==void 0?t:0,q_=e=>{const t=e.dom.ownerDocument,n=t.body,s=t.defaultView,o=t.documentElement;if(n===e.dom)return Ao(n.offsetLeft,n.offsetTop);const r=si(s==null?void 0:s.pageYOffset,o.scrollTop),a=si(s==null?void 0:s.pageXOffset,o.scrollLeft),i=si(o.clientTop,n.clientTop),l=si(o.clientLeft,n.clientLeft);return Pc(e).translate(a-l,r-i)},Pc=e=>{const t=e.dom,s=t.ownerDocument.body;return s===t?Ao(s.offsetLeft,s.offsetTop):_o(e)?j_(t):Ao(0,0)},Dc=e=>{const t=e!==void 0?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,s=t.body.scrollTop||t.documentElement.scrollTop;return Ao(n,s)},ip=(e,t,n)=>{const o=(n!==void 0?n.dom:document).defaultView;o&&o.scrollTo(e,t)},lp=(e,t)=>{_n().browser.isSafari()&&ke(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(!1):e.dom.scrollIntoView(t)},K_=e=>{const t=e===void 0?window:e;return _n().browser.isFirefox()?m.none():m.from(t.visualViewport)},cp=(e,t,n,s)=>({x:e,y:t,width:n,height:s,right:e+n,bottom:t+s}),up=e=>{const t=e===void 0?window:e,n=t.document,s=Dc(C.fromDom(n));return K_(t).fold(()=>{const o=t.document.documentElement,r=o.clientWidth,a=o.clientHeight;return cp(s.left,s.top,r,a)},o=>cp(Math.max(o.pageLeft,s.left),Math.max(o.pageTop,s.top),o.width,o.height))},G_=(e,t)=>oe(rt(e),t),fp=(e,t)=>{let n=[];return P(rt(e),s=>{t(s)&&(n=n.concat([s])),n=n.concat(fp(s,t))}),n},gt=(e,t)=>y_(t,e),dp=(e,t,n)=>_r(e,t,n).isSome();class Xe{constructor(t,n){this.node=t,this.rootNode=n,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}current(){return this.node}next(t){return this.node=this.findSibling(this.node,"firstChild","nextSibling",t),this.node}prev(t){return this.node=this.findSibling(this.node,"lastChild","previousSibling",t),this.node}prev2(t){return this.node=this.findPreviousNode(this.node,t),this.node}findSibling(t,n,s,o){if(t){if(!o&&t[n])return t[n];if(t!==this.rootNode){let r=t[s];if(r)return r;for(let a=t.parentNode;a&&a!==this.rootNode;a=a.parentNode)if(r=a[s],r)return r}}}findPreviousNode(t,n){if(t){const s=t.previousSibling;if(this.rootNode&&s===this.rootNode)return;if(s){if(!n){for(let r=s.lastChild;r;r=r.lastChild)if(!r.lastChild)return r}return s}const o=t.parentNode;if(o&&o!==this.rootNode)return o}}}const $s=e=>t=>!!t&&t.nodeType===e,oi=e=>!!e&&!Object.getPrototypeOf(e),G=$s(1),Xn=e=>G(e)&&Za(C.fromDom(e)),Y_=e=>G(e)&&e.namespaceURI==="http://www.w3.org/2000/svg",Tr=e=>{const t=e.toLowerCase();return n=>M(n)&&n.nodeName.toLowerCase()===t},gn=e=>{const t=e.map(n=>n.toLowerCase());return n=>{if(n&&n.nodeName){const s=n.nodeName.toLowerCase();return Ne(t,s)}return!1}},ri=(e,t)=>{const n=t.toLowerCase().split(" ");return s=>{if(G(s)){const o=s.ownerDocument.defaultView;if(o)for(let r=0;r<n.length;r++){const a=o.getComputedStyle(s,null);if((a?a.getPropertyValue(e):null)===n[r])return!0}}return!1}},mp=e=>t=>G(t)&&t.hasAttribute(e),X_=(e,t)=>n=>G(n)&&n.getAttribute(e)===t,Fs=e=>G(e)&&e.hasAttribute("data-mce-bogus"),Z_=e=>G(e)&&e.getAttribute("data-mce-bogus")==="all",Zn=e=>G(e)&&e.tagName==="TABLE",gp=e=>t=>!!(Xn(t)&&(t.contentEditable===e||t.getAttribute("data-mce-contenteditable")===e)),Bc=gn(["textarea","input"]),B=$s(3),Q_=$s(4),J_=$s(7),is=$s(8),Rr=$s(9),Oc=$s(11),Me=Tr("br"),pp=Tr("img"),nn=gp("true"),Be=gp("false"),ai=gn(["td","th"]),eN=gn(["td","th","caption"]),Rn=gn(["video","audio","object","embed"]),tN=Tr("li"),Ic=Tr("details"),nN=Tr("summary"),Pr="\uFEFF",Je=" ",Lc=e=>e===Pr,sN=e=>e.replace(/\uFEFF/g,""),$c=((e,t)=>{const n=r=>{if(!e(r))throw new Error("Can only get "+t+" value of a "+t+" node");return s(r).getOr("")},s=r=>e(r)?m.from(r.dom.nodeValue):m.none();return{get:n,getOption:s,set:(r,a)=>{if(!e(r))throw new Error("Can only set raw "+t+" value of a "+t+" node");r.dom.nodeValue=a}}})(Ht,"text"),ii=e=>$c.get(e),hp=e=>$c.getOption(e),oN=(e,t)=>$c.set(e,t),rN=["td","th"],aN=["thead","tbody","tfoot"],iN=["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"],lN=["li","dd","dt"],cN=["ul","ol","dl"],uN=["pre","script","textarea","style"],To=e=>{let t;return n=>(t=t||fc(e,We),re(t,pe(n)))},fN=e=>pe(e)==="table",Ms=e=>$t(e)&&pe(e)==="br",bp=To(iN),Fc=To(cN),Dr=To(lN),dN=To(aN),Br=To(rN),li=To(uN),mN=e=>{const t=[];let n=e.dom;for(;n;)t.push(C.fromDom(n)),n=n.lastChild;return t},gN=e=>{const t=gt(e,"br"),n=oe(mN(e).slice(-1),Ms);t.length===n.length&&P(n,De)},Or=()=>{const e=C.fromTag("br");return st(e,"data-mce-bogus","1"),e},ls=e=>{No(e),Ve(e,Or())},pN=(e,t)=>{kc(e).each(n=>{Ds(n).each(s=>{t.isBlock(pe(e))&&Ms(n)&&t.isBlock(pe(s))&&De(n)})})},Ze=Pr,ci=Lc,Mt=sN,hN=e=>e.insertContent(Ze,{preserve_zwsp:!0}),bN=G,Ro=B,Po=e=>(Ro(e)&&(e=e.parentNode),bN(e)&&e.hasAttribute("data-mce-caret")),cs=e=>Ro(e)&&ci(e.data),Wt=e=>Po(e)||cs(e),Cp=e=>e.firstChild!==e.lastChild||!Me(e.firstChild),CN=(e,t)=>{var n;const o=((n=e.ownerDocument)!==null&&n!==void 0?n:document).createTextNode(Ze),r=e.parentNode;if(t){const a=e.previousSibling;if(Ro(a)){if(Wt(a))return a;if(fi(a))return a.splitText(a.data.length-1)}r==null||r.insertBefore(o,e)}else{const a=e.nextSibling;if(Ro(a)){if(Wt(a))return a;if(ui(a))return a.splitText(1),a}e.nextSibling?r==null||r.insertBefore(o,e.nextSibling):r==null||r.appendChild(o)}return o},Mc=e=>{const t=e.container();return B(t)?t.data.charAt(e.offset())===Ze||e.isAtStart()&&cs(t.previousSibling):!1},Uc=e=>{const t=e.container();return B(t)?t.data.charAt(e.offset()-1)===Ze||e.isAtEnd()&&cs(t.nextSibling):!1},yN=(e,t,n)=>{var s;const r=((s=t.ownerDocument)!==null&&s!==void 0?s:document).createElement(e);r.setAttribute("data-mce-caret",n?"before":"after"),r.setAttribute("data-mce-bogus","all"),r.appendChild(Or().dom);const a=t.parentNode;return n?a==null||a.insertBefore(r,t):t.nextSibling?a==null||a.insertBefore(r,t.nextSibling):a==null||a.appendChild(r),r},ui=e=>Ro(e)&&e.data[0]===Ze,fi=e=>Ro(e)&&e.data[e.data.length-1]===Ze,vN=e=>{var t;const n=e.getElementsByTagName("br"),s=n[n.length-1];Fs(s)&&((t=s.parentNode)===null||t===void 0||t.removeChild(s))},zc=e=>e&&e.hasAttribute("data-mce-caret")?(vN(e),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("data-mce-style"),e.removeAttribute("_moz_abspos"),e):null,yp=e=>Po(e.startContainer),vp=nn,EN=Be,SN=Me,wN=B,kN=gn(["script","style","textarea"]),Ep=gn(["img","input","textarea","hr","iframe","video","audio","object","embed"]),xN=gn(["table"]),_N=Wt,sn=e=>_N(e)?!1:wN(e)?!kN(e.parentNode):Ep(e)||SN(e)||xN(e)||Hc(e),NN=e=>G(e)&&e.getAttribute("unselectable")==="true",Hc=e=>!NN(e)&&EN(e),AN=(e,t)=>{for(let n=e.parentNode;n&&n!==t;n=n.parentNode){if(Hc(n))return!1;if(vp(n))return!0}return!0},TN=e=>Hc(e)?!Tt(Lt(e.getElementsByTagName("*")),(t,n)=>t||vp(n),!1):!1,RN=e=>Ep(e)||TN(e),Sp=(e,t)=>sn(e)&&AN(e,t),PN=/^[ \t\r\n]*$/,us=e=>PN.test(e),DN=e=>{for(const t of e)if(!Lc(t))return!1;return!0},BN=e=>" \f	\v".indexOf(e)!==-1,wp=e=>e===`
`||e==="\r",ON=(e,t)=>t<e.length&&t>=0?wp(e[t]):!1,kp=(e,t=4,n=!0,s=!0)=>{const o=Fx(" ",t),r=e.replace(/\t/g,o);return Tt(r,(i,l)=>BN(l)||l===Je?i.pcIsSpace||i.str===""&&n||i.str.length===r.length-1&&s||ON(r,i.str.length+1)?{pcIsSpace:!1,str:i.str+Je}:{pcIsSpace:!0,str:i.str+" "}:{pcIsSpace:wp(l),str:i.str+l},{pcIsSpace:!1,str:""}).str},IN=(e,t)=>{const n=C.fromDom(t),s=C.fromDom(e);return dp(s,"pre,code",K(ve,n))},LN=(e,t)=>B(e)&&us(e.data)&&!IN(e,t),$N=e=>G(e)&&e.nodeName==="A"&&!e.hasAttribute("href")&&(e.hasAttribute("name")||e.hasAttribute("id")),di=(e,t)=>sn(e)&&!LN(e,t)||$N(e)||FN(e),FN=mp("data-mce-bookmark"),MN=mp("data-mce-bogus"),UN=X_("data-mce-bogus","all"),zN=e=>Ja(C.fromDom(e)).exists(t=>!Is(t)),HN=(e,t)=>{let n=0;if(di(e,e))return!1;{let s=e.firstChild;if(!s)return!0;const o=new Xe(s,e);do{if(t){if(UN(s)){s=o.next(!0);continue}if(MN(s)){s=o.next();continue}}if(nn(s)&&zN(s))return!1;if(Me(s)){n++,s=o.next();continue}if(di(s,e))return!1;s=o.next()}while(s);return n<=1}},ze=(e,t=!0)=>HN(e.dom,t),Us=e=>e.toLowerCase()==="svg",Wc=e=>Us(e.nodeName),xp=e=>(e==null?void 0:e.nodeName)==="svg"?"svg":"html",WN=["svg"],VN=()=>{let e=[];const t=()=>e[e.length-1];return{track:r=>{Wc(r)&&e.push(r);let a=t();return a&&!a.contains(r)&&(e.pop(),a=t()),xp(a)},current:()=>xp(t()),reset:()=>{e=[]}}},mi="data-mce-block",jN=e=>oe(Pt(e),t=>!/[A-Z]/.test(t)),Vc=e=>he(jN(e),t=>`${t}:`+he(WN,n=>`not(${n} ${t})`).join(":")).join(","),_p=(e,t)=>M(t.querySelector(e))?(t.setAttribute(mi,"true"),t.getAttribute("data-mce-selected")==="inline-boundary"&&t.removeAttribute("data-mce-selected"),!0):(t.removeAttribute(mi),!1),Np=(e,t)=>{const n=Vc(e.getTransparentElements()),s=Vc(e.getBlockElements());return oe(t.querySelectorAll(n),o=>_p(s,o))},Ap=(e,t)=>{var n;const s=t?"lastChild":"firstChild";for(let o=e[s];o;o=o[s])if(ze(C.fromDom(o))){(n=o.parentNode)===null||n===void 0||n.removeChild(o);return}},qN=(e,t)=>{const n=document.createRange(),s=e.parentNode;if(s){n.setStartBefore(e),n.setEndBefore(t);const o=n.extractContents();Ap(o,!0),n.setStartAfter(t),n.setEndAfter(e);const r=n.extractContents();Ap(r,!1),ze(C.fromDom(o))||s.insertBefore(o,e),ze(C.fromDom(t))||s.insertBefore(t,e),ze(C.fromDom(r))||s.insertBefore(r,e),s.removeChild(e)}},KN=(e,t,n)=>{const s=e.getBlockElements(),o=C.fromDom(t),r=i=>pe(i)in s,a=i=>ve(i,o);P(Rc(n),i=>{Kn(i,r,a).each(l=>{const c=G_(i,u=>r(u)&&!e.isValidChild(pe(l),pe(u)));if(c.length>0){const u=Ja(l);P(c,f=>{Kn(f,r,a).each(d=>{qN(d.dom,f.dom)})}),u.each(f=>Np(e,f.dom))}})})},GN=(e,t,n)=>{P([...n,...zs(e,t)?[t]:[]],s=>P(gt(C.fromDom(s),s.nodeName.toLowerCase()),o=>{ZN(e,o.dom)&&Yn(o)}))},jc=(e,t)=>{const n=Np(e,t);KN(e,t,n),GN(e,t,n)},YN=(e,t)=>{if(Gc(e,t)){const n=Vc(e.getBlockElements());_p(n,t)}},XN=(e,t,n)=>{const s=r=>ve(r,C.fromDom(t)),o=Kg(C.fromDom(n),s);Va(o,o.length-2).filter($t).fold(()=>jc(e,t),r=>jc(e,r.dom))},qc=e=>e.hasAttribute(mi),Kc=(e,t)=>re(e.getTransparentElements(),t),Gc=(e,t)=>G(t)&&Kc(e,t.nodeName),zs=(e,t)=>Gc(e,t)&&qc(t),ZN=(e,t)=>Gc(e,t)&&!qc(t),Yc=(e,t)=>t.type===1&&Kc(e,t.name)&&Q(t.attr(mi)),QN=_n().browser,Tp=e=>Ye(e,$t),JN=e=>QN.isFirefox()&&pe(e)==="table"?Tp(rt(e)).filter(t=>pe(t)==="caption").bind(t=>Tp(Yg(t)).map(n=>{const s=n.dom.offsetTop,o=t.dom.offsetTop,r=t.dom.offsetHeight;return s<=o?-r:0})).getOr(0):0,Rp=(e,t)=>e.children&&Ne(e.children,t),eA=(e,t,n)=>{let s=0,o=0;const r=e.ownerDocument;if(n=n||e,t){if(n===e&&t.getBoundingClientRect&&Tn(C.fromDom(e),"position")==="static"){const i=t.getBoundingClientRect();return s=i.left+(r.documentElement.scrollLeft||e.scrollLeft)-r.documentElement.clientLeft,o=i.top+(r.documentElement.scrollTop||e.scrollTop)-r.documentElement.clientTop,{x:s,y:o}}let a=t;for(;a&&a!==n&&a.nodeType&&!Rp(a,n);){const i=a;s+=i.offsetLeft||0,o+=i.offsetTop||0,a=i.offsetParent}for(a=t.parentNode;a&&a!==n&&a.nodeType&&!Rp(a,n);)s-=a.scrollLeft||0,o-=a.scrollTop||0,a=a.parentNode;o+=JN(C.fromDom(t))}return{x:s,y:o}},Pp=(e,t={})=>{let n=0;const s={},o=C.fromDom(e),r=qn(o),a=y=>{t.referrerPolicy=y},i=y=>{t.contentCssCors=y},l=y=>{Ve(Nc(o),y)},c=y=>{const E=Nc(o);Nr(E,"#"+y).each(De)},u=y=>Pe(s,y).getOrThunk(()=>({id:"mce-u"+n++,passed:[],failed:[],count:0})),f=y=>new Promise((E,v)=>{let S;const R=$._addCacheSuffix(y),O=u(R);s[R]=O,O.count++;const U=(V,Z)=>{P(V,fr),O.status=Z,O.passed=[],O.failed=[],S&&(S.onload=null,S.onerror=null,S=null)},A=()=>U(O.passed,2),x=()=>U(O.failed,3);if(E&&O.passed.push(E),v&&O.failed.push(v),O.status===1)return;if(O.status===2){A();return}if(O.status===3){x();return}O.status=1;const T=C.fromTag("link",r.dom);Wn(T,{rel:"stylesheet",type:"text/css",id:O.id}),t.contentCssCors&&st(T,"crossOrigin","anonymous"),t.referrerPolicy&&st(T,"referrerpolicy",t.referrerPolicy),S=T.dom,S.onload=A,S.onerror=x,l(T),st(T,"href",R)}),d=(y,E)=>{const v=u(y);s[y]=v,v.count++;const S=C.fromTag("style",r.dom);Wn(S,{rel:"stylesheet",type:"text/css",id:v.id}),S.dom.innerHTML=E,l(S)},p=y=>Promise.allSettled(he(y,v=>f(v).then(z(v)))).then(v=>{const S=Co(v,R=>R.status==="fulfilled");return S.fail.length>0?Promise.reject(he(S.fail,R=>R.reason)):he(S.pass,R=>R.value)}),b=y=>{const E=$._addCacheSuffix(y);Pe(s,E).each(v=>{--v.count===0&&(delete s[E],c(v.id))})};return{load:f,loadRawCss:d,loadAll:p,unload:b,unloadRawCss:y=>{Pe(s,y).each(E=>{--E.count===0&&(delete s[y],c(E.id))})},unloadAll:y=>{P(y,E=>{b(E)})},_setReferrerPolicy:a,_setContentCssCors:i}},Dp=(()=>{const e=new WeakMap;return{forElement:(n,s)=>{const r=as(n).dom;return m.from(e.get(r)).getOrThunk(()=>{const a=Pp(r,s);return e.set(r,a),a})}}})(),tA=e=>e.nodeName.toLowerCase()==="span",Bp=(e,t,n)=>M(e)&&(di(e,t)||n.isInline(e.nodeName.toLowerCase())),nA=(e,t,n)=>{const s=new Xe(e,t).prev(!1),o=new Xe(e,t).next(!1),r=lt(s)||Bp(s,t,n),a=lt(o)||Bp(o,t,n);return r&&a},Op=e=>tA(e)&&e.getAttribute("data-mce-type")==="bookmark",sA=(e,t,n)=>B(e)&&e.data.length>0&&nA(e,t,n),oA=e=>G(e)?e.childNodes.length>0:!1,rA=e=>Oc(e)||Rr(e),Xc=(e,t,n,s)=>{var o;const r=s||t;if(G(t)&&Op(t))return t;const a=t.childNodes;for(let i=a.length-1;i>=0;i--)Xc(e,a[i],n,r);if(G(t)){const i=t.childNodes;i.length===1&&Op(i[0])&&((o=t.parentNode)===null||o===void 0||o.insertBefore(i[0],t))}return!rA(t)&&!di(t,r)&&!oA(t)&&!sA(t,r,n)&&e.remove(t),t},aA=$.makeMap,gi=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,pi=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,iA=/[<>&\"\']/g,lA=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,cA={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},Hs={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},uA={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},fA=e=>{const t=C.fromTag("div").dom;return t.innerHTML=e,t.textContent||t.innerText||e},Ip=(e,t)=>{const n={};if(e){const s=e.split(",");t=t||10;for(let o=0;o<s.length;o+=2){const r=String.fromCharCode(parseInt(s[o],t));if(!Hs[r]){const a="&"+s[o+1]+";";n[r]=a,n[a]=r}}return n}else return},Zc=Ip("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),Lp=(e,t)=>e.replace(t?gi:pi,n=>Hs[n]||n),dA=e=>(""+e).replace(iA,t=>Hs[t]||t),$p=(e,t)=>e.replace(t?gi:pi,n=>n.length>1?"&#"+((n.charCodeAt(0)-55296)*1024+(n.charCodeAt(1)-56320)+65536)+";":Hs[n]||"&#"+n.charCodeAt(0)+";"),Qc=(e,t,n)=>{const s=n||Zc;return e.replace(t?gi:pi,o=>Hs[o]||s[o]||o)},fs={encodeRaw:Lp,encodeAllRaw:dA,encodeNumeric:$p,encodeNamed:Qc,getEncodeFunc:(e,t)=>{const n=Ip(t)||Zc,s=(a,i)=>a.replace(i?gi:pi,l=>Hs[l]!==void 0?Hs[l]:n[l]!==void 0?n[l]:l.length>1?"&#"+((l.charCodeAt(0)-55296)*1024+(l.charCodeAt(1)-56320)+65536)+";":"&#"+l.charCodeAt(0)+";"),o=(a,i)=>Qc(a,i,n),r=aA(e.replace(/\+/g,","));return r.named&&r.numeric?s:r.named?t?o:Qc:r.numeric?$p:Lp},decode:e=>e.replace(lA,(t,n)=>n?(n.charAt(0).toLowerCase()==="x"?n=parseInt(n.substr(1),16):n=parseInt(n,10),n>65535?(n-=65536,String.fromCharCode(55296+(n>>10),56320+(n&1023))):cA[n]||String.fromCharCode(n)):uA[t]||Zc[t]||fA(t))},ut=(e,t)=>(e=$.trim(e),e?e.split(t||" "):[]),Fp=e=>new RegExp("^"+e.replace(/([?+*])/g,".$1")+"$"),mA=e=>{const t=/^(~)?(.+)$/;return en(ut(e,","),n=>{const s=t.exec(n);if(s){const o=s[1]==="~",r=o?"span":"div",a=s[2];return[{inline:o,cloneName:r,name:a}]}else return[]})},gA=e=>{let t,n,s;if(t="id accesskey class dir lang style tabindex title role",n="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",s="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment",e!=="html4"){const r="a ins del canvas map";t+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",n+=" article aside details dialog figure main header footer hgroup section nav "+r,s+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen svg"}e!=="html5-strict"&&(t+=" xml:lang",s=[s,"acronym applet basefont big font strike tt"].join(" "),n=[n,"center dir isindex noframes"].join(" "));const o=[n,s].join(" ");return{globalAttributes:t,blockContent:n,phrasingContent:s,flowContent:o}},pA=e=>{const{globalAttributes:t,phrasingContent:n,flowContent:s}=gA(e),o={},r=(l,c,u)=>{o[l]={attributes:fc(c,z({})),attributesOrder:c,children:fc(u,z({}))}},a=(l,c="",u="")=>{const f=ut(u),d=ut(l);let p=d.length;const b=ut([t,c].join(" "));for(;p--;)r(d[p],b.slice(),f)},i=(l,c)=>{const u=ut(l),f=ut(c);let d=u.length;for(;d--;){const p=o[u[d]];for(let b=0,g=f.length;b<g;b++)p.attributes[f[b]]={},p.attributesOrder.push(f[b])}};return e!=="html5-strict"&&(P(ut("acronym applet basefont big font strike tt"),u=>{a(u,"",n)}),P(ut("center dir isindex noframes"),u=>{a(u,"",s)})),a("html","manifest","head body"),a("head","","base command link meta noscript script style title"),a("title hr noscript br"),a("base","href target"),a("link","href rel media hreflang type sizes hreflang"),a("meta","name http-equiv content charset"),a("style","media type scoped"),a("script","src async defer type charset"),a("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",s),a("dd div","",s),a("address dt caption","",e==="html4"?n:s),a("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",n),a("blockquote","cite",s),a("ol","reversed start type","li"),a("ul","","li"),a("li","value",s),a("dl","","dt dd"),a("a","href target rel media hreflang type",e==="html4"?n:s),a("q","cite",n),a("ins del","cite datetime",s),a("img","src sizes srcset alt usemap ismap width height"),a("iframe","src name width height",s),a("embed","src type width height"),a("object","data type typemustmatch name usemap form width height",[s,"param"].join(" ")),a("param","name value"),a("map","name",[s,"area"].join(" ")),a("area","alt coords shape href target rel media hreflang type"),a("table","border","caption colgroup thead tfoot tbody tr"+(e==="html4"?" col":"")),a("colgroup","span","col"),a("col","span"),a("tbody thead tfoot","","tr"),a("tr","","td th"),a("td","colspan rowspan headers",s),a("th","colspan rowspan headers scope abbr",s),a("form","accept-charset action autocomplete enctype method name novalidate target",s),a("fieldset","disabled form name",[s,"legend"].join(" ")),a("label","form for",n),a("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),a("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value",e==="html4"?s:n),a("select","disabled form multiple name required size","option optgroup"),a("optgroup","disabled label","option"),a("option","disabled label selected value"),a("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),a("menu","type label",[s,"li"].join(" ")),a("noscript","",s),e!=="html4"&&(a("wbr"),a("ruby","",[n,"rt rp"].join(" ")),a("figcaption","",s),a("mark rt rp bdi","",n),a("summary","",[n,"h1 h2 h3 h4 h5 h6"].join(" ")),a("canvas","width height",s),a("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[s,"track source"].join(" ")),a("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[s,"track source"].join(" ")),a("picture","","img source"),a("source","src srcset type media sizes"),a("track","kind src srclang label default"),a("datalist","",[n,"option"].join(" ")),a("article section nav aside main header footer","",s),a("hgroup","","h1 h2 h3 h4 h5 h6"),a("figure","",[s,"figcaption"].join(" ")),a("time","datetime",n),a("dialog","open",s),a("command","type label icon disabled checked radiogroup command"),a("output","for form name",n),a("progress","value max",n),a("meter","value min max low high optimum",n),a("details","open",[s,"summary"].join(" ")),a("keygen","autofocus challenge disabled form keytype name"),r("svg","id tabindex lang xml:space class style x y width height viewBox preserveAspectRatio zoomAndPan transform".split(" "),[])),e!=="html5-strict"&&(i("script","language xml:space"),i("style","xml:space"),i("object","declare classid code codebase codetype archive standby align border hspace vspace"),i("embed","align name hspace vspace"),i("param","valuetype type"),i("a","charset name rev shape coords"),i("br","clear"),i("applet","codebase archive code object alt name width height align hspace vspace"),i("img","name longdesc align border hspace vspace"),i("iframe","longdesc frameborder marginwidth marginheight scrolling align"),i("font basefont","size color face"),i("input","usemap align"),i("select"),i("textarea"),i("h1 h2 h3 h4 h5 h6 div p legend caption","align"),i("ul","type compact"),i("li","type"),i("ol dl menu dir","compact"),i("pre","width xml:space"),i("hr","align noshade size width"),i("isindex","prompt"),i("table","summary width frame rules cellspacing cellpadding align bgcolor"),i("col","width align char charoff valign"),i("colgroup","width align char charoff valign"),i("thead","align char charoff valign"),i("tr","align char charoff valign bgcolor"),i("th","axis align char charoff valign nowrap bgcolor width height"),i("form","accept"),i("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),i("tfoot","align char charoff valign"),i("tbody","align char charoff valign"),i("area","nohref"),i("body","background bgcolor text link vlink alink")),e!=="html4"&&(i("input button select textarea","autofocus"),i("input textarea","placeholder"),i("a","download"),i("link script img","crossorigin"),i("img","loading"),i("iframe","sandbox seamless allow allowfullscreen loading")),e!=="html4"&&P([o.video,o.audio],l=>{delete l.children.audio,delete l.children.video}),P(ut("a form meter progress dfn"),l=>{o[l]&&delete o[l].children[l]}),delete o.caption.children.table,delete o.script,o},hA=e=>e==="-"?"remove":"add",bA=e=>{const t=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;return en(ut(e,","),n=>{const s=t.exec(n);if(s){const o=s[1],r=o?hA(o):"replace",a=s[2],i=ut(s[3],"|");return[{operation:r,name:a,validChildren:i}]}else return[]})},CA=(e,t)=>{const n=/^([!\-])?(\w+[\\:]:\w+|[^=~<]+)?(?:([=~<])(.*))?$/,s=/[*?+]/,{attributes:o,attributesOrder:r}=t;return P(ut(e,"|"),a=>{const i=n.exec(a);if(i){const l={},c=i[1],u=i[2].replace(/[\\:]:/g,":"),f=i[3],d=i[4];if(c==="!"&&(t.attributesRequired=t.attributesRequired||[],t.attributesRequired.push(u),l.required=!0),c==="-"){delete o[u],r.splice($.inArray(r,u),1);return}if(f&&(f==="="?(t.attributesDefault=t.attributesDefault||[],t.attributesDefault.push({name:u,value:d}),l.defaultValue=d):f==="~"?(t.attributesForced=t.attributesForced||[],t.attributesForced.push({name:u,value:d}),l.forcedValue=d):f==="<"&&(l.validValues=$.makeMap(d,"?"))),s.test(u)){const p=l;t.attributePatterns=t.attributePatterns||[],p.pattern=Fp(u),t.attributePatterns.push(p)}else o[u]||r.push(u),o[u]=l}})},yA=(e,t)=>{Te(e.attributes,(n,s)=>{t.attributes[s]=n}),t.attributesOrder.push(...e.attributesOrder)},vA=(e,t)=>{const n=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/;return en(ut(t,","),s=>{const o=n.exec(s);if(o){const r=o[1],a=o[2],i=o[3],l=o[4],c=o[5],u={attributes:{},attributesOrder:[]};if(e.each(f=>yA(f,u)),r==="#"?u.paddEmpty=!0:r==="-"&&(u.removeEmpty=!0),l==="!"&&(u.removeEmptyAttrs=!0),c&&CA(c,u),i&&(u.outputName=a),a==="@")if(e.isNone())e=m.some(u);else return[];return[i?{name:a,element:u,aliasName:i}:{name:a,element:u}]}else return[]})},hi={},Ir=$.makeMap,pn=$.each,Jc=$.extend,Mp=$.explode,Up=(e,t={})=>{const n=Ir(e," ",Ir(e.toUpperCase()," "));return Jc(n,t)},zp=e=>Up("td th li dt dd figcaption caption details summary",e.getTextBlockElements()),eu=(e,t)=>{if(e){const n={};return Q(e)&&(e={"*":e}),pn(e,(s,o)=>{n[o]=n[o.toUpperCase()]=t==="map"?Ir(s,/[, ]/):Mp(s,/[, ]/)}),n}else return},ds=(e={})=>{var t;const n={},s={};let o=[];const r={},a={},i=(se,ge,_e)=>{const Le=e[se];if(Le)return Ir(Le,/[, ]/,Ir(Le.toUpperCase(),/[, ]/));{let Re=hi[se];return Re||(Re=Up(ge,_e),hi[se]=Re),Re}},l=(t=e.schema)!==null&&t!==void 0?t:"html5",c=pA(l);e.verify_html===!1&&(e.valid_elements="*[*]");const u=eu(e.valid_styles),f=eu(e.invalid_styles,"map"),d=eu(e.valid_classes,"map"),p=i("whitespace_elements","pre script noscript style textarea video audio iframe object code"),b=i("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),g=i("void_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),h=i("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls allowfullscreen"),y="td th iframe video audio object script code",E=i("non_empty_elements",y+" pre svg",g),v=i("move_caret_before_on_enter_elements",y+" table",g),S="h1 h2 h3 h4 h5 h6",R=i("text_block_elements",S+" p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),O=i("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary html body multicol listing",R),U=i("text_inline_elements","span strong b em i font s strike u var cite dfn code mark q sup sub samp"),A=i("transparent_elements","a ins del canvas map"),x=i("wrap_block_elements","pre "+S);pn("script noscript iframe noframes noembed title style textarea xmp plaintext".split(" "),se=>{a[se]=new RegExp("</"+se+"[^>]*>","gi")});const T=se=>{const ge=m.from(n["@"]),_e=/[*?+]/;P(vA(ge,se??""),({name:Le,element:Re,aliasName:At})=>{if(At&&(n[At]=Re),_e.test(Le)){const Sn=Re;Sn.pattern=Fp(Le),o.push(Sn)}else n[Le]=Re})},V=se=>{o=[],P(Pt(n),ge=>{delete n[ge]}),T(se)},Z=se=>{delete hi.text_block_elements,delete hi.block_elements,P(mA(se??""),({inline:ge,name:_e,cloneName:Le})=>{if(s[_e]=s[Le],r[_e]=Le,E[_e.toUpperCase()]={},E[_e]={},ge||(O[_e.toUpperCase()]={},O[_e]={}),!n[_e]){let Re=n[Le];Re=Jc({},Re),delete Re.removeEmptyAttrs,delete Re.removeEmpty,n[_e]=Re}Te(s,(Re,At)=>{Re[Le]&&(s[At]=Re=Jc({},s[At]),Re[_e]=Re[Le])})})},ae=se=>{P(bA(se??""),({operation:ge,name:_e,validChildren:Le})=>{const Re=ge==="replace"?{"#comment":{}}:s[_e];P(Le,At=>{ge==="remove"?delete Re[At]:Re[At]={}}),s[_e]=Re})},ie=se=>{const ge=n[se];if(ge)return ge;let _e=o.length;for(;_e--;){const Le=o[_e];if(Le.pattern.test(se))return Le}};e.valid_elements?(V(e.valid_elements),pn(c,(se,ge)=>{s[ge]=se.children})):(pn(c,(se,ge)=>{n[ge]={attributes:se.attributes,attributesOrder:se.attributesOrder},s[ge]=se.children}),pn(ut("strong/b em/i"),se=>{const ge=ut(se,"/");n[ge[1]].outputName=ge[0]}),pn(U,(se,ge)=>{n[ge]&&(e.padd_empty_block_inline_children&&(n[ge].paddInEmptyBlock=!0),n[ge].removeEmpty=!0)}),pn(ut("ol ul blockquote a table tbody"),se=>{n[se]&&(n[se].removeEmpty=!0)}),pn(ut("p h1 h2 h3 h4 h5 h6 th td pre div address caption li summary"),se=>{n[se]&&(n[se].paddEmpty=!0)}),pn(ut("span"),se=>{n[se].removeEmptyAttrs=!0})),delete n.svg,Z(e.custom_elements),ae(e.valid_children),T(e.extended_valid_elements),ae("+ol[ul|ol],+ul[ul|ol]"),pn({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(se,ge)=>{n[ge]&&(n[ge].parentsRequired=ut(se))}),e.invalid_elements&&pn(Mp(e.invalid_elements),se=>{n[se]&&delete n[se]}),ie("span")||T("span[!data-mce-type|*]");const Ce=z(u),xe=z(f),Ie=z(d),nt=z(h),ye=z(O),F=z(R),Y=z(U),me=z(Object.seal(g)),ue=z(b),j=z(E),ee=z(v),I=z(p),te=z(A),de=z(x),we=z(Object.seal(a)),Se=(se,ge)=>{const _e=s[se.toLowerCase()];return!!(_e&&_e[ge.toLowerCase()])},qe=(se,ge)=>{const _e=ie(se);if(_e)if(ge){if(_e.attributes[ge])return!0;const Le=_e.attributePatterns;if(Le){let Re=Le.length;for(;Re--;)if(Le[Re].pattern.test(ge))return!0}}else return!0;return!1},ln=se=>re(ye(),se),Un=se=>qe(se)&&!ln(se),St=se=>re(de(),se)||Un(se),Jt=z(r);return{type:l,children:s,elements:n,getValidStyles:Ce,getValidClasses:Ie,getBlockElements:ye,getInvalidStyles:xe,getVoidElements:me,getTextBlockElements:F,getTextInlineElements:Y,getBoolAttrs:nt,getElementRule:ie,getSelfClosingElements:ue,getNonEmptyElements:j,getMoveCaretBeforeOnEnterElements:ee,getWhitespaceElements:I,getTransparentElements:te,getSpecialElements:we,isValidChild:Se,isValid:qe,isBlock:ln,isInline:Un,isWrapper:St,getCustomElements:Jt,addValidElements:T,setValidElements:V,addCustomElements:Z,addValidChildren:ae}},EA=e=>({value:SA(e)}),SA=e=>lg(e,"#").toUpperCase(),tu=e=>{const t=e.toString(16);return(t.length===1?"0"+t:t).toUpperCase()},wA=e=>{const t=tu(e.red)+tu(e.green)+tu(e.blue);return EA(t)},kA=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,xA=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,Hp=(e,t,n,s)=>({red:e,green:t,blue:n,alpha:s}),Wp=(e,t,n,s)=>{const o=parseInt(e,10),r=parseInt(t,10),a=parseInt(n,10),i=parseFloat(s);return Hp(o,r,a,i)},Vp=e=>{if(e==="transparent")return m.some(Hp(0,0,0,0));const t=kA.exec(e);if(t!==null)return m.some(Wp(t[1],t[2],t[3],"1"));const n=xA.exec(e);return n!==null?m.some(Wp(n[1],n[2],n[3],n[4])):m.none()},_A=e=>`rgba(${e.red},${e.green},${e.blue},${e.alpha})`,Lr=e=>Vp(e).map(wA).map(t=>"#"+t.value).getOr(e),nu=(e={},t)=>{const n=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,s=/\s*([^:]+):\s*([^;]+);?/g,o=/\s+$/,r={};let a,i;const l=Pr;t&&(a=t.getValidStyles(),i=t.getInvalidStyles());const c=(`\\" \\' \\; \\: ; : `+l).split(" ");for(let f=0;f<c.length;f++)r[c[f]]=l+f,r[l+f]=c[f];const u={parse:f=>{const d={};let p=!1;const b=e.url_converter,g=e.url_converter_scope||u,h=(A,x,T)=>{const V=d[A+"-top"+x];if(!V)return;const Z=d[A+"-right"+x];if(!Z)return;const ae=d[A+"-bottom"+x];if(!ae)return;const ie=d[A+"-left"+x];if(!ie)return;const Ce=[V,Z,ae,ie];let xe=Ce.length-1;for(;xe--&&Ce[xe]===Ce[xe+1];);xe>-1&&T||(d[A+x]=xe===-1?Ce[0]:Ce.join(" "),delete d[A+"-top"+x],delete d[A+"-right"+x],delete d[A+"-bottom"+x],delete d[A+"-left"+x])},y=A=>{const x=d[A];if(!x)return;const T=x.indexOf(",")>-1?[x]:x.split(" ");let V=T.length;for(;V--;)if(T[V]!==T[0])return!1;return d[A]=T[0],!0},E=(A,x,T,V)=>{y(x)&&y(T)&&y(V)&&(d[A]=d[x]+" "+d[T]+" "+d[V],delete d[x],delete d[T],delete d[V])},v=A=>(p=!0,r[A]),S=(A,x)=>(p&&(A=A.replace(/\uFEFF[0-9]/g,T=>r[T])),x||(A=A.replace(/\\([\'\";:])/g,"$1")),A),R=A=>String.fromCharCode(parseInt(A.slice(1),16)),O=A=>A.replace(/\\[0-9a-f]+/gi,R),U=(A,x,T,V,Z,ae)=>{if(Z=Z||ae,Z)return Z=S(Z),"'"+Z.replace(/\'/g,"\\'")+"'";if(x=S(x||T||V||""),!e.allow_script_urls){const ie=x.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(ie)||!e.allow_svg_data_urls&&/^data:image\/svg/i.test(ie))return""}return b&&(x=b.call(g,x,"style")),"url('"+x.replace(/\'/g,"\\'")+"')"};if(f){f=f.replace(/[\u0000-\u001F]/g,""),f=f.replace(/\\[\"\';:\uFEFF]/g,v).replace(/\"[^\"]+\"|\'[^\']+\'/g,x=>x.replace(/[;:]/g,v));let A;for(;A=s.exec(f);){s.lastIndex=A.index+A[0].length;let x=A[1].replace(o,"").toLowerCase(),T=A[2].replace(o,"");if(x&&T){if(x=O(x),T=O(T),x.indexOf(l)!==-1||x.indexOf('"')!==-1||!e.allow_script_urls&&(x==="behavior"||/expression\s*\(|\/\*|\*\//.test(T)))continue;x==="font-weight"&&T==="700"?T="bold":(x==="color"||x==="background-color")&&(T=T.toLowerCase()),Q(e.force_hex_color)&&e.force_hex_color!=="off"&&Vp(T).each(V=>{(e.force_hex_color==="always"||V.alpha===1)&&(T=Lr(_A(V)))}),T=T.replace(n,U),d[x]=p?S(T,!0):T}}h("border","",!0),h("border","-width"),h("border","-color"),h("border","-style"),h("padding",""),h("margin",""),E("border","border-width","border-style","border-color"),d.border==="medium none"&&delete d.border,d["border-image"]==="none"&&delete d["border-image"]}return d},serialize:(f,d)=>{let p="";const b=(h,y)=>{const E=y[h];if(E)for(let v=0,S=E.length;v<S;v++){const R=E[v],O=f[R];O&&(p+=(p.length>0?" ":"")+R+": "+O+";")}},g=(h,y)=>{if(!i||!y)return!0;let E=i["*"];return E&&E[h]?!1:(E=i[y],!(E&&E[h]))};return d&&a?(b("*",a),b(d,a)):Te(f,(h,y)=>{h&&g(y,d)&&(p+=(p.length>0?" ":"")+y+": "+h+";")}),p}};return u},NA={keyLocation:!0,layerX:!0,layerY:!0,returnValue:!0,webkitMovementX:!0,webkitMovementY:!0,keyIdentifier:!0,mozPressure:!0},AA=e=>e instanceof Event||ke(e.initEvent),TA=e=>e.isDefaultPrevented===We||e.isDefaultPrevented===$e,RA=e=>je(e.preventDefault)||AA(e),jp=(e,t)=>{const n=t??{};for(const s in e)re(NA,s)||(n[s]=e[s]);return M(e.composedPath)&&(n.composedPath=()=>e.composedPath()),M(e.getModifierState)&&(n.getModifierState=s=>e.getModifierState(s)),M(e.getTargetRanges)&&(n.getTargetRanges=()=>e.getTargetRanges()),n},su=(e,t,n,s)=>{var o;const r=jp(t,s);return r.type=e,je(r.target)&&(r.target=(o=r.srcElement)!==null&&o!==void 0?o:n),RA(t)&&(r.preventDefault=()=>{r.defaultPrevented=!0,r.isDefaultPrevented=We,ke(t.preventDefault)&&t.preventDefault()},r.stopPropagation=()=>{r.cancelBubble=!0,r.isPropagationStopped=We,ke(t.stopPropagation)&&t.stopPropagation()},r.stopImmediatePropagation=()=>{r.isImmediatePropagationStopped=We,r.stopPropagation()},TA(r)||(r.isDefaultPrevented=r.defaultPrevented===!0?We:$e,r.isPropagationStopped=r.cancelBubble===!0?We:$e,r.isImmediatePropagationStopped=$e)),r},PA="mce-data-",DA=/^(?:mouse|contextmenu)|click/,ou=(e,t,n,s)=>{e.addEventListener(t,n,s||!1)},bi=(e,t,n,s)=>{e.removeEventListener(t,n,s||!1)},BA=e=>M(e)&&DA.test(e.type),$r=(e,t)=>{const n=su(e.type,e,document,t);if(BA(e)&&lt(e.pageX)&&!lt(e.clientX)){const s=n.target.ownerDocument||document,o=s.documentElement,r=s.body,a=n;a.pageX=e.clientX+(o&&o.scrollLeft||r&&r.scrollLeft||0)-(o&&o.clientLeft||r&&r.clientLeft||0),a.pageY=e.clientY+(o&&o.scrollTop||r&&r.scrollTop||0)-(o&&o.clientTop||r&&r.clientTop||0)}return n},OA=(e,t,n)=>{const s=e.document,o={type:"ready"};if(n.domLoaded){t(o);return}const r=()=>s.readyState==="complete"||s.readyState==="interactive"&&s.body,a=()=>{bi(e,"DOMContentLoaded",a),bi(e,"load",a),n.domLoaded||(n.domLoaded=!0,t(o)),e=null};r()?a():ou(e,"DOMContentLoaded",a),n.domLoaded||ou(e,"load",a)};class Ws{constructor(){this.domLoaded=!1,this.events={},this.count=1,this.expando=PA+(+new Date).toString(32),this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}bind(t,n,s,o){const r=this;let a;const i=window,l=d=>{r.executeHandlers($r(d||i.event),c)};if(!t||B(t)||is(t))return s;let c;t[r.expando]?c=t[r.expando]:(c=r.count++,t[r.expando]=c,r.events[c]={}),o=o||t;const u=n.split(" ");let f=u.length;for(;f--;){let d=u[f],p=l,b=!1,g=!1;if(d==="DOMContentLoaded"&&(d="ready"),r.domLoaded&&d==="ready"&&t.readyState==="complete"){s.call(o,$r({type:d}));continue}!r.hasFocusIn&&(d==="focusin"||d==="focusout")&&(b=!0,g=d==="focusin"?"focus":"blur",p=h=>{const y=$r(h||i.event);y.type=y.type==="focus"?"focusin":"focusout",r.executeHandlers(y,c)}),a=r.events[c][d],a?d==="ready"&&r.domLoaded?s($r({type:d})):a.push({func:s,scope:o}):(r.events[c][d]=a=[{func:s,scope:o}],a.fakeName=g,a.capture=b,a.nativeHandler=p,d==="ready"?OA(t,p,r):ou(t,g||d,p,b))}return t=a=null,s}unbind(t,n,s){if(!t||B(t)||is(t))return this;const o=t[this.expando];if(o){let r=this.events[o];if(n){const a=n.split(" ");let i=a.length;for(;i--;){const l=a[i],c=r[l];if(c){if(s){let u=c.length;for(;u--;)if(c[u].func===s){const f=c.nativeHandler,d=c.fakeName,p=c.capture,b=c.slice(0,u).concat(c.slice(u+1));b.nativeHandler=f,b.fakeName=d,b.capture=p,r[l]=b}}(!s||c.length===0)&&(delete r[l],bi(t,c.fakeName||l,c.nativeHandler,c.capture))}}}else Te(r,(a,i)=>{bi(t,a.fakeName||i,a.nativeHandler,a.capture)}),r={};for(const a in r)if(re(r,a))return this;delete this.events[o];try{delete t[this.expando]}catch{t[this.expando]=null}}return this}fire(t,n,s){return this.dispatch(t,n,s)}dispatch(t,n,s){if(!t||B(t)||is(t))return this;const o=$r({type:n,target:t},s);do{const r=t[this.expando];r&&this.executeHandlers(o,r),t=t.parentNode||t.ownerDocument||t.defaultView||t.parentWindow}while(t&&!o.isPropagationStopped());return this}clean(t){if(!t||B(t)||is(t))return this;if(t[this.expando]&&this.unbind(t),t.getElementsByTagName||(t=t.document),t&&t.getElementsByTagName){this.unbind(t);const n=t.getElementsByTagName("*");let s=n.length;for(;s--;)t=n[s],t[this.expando]&&this.unbind(t)}return this}destroy(){this.events={}}cancel(t){return t&&(t.preventDefault(),t.stopImmediatePropagation()),!1}executeHandlers(t,n){const s=this.events[n],o=s&&s[t.type];if(o)for(let r=0,a=o.length;r<a;r++){const i=o[r];if(i&&i.func.call(i.scope,t)===!1&&t.preventDefault(),t.isImmediatePropagationStopped())return}}}Ws.Event=new Ws;const ru=$.each,IA=$.grep,au="data-mce-style",LA=$.makeMap("fill-opacity font-weight line-height opacity orphans widows z-index zoom"," "),Fr=(e,t,n)=>{je(n)||n===""?ot(e,t):st(e,t,n)},qp=e=>e.replace(/[A-Z]/g,t=>"-"+t.toLowerCase()),Do=(e,t)=>{let n=0;if(e)for(let s=e.nodeType,o=e.previousSibling;o;o=o.previousSibling){const r=o.nodeType;t&&B(o)&&(r===s||!o.data.length)||(n++,s=r)}return n},Kp=(e,t)=>{const n=Ft(t,"style"),s=e.serialize(e.parse(n),pe(t));Fr(t,au,s)},$A=(e,t)=>dn(e)?re(LA,t)?e+"":e+"px":e,Gp=(e,t,n)=>{const s=qp(t);je(n)||n===""?sp(e,s):tp(e,s,$A(n,s))},FA=(e,t,n)=>{const s=t.keep_values,o={set:(a,i,l)=>{const c=C.fromDom(a);ke(t.url_converter)&&M(i)&&(i=t.url_converter.call(t.url_converter_scope||n(),String(i),l,a));const u="data-mce-"+l;Fr(c,u,i),Fr(c,l,i)},get:(a,i)=>{const l=C.fromDom(a);return Ft(l,"data-mce-"+i)||Ft(l,i)}},r={style:{set:(a,i)=>{const l=C.fromDom(a);s&&Fr(l,au,i),ot(l,"style"),Q(i)&&ei(l,e.parse(i))},get:a=>{const i=C.fromDom(a),l=Ft(i,au)||Ft(i,"style");return e.serialize(e.parse(l),pe(i))}}};return s&&(r.href=r.src=o),r},Ae=(e,t={})=>{const n={},s=window,o={};let r=0;const a=!0,i=!0,l=Dp.forElement(C.fromDom(e),{contentCssCors:t.contentCssCors,referrerPolicy:t.referrerPolicy}),c=[],u=t.schema?t.schema:ds({}),f=nu({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope,force_hex_color:t.force_hex_color},t.schema),d=t.ownEvents?new Ws:Ws.Event,p=u.getBlockElements(),b=w=>Q(w)?re(p,w):G(w)&&(re(p,w.nodeName)||zs(u,w)),g=w=>w&&e&&Q(w)?e.getElementById(w):w,h=w=>{const k=g(w);return M(k)?C.fromDom(k):null},y=(w,k,L="")=>{let D;const X=h(w);if(M(X)&&$t(X)){const fe=za[k];fe&&fe.get?D=fe.get(X.dom,k):D=Ft(X,k)}return M(D)?D:L},E=w=>{const k=g(w);return je(k)?[]:k.attributes},v=(w,k,L)=>{Y(w,D=>{if(G(D)){const X=C.fromDom(D),fe=L===""?null:L,Oe=Ft(X,k),It=za[k];It&&It.set?It.set(X.dom,fe,k):Fr(X,k,fe),Oe!==fe&&t.onSetAttrib&&t.onSetAttrib({attrElm:X.dom,attrName:k,attrValue:fe})}})},S=(w,k)=>w.cloneNode(k),R=()=>t.root_element||e.body,O=w=>{const k=up(w);return{x:k.x,y:k.y,w:k.width,h:k.height}},U=(w,k)=>eA(e.body,g(w),k),A=(w,k,L)=>{Y(w,D=>{const X=C.fromDom(D);Gp(X,k,L),t.update_styles&&Kp(f,X)})},x=(w,k)=>{Y(w,L=>{const D=C.fromDom(L);Te(k,(X,fe)=>{Gp(D,fe,X)}),t.update_styles&&Kp(f,D)})},T=(w,k,L)=>{const D=g(w);if(!(je(D)||!Xn(D)&&!Y_(D)))return L?Tn(C.fromDom(D),qp(k)):(k=k.replace(/-(\D)/g,(X,fe)=>fe.toUpperCase()),k==="float"&&(k="cssFloat"),D.style?D.style[k]:void 0)},V=w=>{const k=g(w);if(!k)return{w:0,h:0};let L=T(k,"width"),D=T(k,"height");return(!L||L.indexOf("px")===-1)&&(L="0"),(!D||D.indexOf("px")===-1)&&(D="0"),{w:parseInt(L,10)||k.offsetWidth||k.clientWidth,h:parseInt(D,10)||k.offsetHeight||k.clientHeight}},Z=w=>{const k=g(w),L=U(k),D=V(k);return{x:L.x,y:L.y,w:D.w,h:D.h}},ae=(w,k)=>{if(!w)return!1;const L=Ge(w)?w:[w];return Ue(L,D=>mn(C.fromDom(D),k))},ie=(w,k,L,D)=>{const X=[];let fe=g(w);D=D===void 0;const Oe=L||(R().nodeName!=="BODY"?R().parentNode:null);if(Q(k))if(k==="*")k=G;else{const It=k;k=it=>ae(it,It)}for(;fe&&!(fe===Oe||je(fe.nodeType)||Rr(fe)||Oc(fe));){if(!k||k(fe))if(D)X.push(fe);else return[fe];fe=fe.parentNode}return D?X:null},Ce=(w,k,L)=>{const D=ie(w,k,L,!1);return D&&D.length>0?D[0]:null},xe=(w,k,L)=>{let D=k;if(w){Q(k)&&(D=X=>ae(X,k));for(let X=w[L];X;X=X[L])if(ke(D)&&D(X))return X}return null},Ie=(w,k)=>xe(w,k,"nextSibling"),nt=(w,k)=>xe(w,k,"previousSibling"),ye=w=>ke(w.querySelectorAll),F=(w,k)=>{var L,D;const X=(D=(L=g(k))!==null&&L!==void 0?L:t.root_element)!==null&&D!==void 0?D:e;return ye(X)?Lt(X.querySelectorAll(w)):[]},Y=function(w,k,L){const D=L??this;if(Ge(w)){const X=[];return ru(w,(fe,Oe)=>{const It=g(fe);It&&X.push(k.call(D,It,Oe))}),X}else{const X=g(w);return X?k.call(D,X):!1}},me=(w,k)=>{Y(w,L=>{Te(k,(D,X)=>{v(L,X,D)})})},ue=(w,k)=>{Y(w,L=>{const D=C.fromDom(L);ni(D,k)})},j=(w,k,L,D,X)=>Y(w,fe=>{const Oe=Q(k)?e.createElement(k):k;return M(L)&&me(Oe,L),D&&(!Q(D)&&D.nodeType?Oe.appendChild(D):Q(D)&&ue(Oe,D)),X?Oe:fe.appendChild(Oe)}),ee=(w,k,L)=>j(e.createElement(w),w,k,L,!0),I=fs.decode,te=fs.encodeAllRaw,de=(w,k,L="")=>{let D="<"+w;for(const X in k)vo(k,X)&&(D+=" "+X+'="'+te(k[X])+'"');return Cr(L)&&re(u.getVoidElements(),w)?D+" />":D+">"+L+"</"+w+">"},we=w=>{const k=e.createElement("div"),L=e.createDocumentFragment();L.appendChild(k),w&&(k.innerHTML=w);let D;for(;D=k.firstChild;)L.appendChild(D);return L.removeChild(k),L},Se=(w,k)=>Y(w,L=>{const D=C.fromDom(L);return k&&P(rt(D),X=>{Ht(X)&&X.dom.length===0?De(X):Dt(D,X)}),De(D),D.dom}),qe=w=>Y(w,k=>{const L=k.attributes;for(let D=L.length-1;D>=0;D--)k.removeAttributeNode(L.item(D))}),ln=w=>f.parse(w),Un=(w,k)=>f.serialize(w,k),St=w=>{if(os!==Ae.DOM&&e===document){if(n[w])return;n[w]=!0}let k=e.getElementById("mceDefaultStyles");if(!k){k=e.createElement("style"),k.id="mceDefaultStyles",k.type="text/css";const L=e.head;L.firstChild?L.insertBefore(k,L.firstChild):L.appendChild(k)}k.styleSheet?k.styleSheet.cssText+=w:k.appendChild(e.createTextNode(w))},Jt=w=>{w||(w=""),P(w.split(","),k=>{o[k]=!0,l.load(k).catch(ce)})},se=(w,k,L)=>{Y(w,D=>{if(G(D)){const X=C.fromDom(D),fe=k.split(" ");P(fe,Oe=>{M(L)?(L?ko:Sr)(X,Oe):p_(X,Oe)})}})},ge=(w,k)=>{se(w,k,!0)},_e=(w,k)=>{se(w,k,!1)},Le=(w,k)=>{const L=h(w),D=k.split(" ");return M(L)&&rs(D,X=>Sc(L,X))},Re=w=>{Y(w,k=>sp(C.fromDom(k),"display"))},At=w=>{Y(w,k=>tp(C.fromDom(k),"display","none"))},Sn=w=>{const k=h(w);return M(k)&&So(ti(k,"display"),"none")},xs=w=>(w||"mce_")+r++,Ql=w=>{const k=h(w);return M(k)?G(k.dom)?k.dom.outerHTML:F_(k):""},Jl=(w,k)=>{Y(w,L=>{G(L)&&(L.outerHTML=k)})},ec=(w,k)=>{const L=g(k);return Y(w,D=>{const X=L==null?void 0:L.parentNode,fe=L==null?void 0:L.nextSibling;return X&&(fe?X.insertBefore(D,fe):X.appendChild(D)),D})},ar=(w,k,L)=>Y(k,D=>{var X;const fe=Ge(k)?w.cloneNode(!0):w;return L&&ru(IA(D.childNodes),Oe=>{fe.appendChild(Oe)}),(X=D.parentNode)===null||X===void 0||X.replaceChild(fe,D),D}),tc=(w,k)=>{if(w.nodeName!==k.toUpperCase()){const L=ee(k);return ru(E(w),D=>{v(L,D.nodeName,y(w,D.nodeName))}),ar(L,w,!0),L}else return w},ir=(w,k)=>{let L=w;for(;L;){let D=k;for(;D&&L!==D;)D=D.parentNode;if(L===D)break;L=L.parentNode}return!L&&w.ownerDocument?w.ownerDocument.documentElement:L},go=w=>{if(G(w)){const k=w.nodeName.toLowerCase()==="a"&&!y(w,"href")&&y(w,"id");if(y(w,"name")||y(w,"data-mce-bookmark")||k)return!0}return!1},wn=(w,k,L)=>{let D=0;if(go(w))return!1;const X=w.firstChild;if(X){const fe=new Xe(X,w),Oe=u?u.getWhitespaceElements():{},It=k||(u?u.getNonEmptyElements():null);let it=X;do{if(G(it)){const ho=it.getAttribute("data-mce-bogus");if(ho){it=fe.next(ho==="all");continue}const cn=it.nodeName.toLowerCase();if(It&&It[cn]){if(cn==="br"){D++,it=fe.next();continue}return!1}if(go(it))return!1}if(is(it)||B(it)&&!us(it.data)&&(!(L!=null&&L.includeZwsp)||!DN(it.data))||B(it)&&it.parentNode&&Oe[it.parentNode.nodeName]&&us(it.data))return!1;it=fe.next()}while(it)}return D<=1},zn=()=>e.createRange(),Ua=(w,k,L)=>{let D=zn(),X,fe;if(w&&k&&w.parentNode&&k.parentNode){const Oe=w.parentNode;return D.setStart(Oe,Do(w)),D.setEnd(k.parentNode,Do(k)),X=D.extractContents(),D=zn(),D.setStart(k.parentNode,Do(k)+1),D.setEnd(Oe,Do(w)+1),fe=D.extractContents(),Oe.insertBefore(Xc(os,X,u),w),L?Oe.insertBefore(L,w):Oe.insertBefore(k,w),Oe.insertBefore(Xc(os,fe,u),w),Se(w),L||k}else return},lr=(w,k,L,D)=>{if(Ge(w)){let X=w.length;const fe=[];for(;X--;)fe[X]=lr(w[X],k,L,D);return fe}else return t.collect&&(w===e||w===s)&&c.push([w,k,L,D]),d.bind(w,k,L,D||os)},nc=(w,k,L)=>{if(Ge(w)){let D=w.length;const X=[];for(;D--;)X[D]=nc(w[D],k,L);return X}else{if(c.length>0&&(w===e||w===s)){let D=c.length;for(;D--;){const[X,fe,Oe]=c[D];w===X&&(!k||k===fe)&&(!L||L===Oe)&&d.unbind(X,fe,Oe)}}return d.unbind(w,k,L)}},ss=(w,k,L)=>d.dispatch(w,k,L),Fm=(w,k,L)=>d.dispatch(w,k,L),sc=w=>{if(w&&Xn(w)){const k=w.getAttribute("data-mce-contenteditable");return k&&k!=="inherit"?k:w.contentEditable!=="inherit"?w.contentEditable:null}else return null},os={doc:e,settings:t,win:s,files:o,stdMode:a,boxModel:i,styleSheetLoader:l,boundEvents:c,styles:f,schema:u,events:d,isBlock:b,root:null,clone:S,getRoot:R,getViewPort:O,getRect:Z,getSize:V,getParent:Ce,getParents:ie,get:g,getNext:Ie,getPrev:nt,select:F,is:ae,add:j,create:ee,createHTML:de,createFragment:we,remove:Se,setStyle:A,getStyle:T,setStyles:x,removeAllAttribs:qe,setAttrib:v,setAttribs:me,getAttrib:y,getPos:U,parseStyle:ln,serializeStyle:Un,addStyle:St,loadCSS:Jt,addClass:ge,removeClass:_e,hasClass:Le,toggleClass:se,show:Re,hide:At,isHidden:Sn,uniqueId:xs,setHTML:ue,getOuterHTML:Ql,setOuterHTML:Jl,decode:I,encode:te,insertAfter:ec,replace:ar,rename:tc,findCommonAncestor:ir,run:Y,getAttribs:E,isEmpty:wn,createRng:zn,nodeIndex:Do,split:Ua,bind:lr,unbind:nc,fire:Fm,dispatch:ss,getContentEditable:sc,getContentEditableParent:w=>{const k=R();let L=null;for(let D=w;D&&D!==k&&(L=sc(D),L===null);D=D.parentNode);return L},isEditable:w=>{if(M(w)){const k=G(w)?w:w.parentElement;return M(k)&&Xn(k)&&Is(C.fromDom(k))}else return!1},destroy:()=>{if(c.length>0){let w=c.length;for(;w--;){const[k,L,D]=c[w];d.unbind(k,L,D)}}Te(o,(w,k)=>{l.unload(k),delete o[k]})},isChildOf:(w,k)=>w===k||k.contains(w),dumpRng:w=>"startContainer: "+w.startContainer.nodeName+", startOffset: "+w.startOffset+", endContainer: "+w.endContainer.nodeName+", endOffset: "+w.endOffset},za=FA(f,t,z(os));return os};Ae.DOM=Ae(document),Ae.nodeIndex=Do;const MA=Ae.DOM,UA=0,zA=1,Ci=2,Yp=3;class Qn{constructor(t={}){this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=!1,this.settings=t}_setReferrerPolicy(t){this.settings.referrerPolicy=t}loadScript(t){return new Promise((n,s)=>{const o=MA;let r;const a=()=>{o.remove(c),r&&(r.onerror=r.onload=r=null)},i=()=>{a(),n()},l=()=>{a(),s("Failed to load script: "+t)},c=o.uniqueId();r=document.createElement("script"),r.id=c,r.type="text/javascript",r.src=$._addCacheSuffix(t),this.settings.referrerPolicy&&o.setAttrib(r,"referrerpolicy",this.settings.referrerPolicy),r.onload=i,r.onerror=l,(document.getElementsByTagName("head")[0]||document.body).appendChild(r)})}isDone(t){return this.states[t]===Ci}markDone(t){this.states[t]=Ci}add(t){const n=this;return n.queue.push(t),n.states[t]===void 0&&(n.states[t]=UA),new Promise((o,r)=>{n.scriptLoadedCallbacks[t]||(n.scriptLoadedCallbacks[t]=[]),n.scriptLoadedCallbacks[t].push({resolve:o,reject:r})})}load(t){return this.add(t)}remove(t){delete this.states[t],delete this.scriptLoadedCallbacks[t]}loadQueue(){const t=this.queue;return this.queue=[],this.loadScripts(t)}loadScripts(t){const n=this,s=(l,c)=>{Pe(n.scriptLoadedCallbacks,c).each(u=>{P(u,f=>f[l](c))}),delete n.scriptLoadedCallbacks[c]},o=l=>{const c=oe(l,u=>u.status==="rejected");return c.length>0?Promise.reject(en(c,({reason:u})=>Ge(u)?u:[u])):Promise.resolve()},r=l=>Promise.allSettled(he(l,c=>n.states[c]===Ci?(s("resolve",c),Promise.resolve()):n.states[c]===Yp?(s("reject",c),Promise.reject(c)):(n.states[c]=zA,n.loadScript(c).then(()=>{n.states[c]=Ci,s("resolve",c);const u=n.queue;return u.length>0?(n.queue=[],r(u).then(o)):Promise.resolve()},()=>(n.states[c]=Yp,s("reject",c),Promise.reject(c)))))),a=l=>(n.loading=!0,r(l).then(c=>{n.loading=!1;const u=n.queueLoadedCallbacks.shift();return m.from(u).each(fr),o(c)})),i=ng(t);return n.loading?new Promise((l,c)=>{n.queueLoadedCallbacks.push(()=>{a(i).then(l,c)})}):a(i)}}Qn.ScriptLoader=new Qn;const et=e=>{let t=e;return{get:()=>t,set:o=>{t=o}}},HA=(e,t)=>{const n=e.indexOf(t);return n!==-1&&e.indexOf(t,n+1)>n},WA=e=>Ct(e)&&re(e,"raw"),VA=e=>Ge(e)&&e.length>1,Mr={},iu=et("en"),Xp=()=>Pe(Mr,iu.get()),hn={getData:()=>ja(Mr,e=>({...e})),setCode:e=>{e&&iu.set(e)},getCode:()=>iu.get(),add:(e,t)=>{let n=Mr[e];n||(Mr[e]=n={});const s=he(Pt(t),o=>o.toLowerCase());Te(t,(o,r)=>{const a=r.toLowerCase();a!==r&&HA(s,a)?(re(t,a)||(n[a]=o),n[r]=o):n[a]=o})},translate:e=>{const t=Xp().getOr({}),n=a=>ke(a)?Object.prototype.toString.call(a):s(a)?"":""+a,s=a=>a===""||a===null||a===void 0,o=a=>{const i=n(a);return re(t,i)?n(t[i]):Pe(t,i.toLowerCase()).map(n).getOr(i)},r=a=>a.replace(/{context:\w+}$/,"");if(s(e))return"";if(WA(e))return n(e.raw);if(VA(e)){const a=e.slice(1),i=o(e[0]).replace(/\{([0-9]+)\}/g,(l,c)=>re(a,c)?n(a[c]):l);return r(i)}return r(o(e))},isRtl:()=>Xp().bind(e=>Pe(e,"_dir")).exists(e=>e==="rtl"),hasCode:e=>re(Mr,e)},yt=()=>{const e=[],t={},n={},s=[],o=(g,h)=>{const y=oe(s,E=>E.name===g&&E.state===h);P(y,E=>E.resolve())},r=g=>re(t,g),a=g=>re(n,g),i=g=>{if(n[g])return n[g].instance},l=(g,h)=>{const y=hn.getCode(),E=","+(h||"")+",";!y||h&&E.indexOf(","+y+",")===-1||Qn.ScriptLoader.add(t[g]+"/langs/"+y+".js")},c=(g,h)=>{yt.languageLoad!==!1&&(r(g)?l(g,h):b(g,"loaded").then(()=>l(g,h)))},u=(g,h)=>(e.push(h),n[g]={instance:h},o(g,"added"),h),f=g=>{delete t[g],delete n[g]},d=(g,h)=>Q(h)?Q(g)?{prefix:"",resource:h,suffix:""}:{prefix:g.prefix,resource:h,suffix:g.suffix}:h,p=(g,h)=>{if(t[g])return Promise.resolve();let y=Q(h)?h:h.prefix+h.resource+h.suffix;y.indexOf("/")!==0&&y.indexOf("://")===-1&&(y=yt.baseURL+"/"+y),t[g]=y.substring(0,y.lastIndexOf("/"));const E=()=>(o(g,"loaded"),Promise.resolve());return n[g]?E():Qn.ScriptLoader.add(y).then(E)},b=(g,h="added")=>h==="added"&&a(g)||h==="loaded"&&r(g)?Promise.resolve():new Promise(y=>{s.push({name:g,state:h,resolve:y})});return{items:e,urls:t,lookup:n,get:i,requireLangPack:c,add:u,remove:f,createUrl:d,load:p,waitFor:b}};yt.languageLoad=!0,yt.baseURL="",yt.PluginManager=yt(),yt.ThemeManager=yt(),yt.ModelManager=yt();const jA=e=>{const t=et(m.none()),n=()=>t.get().each(e);return{clear:()=>{n(),t.set(m.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:i=>{n(),t.set(m.some(i))}}},qA=e=>{const t=et(m.none()),n=()=>t.get().each(i=>clearInterval(i));return{clear:()=>{n(),t.set(m.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:i=>{n(),t.set(m.some(setInterval(i,e)))}}},ms=()=>{const e=jA(ce);return{...e,on:n=>e.get().each(n)}},yi=(e,t)=>{let n=null;return{cancel:()=>{wt(n)||(clearTimeout(n),n=null)},throttle:(...r)=>{wt(n)&&(n=setTimeout(()=>{n=null,e.apply(null,r)},t))}}},lu=(e,t)=>{let n=null;const s=()=>{wt(n)||(clearTimeout(n),n=null)};return{cancel:s,throttle:(...r)=>{s(),n=setTimeout(()=>{n=null,e.apply(null,r)},t)}}},Ur=z("mce-annotation"),Vs=z("data-mce-annotation"),Bo=z("data-mce-annotation-uid"),zr=z("data-mce-annotation-active"),Hr=z("data-mce-annotation-classes"),Wr=z("data-mce-annotation-attrs"),Zp=e=>t=>ve(t,e),Qp=(e,t)=>{const n=e.selection.getRng(),s=C.fromDom(n.startContainer),o=C.fromDom(e.getBody()),r=t.fold(()=>"."+Ur(),l=>`[${Vs()}="${l}"]`),a=xo(s,n.startOffset).getOr(s);return Os(a,r,Zp(o)).bind(l=>Vn(l,`${Bo()}`).bind(c=>Vn(l,`${Vs()}`).map(u=>{const f=eh(e,c);return{uid:c,name:u,elements:f}})))},KA=e=>$t(e)&&Sc(e,Ur()),Jp=(e,t)=>vr(e,"data-mce-bogus")||dp(e,'[data-mce-bogus="all"]',Zp(t)),eh=(e,t)=>{const n=C.fromDom(e.getBody()),s=gt(n,`[${Bo()}="${t}"]`);return oe(s,o=>!Jp(o,n))},th=(e,t)=>{const n=C.fromDom(e.getBody()),s=gt(n,`[${Vs()}="${t}"]`),o={};return P(s,r=>{if(!Jp(r,n)){const a=Ft(r,Bo()),i=Pe(o,a).getOr([]);o[a]=i.concat([r])}}),o},GA=(e,t)=>{const n=et({}),s=()=>({listeners:[],previous:ms()}),o=(f,d)=>{r(f,p=>(d(p),p))},r=(f,d)=>{const p=n.get(),b=Pe(p,f).getOrThunk(s),g=d(b);p[f]=g,n.set(p)},a=(f,d,p)=>{o(f,b=>{P(b.listeners,g=>g(!0,f,{uid:d,nodes:he(p,h=>h.dom)}))})},i=f=>{o(f,d=>{P(d.listeners,p=>p(!1,f))})},l=(f,d)=>{P(eh(e,f),p=>{d?st(p,zr(),"true"):ot(p,zr())})},c=lu(()=>{const f=Ns(t.getNames());P(f,d=>{r(d,p=>{const b=p.previous.get();return Qp(e,m.some(d)).fold(()=>{b.each(g=>{i(d),p.previous.clear(),l(g,!1)})},({uid:g,name:h,elements:y})=>{So(b,g)||(b.each(E=>l(E,!1)),a(h,g,y),p.previous.set(g),l(g,!0))}),{previous:p.previous,listeners:p.listeners}})})},30);return e.on("remove",()=>{c.cancel()}),e.on("NodeChange",()=>{c.throttle()}),{addListener:(f,d)=>{r(f,p=>({previous:p.previous,listeners:p.listeners.concat([d])}))}}},YA=(e,t)=>{const n=Vs(),s=r=>m.from(r.attr(n)).bind(t.lookup),o=r=>{var a,i;r.attr(Bo(),null),r.attr(Vs(),null),r.attr(zr(),null);const l=m.from(r.attr(Wr())).map(d=>d.split(",")).getOr([]),c=m.from(r.attr(Hr())).map(d=>d.split(",")).getOr([]);P(l,d=>r.attr(d,null));const u=(i=(a=r.attr("class"))===null||a===void 0?void 0:a.split(" "))!==null&&i!==void 0?i:[],f=Wa(u,[Ur()].concat(c));r.attr("class",f.length>0?f.join(" "):null),r.attr(Hr(),null),r.attr(Wr(),null)};e.serializer.addTempAttr(zr()),e.serializer.addAttributeFilter(n,r=>{for(const a of r)s(a).each(i=>{i.persistent===!1&&(a.name==="span"?a.unwrap():o(a))})})},XA=()=>{const e={};return{register:(o,r)=>{e[o]={name:o,settings:r}},lookup:o=>Pe(e,o).map(r=>r.settings),getNames:()=>Pt(e)}};let nh=0;const Vr=e=>{const n=new Date().getTime(),s=Math.floor(Math.random()*1e9);return nh++,e+"_"+s+nh+String(n)},ZA=(e,t)=>{P(t,n=>{ko(e,n)})},QA=(e,t)=>{P(t,n=>{Sr(e,n)})},sh=(e,t)=>C.fromDom(e.dom.cloneNode(t)),js=e=>sh(e,!1),oh=e=>sh(e,!0),JA=(e,t)=>{const n=C.fromTag(t),s=Mg(e);return Wn(n,s),n},eT=(e,t)=>{const n=JA(e,t);Gn(e,n);const s=rt(e);return Ls(n,s),De(e),n},rh=(e,t,n=$e)=>{const s=new Xe(e,t),o=r=>{let a;do a=s[r]();while(a&&!B(a)&&!n(a));return m.from(a).filter(B)};return{current:()=>m.from(s.current()).filter(B),next:()=>o("next"),prev:()=>o("prev"),prev2:()=>o("prev2")}},qs=(e,t)=>{const n=t||(a=>e.isBlock(a)||Me(a)||Be(a)),s=(a,i,l,c)=>{if(B(a)){const u=c(a,i,a.data);if(u!==-1)return m.some({container:a,offset:u})}return l().bind(u=>s(u.container,u.offset,l,c))};return{backwards:(a,i,l,c)=>{const u=rh(a,c??e.getRoot(),n);return s(a,i,()=>u.prev().map(f=>({container:f,offset:f.length})),l).getOrNull()},forwards:(a,i,l,c)=>{const u=rh(a,c??e.getRoot(),n);return s(a,i,()=>u.next().map(f=>({container:f,offset:0})),l).getOrNull()}}},Oo=Math.round,Ks=e=>e?{left:Oo(e.left),top:Oo(e.top),bottom:Oo(e.bottom),right:Oo(e.right),width:Oo(e.width),height:Oo(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0},ah=(e,t)=>(e=Ks(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e),tT=(e,t)=>e.left===t.left&&e.top===t.top&&e.bottom===t.bottom&&e.right===t.right,ih=(e,t,n)=>e>=0&&e<=Math.min(t.height,n.height)/2,jr=(e,t)=>{const n=Math.min(t.height/2,e.height/2);return e.bottom-n<t.top?!0:e.top>t.bottom?!1:ih(t.top-e.bottom,e,t)},qr=(e,t)=>e.top>t.bottom?!0:e.bottom<t.top?!1:ih(t.bottom-e.top,e,t),nT=(e,t,n)=>t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom,sT=e=>Tt(e,(t,n)=>t.fold(()=>m.some(n),s=>{const o=Math.min(n.left,s.left),r=Math.min(n.top,s.top),a=Math.max(n.right,s.right),i=Math.max(n.bottom,s.bottom);return m.some({top:r,right:a,bottom:i,left:o,width:a-o,height:i-r})}),m.none()),lh=(e,t,n)=>{const s=Math.max(Math.min(t,e.left+e.width),e.left),o=Math.max(Math.min(n,e.top+e.height),e.top);return Math.sqrt((t-s)*(t-s)+(n-o)*(n-o))},oT=(e,t)=>Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),rT=(e,t,n)=>Math.min(Math.max(e,t),n),vi=e=>{const t=e.startContainer,n=e.startOffset;return t===e.endContainer&&t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null},gs=(e,t)=>{if(G(e)&&e.hasChildNodes()){const n=e.childNodes,s=rT(t,0,n.length-1);return n[s]}else return e},aT=(e,t)=>{if(!(t<0&&G(e)&&e.hasChildNodes()))return gs(e,t)},iT=new RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]"),ch=e=>Q(e)&&e.charCodeAt(0)>=768&&iT.test(e),lT=(...e)=>t=>{for(let n=0;n<e.length;n++)if(e[n](t))return!0;return!1},cT=(...e)=>t=>{for(let n=0;n<e.length;n++)if(!e[n](t))return!1;return!0},uh=G,uT=sn,fh=ri("display","block table"),fT=ri("float","left right"),Kr=cT(uh,uT,ur(fT)),dT=ur(ri("white-space","pre pre-line pre-wrap")),Gr=B,cu=Me,dh=Ae.nodeIndex,Ei=aT,uu=e=>e?e.createRange():Ae.DOM.createRng(),fu=e=>Q(e)&&/[\r\n\t ]/.test(e),mh=e=>!!e.setStart&&!!e.setEnd,du=e=>{const t=e.startContainer,n=e.startOffset;if(fu(e.toString())&&dT(t.parentNode)&&B(t)){const s=t.data;if(fu(s[n-1])||fu(s[n+1]))return!0}return!1},mT=e=>{const t=e.ownerDocument,n=uu(t),s=t.createTextNode(Je),o=e.parentNode;o.insertBefore(s,e),n.setStart(s,0),n.setEnd(s,1);const r=Ks(n.getBoundingClientRect());return o.removeChild(s),r},gT=e=>{const t=e.startContainer,n=e.endContainer,s=e.startOffset,o=e.endOffset;if(t===n&&B(n)&&s===0&&o===1){const r=e.cloneRange();return r.setEndAfter(n),ps(r)}else return null},gh=e=>e.left===0&&e.right===0&&e.top===0&&e.bottom===0,ps=e=>{var t;let n;const s=e.getClientRects();return s.length>0?n=Ks(s[0]):n=Ks(e.getBoundingClientRect()),!mh(e)&&cu(e)&&gh(n)?mT(e):gh(n)&&mh(e)&&(t=gT(e))!==null&&t!==void 0?t:n},Gs=(e,t)=>{const n=ah(e,t);return n.width=1,n.right=n.left+1,n},pT=e=>{const t=[],n=a=>{a.height!==0&&(t.length>0&&tT(a,t[t.length-1])||t.push(a))},s=(a,i)=>{const l=uu(a.ownerDocument);if(i<a.data.length){if(ch(a.data[i]))return;if(ch(a.data[i-1])&&(l.setStart(a,i),l.setEnd(a,i+1),!du(l))){n(Gs(ps(l),!1));return}}i>0&&(l.setStart(a,i-1),l.setEnd(a,i),du(l)||n(Gs(ps(l),!1))),i<a.data.length&&(l.setStart(a,i),l.setEnd(a,i+1),du(l)||n(Gs(ps(l),!0)))},o=e.container(),r=e.offset();if(Gr(o))return s(o,r),t;if(uh(o))if(e.isAtEnd()){const a=Ei(o,r);Gr(a)&&s(a,a.data.length),Kr(a)&&!cu(a)&&n(Gs(ps(a),!1))}else{const a=Ei(o,r);if(Gr(a)&&s(a,0),Kr(a)&&e.isAtEnd())return n(Gs(ps(a),!1)),t;const i=Ei(e.container(),e.offset()-1);Kr(i)&&!cu(i)&&(fh(i)||fh(a)||!Kr(a))&&n(Gs(ps(i),!1)),Kr(a)&&n(Gs(ps(a),!0))}return t},N=(e,t,n)=>{const s=()=>(Gr(e),t===0),o=()=>Gr(e)?t>=e.data.length:t>=e.childNodes.length,r=()=>{const u=uu(e.ownerDocument);return u.setStart(e,t),u.setEnd(e,t),u},a=()=>(n||(n=pT(N(e,t))),n),i=()=>a().length>0,l=u=>u&&e===u.container()&&t===u.offset(),c=u=>Ei(e,u?t-1:t);return{container:z(e),offset:z(t),toRange:r,getClientRects:a,isVisible:i,isAtStart:s,isAtEnd:o,isEqual:l,getNode:c}};N.fromRangeStart=e=>N(e.startContainer,e.startOffset),N.fromRangeEnd=e=>N(e.endContainer,e.endOffset),N.after=e=>N(e.parentNode,dh(e)+1),N.before=e=>N(e.parentNode,dh(e)),N.isAbove=(e,t)=>mt(Rt(t.getClientRects()),As(e.getClientRects()),jr).getOr(!1),N.isBelow=(e,t)=>mt(As(t.getClientRects()),Rt(e.getClientRects()),qr).getOr(!1),N.isAtStart=e=>e?e.isAtStart():!1,N.isAtEnd=e=>e?e.isAtEnd():!1,N.isTextPosition=e=>e?B(e.container()):!1,N.isElementPosition=e=>!N.isTextPosition(e);const Si=(e,t)=>{B(t)&&t.data.length===0&&e.remove(t)},hT=(e,t,n)=>{t.insertNode(n),Si(e,n.previousSibling),Si(e,n.nextSibling)},bT=(e,t,n)=>{const s=m.from(n.firstChild),o=m.from(n.lastChild);t.insertNode(n),s.each(r=>Si(e,r.previousSibling)),o.each(r=>Si(e,r.nextSibling))},mu=(e,t,n)=>{Oc(n)?bT(e,t,n):hT(e,t,n)},bn=B,ph=Fs,hh=Ae.nodeIndex,bh=e=>{const t=e.parentNode;return ph(t)?bh(t):t},gu=e=>e?Ga(e.childNodes,(t,n)=>(ph(n)&&n.nodeName!=="BR"?t=t.concat(gu(n)):t.push(n),t),[]):[],CT=(e,t)=>{let n=e;for(;(n=n.previousSibling)&&bn(n);)t+=n.data.length;return t},Ch=e=>t=>e===t,yT=e=>{let t,n;t=gu(bh(e)),n=og(t,Ch(e),e),t=t.slice(0,n+1);const s=Ga(t,(o,r,a)=>(bn(r)&&bn(t[a-1])&&o++,o),0);return t=hr(t,gn([e.nodeName])),n=og(t,Ch(e),e),n-s},yh=e=>(bn(e)?"text()":e.nodeName.toLowerCase())+"["+yT(e)+"]",vT=(e,t,n)=>{const s=[];for(let o=t.parentNode;o&&o!==e&&!(n&&n(o));o=o.parentNode)s.push(o);return s},vh=(e,t)=>{let n=[],s=t.container(),o=t.offset(),r;if(bn(s))r=CT(s,o);else{const i=s.childNodes;o>=i.length?(r="after",o=i.length-1):r="before",s=i[o]}n.push(yh(s));let a=vT(e,s);return a=hr(a,ur(Fs)),n=n.concat(pc(a,i=>yh(i))),n.reverse().join("/")+","+r},ET=(e,t,n)=>{let s=gu(e);return s=hr(s,(o,r)=>!bn(o)||!bn(s[r-1])),s=hr(s,gn([t])),s[n]},ST=(e,t)=>{let n=e,s=0;for(;bn(n);){const o=n.data.length;if(t>=s&&t<=s+o){e=n,t=t-s;break}if(!bn(n.nextSibling)){e=n,t=o;break}s+=o,n=n.nextSibling}return bn(e)&&t>e.data.length&&(t=e.data.length),N(e,t)},Eh=(e,t)=>{if(!t)return null;const n=t.split(","),s=n[0].split("/"),o=n.length>1?n[1]:"before",r=Ga(s,(a,i)=>{const l=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(i);return l?(l[1]==="text()"&&(l[1]="#text"),ET(a,l[1],parseInt(l[2],10))):null},e);if(!r)return null;if(!bn(r)&&r.parentNode){let a;return o==="after"?a=hh(r)+1:a=hh(r),N(r.parentNode,a)}return ST(r,parseInt(o,10))},wi=Be,wT=(e,t,n)=>{let s=e(t.data.slice(0,n)).length;for(let o=t.previousSibling;o&&B(o);o=o.previousSibling)s+=e(o.data).length;return s},Sh=(e,t,n,s,o)=>{const r=o?s.startContainer:s.endContainer;let a=o?s.startOffset:s.endOffset;const i=[],l=e.getRoot();if(B(r))i.push(n?wT(t,r,a):a);else{let c=0;const u=r.childNodes;a>=u.length&&u.length&&(c=1,a=Math.max(0,u.length-1)),i.push(e.nodeIndex(u[a],n)+c)}for(let c=r;c&&c!==l;c=c.parentNode)i.push(e.nodeIndex(c,n));return i},kT=(e,t,n,s)=>{const o=t.dom,r=Sh(o,e,n,s,!0),a=t.isForward(),i=yp(s)?{isFakeCaret:!0}:{};if(t.isCollapsed())return{start:r,forward:a,...i};{const l=Sh(o,e,n,s,!1);return{start:r,end:l,forward:a,...i}}},pu=(e,t,n)=>{let s=0;return $.each(e.select(t),o=>{if(o.getAttribute("data-mce-bogus")!=="all"){if(o===n)return!1;s++;return}}),s},wh=(e,t)=>{let n=t?e.startContainer:e.endContainer,s=t?e.startOffset:e.endOffset;if(G(n)&&n.nodeName==="TR"){const o=n.childNodes;n=o[Math.min(t?s:s-1,o.length-1)],n&&(s=t?0:n.childNodes.length,t?e.setStart(n,s):e.setEnd(n,s))}},kh=e=>(wh(e,!0),wh(e,!1),e),xh=(e,t)=>{if(G(e)&&(e=gs(e,t),wi(e)))return e;if(Wt(e)){B(e)&&Po(e)&&(e=e.parentNode);let n=e.previousSibling;if(wi(n)||(n=e.nextSibling,wi(n)))return n}},xT=e=>xh(e.startContainer,e.startOffset)||xh(e.endContainer,e.endOffset),_h=(e,t,n)=>{const s=n.getNode(),o=n.getRng();if(s.nodeName==="IMG"||wi(s)){const a=s.nodeName;return{name:a,index:pu(n.dom,a,s)}}const r=xT(o);if(r){const a=r.tagName;return{name:a,index:pu(n.dom,a,r)}}return kT(e,n,t,o)},_T=e=>{const t=e.getRng();return{start:vh(e.dom.getRoot(),N.fromRangeStart(t)),end:vh(e.dom.getRoot(),N.fromRangeEnd(t)),forward:e.isForward()}},NT=e=>({rng:e.getRng(),forward:e.isForward()}),Nh=(e,t,n)=>{const s={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",s,"&#xFEFF;"):e.create("span",s)},Ah=(e,t)=>{const n=e.dom;let s=e.getRng();const o=n.uniqueId(),r=e.isCollapsed(),a=e.getNode(),i=a.nodeName,l=e.isForward();if(i==="IMG")return{name:i,index:pu(n,i,a)};const c=kh(s.cloneRange());if(!r){c.collapse(!1);const f=Nh(n,o+"_end",t);mu(n,c,f)}s=kh(s),s.collapse(!0);const u=Nh(n,o+"_start",t);return mu(n,s,u),e.moveToBookmark({id:o,keep:!0,forward:l}),{id:o,forward:l}},AT=(e,t,n=!1)=>t===2?_h(Mt,n,e):t===3?_T(e):t?NT(e):Ah(e,!1),hu=K(_h,kt,!0),Th=e=>{const t=r=>r(e),n=z(e),s=()=>o,o={tag:!0,inner:e,fold:(r,a)=>a(e),isValue:We,isError:$e,map:r=>xt.value(r(e)),mapError:s,bind:t,exists:t,forall:t,getOr:n,or:s,getOrThunk:n,orThunk:s,getOrDie:n,each:r=>{r(e)},toOptional:()=>m.some(e)};return o},Rh=e=>{const t=()=>n,n={tag:!1,inner:e,fold:(s,o)=>s(e),isValue:$e,isError:We,map:t,mapError:s=>xt.error(s(e)),bind:t,exists:$e,forall:We,getOr:kt,or:kt,getOrThunk:cc,orThunk:cc,getOrDie:Xm(String(e)),each:ce,toOptional:m.none};return n},xt={value:Th,error:Rh,fromOption:(e,t)=>e.fold(()=>Rh(t),Th)},Pn={generate:e=>{if(!Ge(e))throw new Error("cases must be an array");if(e.length===0)throw new Error("there must be at least one case");const t=[],n={};return P(e,(s,o)=>{const r=Pt(s);if(r.length!==1)throw new Error("one and only one name per case");const a=r[0],i=s[a];if(n[a]!==void 0)throw new Error("duplicate key detected:"+a);if(a==="cata")throw new Error("cannot have a case named cata (sorry)");if(!Ge(i))throw new Error("case arguments must be an array");t.push(a),n[a]=(...l)=>{const c=l.length;if(c!==i.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+i.length+" ("+i+"), got "+c);return{fold:(...f)=>{if(f.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+f.length);return f[o].apply(null,l)},match:f=>{const d=Pt(f);if(t.length!==d.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+`
Actual: `+d.join(","));if(!rs(t,b=>Ne(d,b)))throw new Error("Not all branches were specified when using match. Specified: "+d.join(", ")+`
Required: `+t.join(", "));return f[a].apply(null,l)},log:f=>{console.log(f,{constructors:t,constructor:a,params:l})}}}}),n}};Pn.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);const TT=e=>{const t=[],n=[];return P(e,s=>{s.fold(o=>{t.push(o)},o=>{n.push(o)})}),{errors:t,values:n}},RT=e=>e.type==="inline-command"||e.type==="inline-format",PT=e=>e.type==="block-command"||e.type==="block-format",DT=e=>{const t=s=>xt.error({message:s,pattern:e}),n=(s,o,r)=>{if(e.format!==void 0){let a;if(Ge(e.format)){if(!rs(e.format,Q))return t(s+" pattern has non-string items in the `format` array");a=e.format}else if(Q(e.format))a=[e.format];else return t(s+" pattern has non-string `format` parameter");return xt.value(o(a))}else return e.cmd!==void 0?Q(e.cmd)?xt.value(r(e.cmd,e.value)):t(s+" pattern has non-string `cmd` parameter"):t(s+" pattern is missing both `format` and `cmd` parameters")};if(!Ct(e))return t("Raw pattern is not an object");if(!Q(e.start))return t("Raw pattern is missing `start` parameter");if(e.end!==void 0){if(!Q(e.end))return t("Inline pattern has non-string `end` parameter");if(e.start.length===0&&e.end.length===0)return t("Inline pattern has empty `start` and `end` parameters");let s=e.start,o=e.end;return o.length===0&&(o=s,s=""),n("Inline",r=>({type:"inline-format",start:s,end:o,format:r}),(r,a)=>({type:"inline-command",start:s,end:o,cmd:r,value:a}))}else return e.replacement!==void 0?Q(e.replacement)?e.start.length===0?t("Replacement pattern has empty `start` parameter"):xt.value({type:"inline-command",start:"",end:e.start,cmd:"mceInsertContent",value:e.replacement}):t("Replacement pattern has non-string `replacement` parameter"):e.start.length===0?t("Block pattern has empty `start` parameter"):n("Block",s=>({type:"block-format",start:e.start,format:s[0]}),(s,o)=>({type:"block-command",start:e.start,cmd:s,value:o}))},Ph=e=>oe(e,PT),Dh=e=>oe(e,RT),BT=(e,t)=>({inlinePatterns:Dh(e),blockPatterns:Ph(e),dynamicPatternsLookup:t}),Bh=e=>{const t=TT(he(e,DT));return P(t.errors,n=>console.error(n.message,n.pattern)),t.values},OT=e=>t=>{const n=e(t);return Bh(n)},bu=_n().deviceType,IT=bu.isTouch(),LT=Ae.DOM,$T=e=>{const t=e.indexOf("=")>0?e.split(/[;,](?![^=;,]*(?:[;,]|$))/):e.split(",");return Tt(t,(n,s)=>{const o=s.split("="),r=o[0],a=o.length>1?o[1]:r;return n[Eo(r)]=Eo(a),n},{})},Oh=e=>Ha(e,RegExp),W=e=>t=>t.options.get(e),Cu=e=>Q(e)||Ct(e),Ih=(e,t="")=>n=>{const s=Q(n);if(s)if(n.indexOf("=")!==-1){const o=$T(n);return{value:Pe(o,e.id).getOr(t),valid:s}}else return{value:n,valid:s};else return{valid:!1,message:"Must be a string."}},FT=e=>{const t=e.options.register;t("id",{processor:"string",default:e.id}),t("selector",{processor:"string"}),t("target",{processor:"object"}),t("suffix",{processor:"string"}),t("cache_suffix",{processor:"string"}),t("base_url",{processor:"string"}),t("referrer_policy",{processor:"string",default:""}),t("language_load",{processor:"boolean",default:!0}),t("inline",{processor:"boolean",default:!1}),t("iframe_attrs",{processor:"object",default:{}}),t("doctype",{processor:"string",default:"<!DOCTYPE html>"}),t("document_base_url",{processor:"string",default:e.documentBaseUrl}),t("body_id",{processor:Ih(e,"tinymce"),default:"tinymce"}),t("body_class",{processor:Ih(e),default:""}),t("content_security_policy",{processor:"string",default:""}),t("br_in_pre",{processor:"boolean",default:!0}),t("forced_root_block",{processor:n=>{const s=Q(n)&&xn(n);return s?{value:n,valid:s}:{valid:!1,message:"Must be a non-empty string."}},default:"p"}),t("forced_root_block_attrs",{processor:"object",default:{}}),t("newline_behavior",{processor:n=>{const s=Ne(["block","linebreak","invert","default"],n);return s?{value:n,valid:s}:{valid:!1,message:"Must be one of: block, linebreak, invert or default."}},default:"default"}),t("br_newline_selector",{processor:"string",default:".mce-toc h2,figcaption,caption"}),t("no_newline_selector",{processor:"string",default:""}),t("keep_styles",{processor:"boolean",default:!0}),t("end_container_on_empty_block",{processor:n=>_s(n)?{valid:!0,value:n}:Q(n)?{valid:!0,value:n}:{valid:!1,message:"Must be boolean or a string"},default:"blockquote"}),t("font_size_style_values",{processor:"string",default:"xx-small,x-small,small,medium,large,x-large,xx-large"}),t("font_size_legacy_values",{processor:"string",default:"xx-small,small,medium,large,x-large,xx-large,300%"}),t("font_size_classes",{processor:"string",default:""}),t("automatic_uploads",{processor:"boolean",default:!0}),t("images_reuse_filename",{processor:"boolean",default:!1}),t("images_replace_blob_uris",{processor:"boolean",default:!0}),t("icons",{processor:"string",default:""}),t("icons_url",{processor:"string",default:""}),t("images_upload_url",{processor:"string",default:""}),t("images_upload_base_path",{processor:"string",default:""}),t("images_upload_credentials",{processor:"boolean",default:!1}),t("images_upload_handler",{processor:"function"}),t("language",{processor:"string",default:"en"}),t("language_url",{processor:"string",default:""}),t("entity_encoding",{processor:"string",default:"named"}),t("indent",{processor:"boolean",default:!0}),t("indent_before",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_after",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_use_margin",{processor:"boolean",default:!1}),t("indentation",{processor:"string",default:"40px"}),t("content_css",{processor:n=>{const s=n===!1||Q(n)||bo(n,Q);return s?Q(n)?{value:he(n.split(","),Eo),valid:s}:Ge(n)?{value:n,valid:s}:n===!1?{value:[],valid:s}:{value:n,valid:s}:{valid:!1,message:"Must be false, a string or an array of strings."}},default:Eu(e)?[]:["default"]}),t("content_style",{processor:"string"}),t("content_css_cors",{processor:"boolean",default:!1}),t("font_css",{processor:n=>{const s=Q(n)||bo(n,Q);return s?{value:Ge(n)?n:he(n.split(","),Eo),valid:s}:{valid:!1,message:"Must be a string or an array of strings."}},default:[]}),t("inline_boundaries",{processor:"boolean",default:!0}),t("inline_boundaries_selector",{processor:"string",default:"a[href],code,span.mce-annotation"}),t("object_resizing",{processor:n=>{const s=_s(n)||Q(n);return s?n===!1||bu.isiPhone()||bu.isiPad()?{value:"",valid:s}:{value:n===!0?"table,img,figure.image,div,video,iframe":n,valid:s}:{valid:!1,message:"Must be boolean or a string"}},default:!IT}),t("resize_img_proportional",{processor:"boolean",default:!0}),t("event_root",{processor:"object"}),t("service_message",{processor:"string"}),t("theme",{processor:n=>n===!1||Q(n)||ke(n),default:"silver"}),t("theme_url",{processor:"string"}),t("formats",{processor:"object"}),t("format_empty_lines",{processor:"boolean",default:!1}),t("format_noneditable_selector",{processor:"string",default:""}),t("preview_styles",{processor:n=>{const s=n===!1||Q(n);return s?{value:n===!1?"":n,valid:s}:{valid:!1,message:"Must be false or a string"}},default:"font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"}),t("custom_ui_selector",{processor:"string",default:""}),t("hidden_input",{processor:"boolean",default:!0}),t("submit_patch",{processor:"boolean",default:!0}),t("encoding",{processor:"string"}),t("add_form_submit_trigger",{processor:"boolean",default:!0}),t("add_unload_trigger",{processor:"boolean",default:!0}),t("custom_undo_redo_levels",{processor:"number",default:0}),t("disable_nodechange",{processor:"boolean",default:!1}),t("readonly",{processor:"boolean",default:!1}),t("editable_root",{processor:"boolean",default:!0}),t("plugins",{processor:"string[]",default:[]}),t("external_plugins",{processor:"object"}),t("forced_plugins",{processor:"string[]"}),t("model",{processor:"string",default:e.hasPlugin("rtc")?"plugin":"dom"}),t("model_url",{processor:"string"}),t("block_unsupported_drop",{processor:"boolean",default:!0}),t("visual",{processor:"boolean",default:!0}),t("visual_table_class",{processor:"string",default:"mce-item-table"}),t("visual_anchor_class",{processor:"string",default:"mce-item-anchor"}),t("iframe_aria_text",{processor:"string",default:"Rich Text Area. Press ALT-0 for help."}),t("setup",{processor:"function"}),t("init_instance_callback",{processor:"function"}),t("url_converter",{processor:"function",default:e.convertURL}),t("url_converter_scope",{processor:"object",default:e}),t("urlconverter_callback",{processor:"function"}),t("allow_conditional_comments",{processor:"boolean",default:!1}),t("allow_html_data_urls",{processor:"boolean",default:!1}),t("allow_svg_data_urls",{processor:"boolean"}),t("allow_html_in_named_anchor",{processor:"boolean",default:!1}),t("allow_script_urls",{processor:"boolean",default:!1}),t("allow_unsafe_link_target",{processor:"boolean",default:!1}),t("convert_fonts_to_spans",{processor:"boolean",default:!0,deprecated:!0}),t("fix_list_elements",{processor:"boolean",default:!1}),t("preserve_cdata",{processor:"boolean",default:!1}),t("remove_trailing_brs",{processor:"boolean",default:!0}),t("pad_empty_with_br",{processor:"boolean",default:!1}),t("inline_styles",{processor:"boolean",default:!0,deprecated:!0}),t("element_format",{processor:"string",default:"html"}),t("entities",{processor:"string"}),t("schema",{processor:"string",default:"html5"}),t("convert_urls",{processor:"boolean",default:!0}),t("relative_urls",{processor:"boolean",default:!0}),t("remove_script_host",{processor:"boolean",default:!0}),t("custom_elements",{processor:"string"}),t("extended_valid_elements",{processor:"string"}),t("invalid_elements",{processor:"string"}),t("invalid_styles",{processor:Cu}),t("valid_children",{processor:"string"}),t("valid_classes",{processor:Cu}),t("valid_elements",{processor:"string"}),t("valid_styles",{processor:Cu}),t("verify_html",{processor:"boolean",default:!0}),t("auto_focus",{processor:n=>Q(n)||n===!0}),t("browser_spellcheck",{processor:"boolean",default:!1}),t("protect",{processor:"array"}),t("images_file_types",{processor:"string",default:"jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp"}),t("deprecation_warnings",{processor:"boolean",default:!0}),t("a11y_advanced_options",{processor:"boolean",default:!1}),t("api_key",{processor:"string"}),t("paste_block_drop",{processor:"boolean",default:!1}),t("paste_data_images",{processor:"boolean",default:!0}),t("paste_preprocess",{processor:"function"}),t("paste_postprocess",{processor:"function"}),t("paste_webkit_styles",{processor:"string",default:"none"}),t("paste_remove_styles_if_webkit",{processor:"boolean",default:!0}),t("paste_merge_formats",{processor:"boolean",default:!0}),t("smart_paste",{processor:"boolean",default:!0}),t("paste_as_text",{processor:"boolean",default:!1}),t("paste_tab_spaces",{processor:"number",default:4}),t("text_patterns",{processor:n=>bo(n,Ct)||n===!1?{value:Bh(n===!1?[]:n),valid:!0}:{valid:!1,message:"Must be an array of objects or false."},default:[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}]}),t("text_patterns_lookup",{processor:n=>ke(n)?{value:OT(n),valid:!0}:{valid:!1,message:"Must be a single function"},default:n=>[]}),t("noneditable_class",{processor:"string",default:"mceNonEditable"}),t("editable_class",{processor:"string",default:"mceEditable"}),t("noneditable_regexp",{processor:n=>bo(n,Oh)?{value:n,valid:!0}:Oh(n)?{value:[n],valid:!0}:{valid:!1,message:"Must be a RegExp or an array of RegExp."},default:[]}),t("table_tab_navigation",{processor:"boolean",default:!0}),t("highlight_on_focus",{processor:"boolean",default:!1}),t("xss_sanitization",{processor:"boolean",default:!0}),t("details_initial_state",{processor:n=>{const s=Ne(["inherited","collapsed","expanded"],n);return s?{value:n,valid:s}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),t("details_serialized_state",{processor:n=>{const s=Ne(["inherited","collapsed","expanded"],n);return s?{value:n,valid:s}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),t("init_content_sync",{processor:"boolean",default:!1}),t("newdocument_content",{processor:"string",default:""}),t("force_hex_color",{processor:n=>{const s=["always","rgb_only","off"],o=Ne(s,n);return o?{value:n,valid:o}:{valid:!1,message:`Must be one of: ${s.join(", ")}.`}},default:"off"}),t("sandbox_iframes",{processor:"boolean",default:!1}),t("convert_unsafe_embeds",{processor:"boolean",default:!1}),e.on("ScriptsLoaded",()=>{t("directionality",{processor:"string",default:hn.isRtl()?"rtl":void 0}),t("placeholder",{processor:"string",default:LT.getAttrib(e.getElement(),"placeholder")})})},MT=W("iframe_attrs"),UT=W("doctype"),Lh=W("document_base_url"),zT=W("body_id"),HT=W("body_class"),$h=W("content_security_policy"),WT=W("br_in_pre"),pt=W("forced_root_block"),Yr=W("forced_root_block_attrs"),VT=W("newline_behavior"),jT=W("br_newline_selector"),qT=W("no_newline_selector"),KT=W("keep_styles"),GT=W("end_container_on_empty_block"),Fh=W("automatic_uploads"),Mh=W("images_reuse_filename"),YT=W("images_replace_blob_uris"),Uh=W("icons"),XT=W("icons_url"),ZT=W("images_upload_url"),QT=W("images_upload_base_path"),JT=W("images_upload_credentials"),eR=W("images_upload_handler"),tR=W("content_css_cors"),yu=W("referrer_policy"),zh=W("language"),nR=W("language_url"),Hh=W("indent_use_margin"),sR=W("indentation"),oR=W("content_css"),rR=W("content_style"),Wh=W("font_css"),aR=W("directionality"),iR=W("inline_boundaries_selector"),Vh=W("object_resizing"),lR=W("resize_img_proportional"),cR=W("placeholder"),jh=W("event_root"),uR=W("service_message"),Io=W("theme"),fR=W("theme_url"),vu=W("model"),dR=W("model_url"),Xr=W("inline_boundaries"),mR=W("formats"),gR=W("preview_styles"),pR=W("format_empty_lines"),hR=W("format_noneditable_selector"),bR=W("custom_ui_selector"),Eu=W("inline"),CR=W("hidden_input"),yR=W("submit_patch"),vR=W("add_form_submit_trigger"),ER=W("add_unload_trigger"),SR=W("custom_undo_redo_levels"),wR=W("disable_nodechange"),qh=W("readonly"),kR=W("editable_root"),Kh=W("content_css_cors"),ki=W("plugins"),xR=W("external_plugins"),_R=W("block_unsupported_drop"),NR=W("visual"),AR=W("visual_table_class"),Gh=W("visual_anchor_class"),TR=W("iframe_aria_text"),RR=W("setup"),PR=W("init_instance_callback"),DR=W("urlconverter_callback"),BR=W("auto_focus"),OR=W("browser_spellcheck"),IR=W("protect"),LR=W("paste_block_drop"),xi=W("paste_data_images"),$R=W("paste_preprocess"),FR=W("paste_postprocess"),MR=W("newdocument_content"),UR=W("paste_webkit_styles"),zR=W("paste_remove_styles_if_webkit"),HR=W("paste_merge_formats"),WR=W("smart_paste"),VR=W("paste_as_text"),jR=W("paste_tab_spaces"),qR=W("allow_html_data_urls"),KR=W("text_patterns"),GR=W("text_patterns_lookup"),Yh=W("noneditable_class"),YR=W("editable_class"),XR=W("noneditable_regexp"),ZR=W("preserve_cdata"),QR=W("highlight_on_focus"),Su=W("xss_sanitization"),JR=W("init_content_sync"),eP=e=>e.options.isSet("text_patterns_lookup"),tP=e=>$.explode(e.options.get("font_size_style_values")),nP=e=>$.explode(e.options.get("font_size_classes")),sP=e=>e.options.get("encoding")==="xml",Xh=e=>$.explode(e.options.get("images_file_types")),oP=W("table_tab_navigation"),rP=W("details_initial_state"),aP=W("details_serialized_state"),iP=W("force_hex_color"),wu=W("sandbox_iframes"),lP=G,Zh=B,Qh=e=>{const t=e.parentNode;t&&t.removeChild(e)},Jh=e=>{const t=Mt(e);return{count:e.length-t.length,text:t}},eb=e=>{let t;for(;(t=e.data.lastIndexOf(Ze))!==-1;)e.deleteData(t,1)},tb=(e,t)=>(Ys(e),t),cP=(e,t)=>{const n=Jh(e.data.substr(0,t.offset())),s=Jh(e.data.substr(t.offset()));return(n.text+s.text).length>0?(eb(e),N(e,t.offset()-n.count)):t},uP=(e,t)=>{const n=t.container(),s=Ex(Lt(n.childNodes),e).map(o=>o<t.offset()?N(n,t.offset()-1):t).getOr(t);return Ys(e),s},fP=(e,t)=>Zh(e)&&t.container()===e?cP(e,t):tb(e,t),dP=(e,t)=>t.container()===e.parentNode?uP(e,t):tb(e,t),mP=(e,t)=>N.isTextPosition(t)?fP(e,t):dP(e,t),Ys=e=>{lP(e)&&Wt(e)&&(Cp(e)?e.removeAttribute("data-mce-caret"):Qh(e)),Zh(e)&&(eb(e),e.data.length===0&&Qh(e))},gP=Be,pP=Rn,hP=ai,bP="*[contentEditable=false],video,audio,embed,object",nb=(e,t,n)=>{const s=ah(t.getBoundingClientRect(),n);let o,r;if(e.tagName==="BODY"){const i=e.ownerDocument.documentElement;o=e.scrollLeft||i.scrollLeft,r=e.scrollTop||i.scrollTop}else{const i=e.getBoundingClientRect();o=e.scrollLeft-i.left,r=e.scrollTop-i.top}s.left+=o,s.right+=o,s.top+=r,s.bottom+=r,s.width=1;let a=t.offsetWidth-t.clientWidth;return a>0&&(n&&(a*=-1),s.left+=a,s.right+=a),s},CP=e=>{var t,n;const s=gt(C.fromDom(e),bP);for(let o=0;o<s.length;o++){const r=s[o].dom;let a=r.previousSibling;if(fi(a)){const i=a.data;i.length===1?(t=a.parentNode)===null||t===void 0||t.removeChild(a):a.deleteData(i.length-1,1)}a=r.nextSibling,ui(a)&&(a.data.length===1?(n=a.parentNode)===null||n===void 0||n.removeChild(a):a.deleteData(0,1))}},yP=(e,t,n,s)=>{const o=ms();let r,a;const i=pt(e),l=e.dom,c=(g,h)=>{let y;if(u(),hP(h))return null;if(n(h)){const E=yN(i,h,g),v=nb(t,h,g);l.setStyle(E,"top",v.top),a=E;const S=l.create("div",{class:"mce-visual-caret","data-mce-bogus":"all"});l.setStyles(S,{...v}),l.add(t,S),o.set({caret:S,element:h,before:g}),g&&l.addClass(S,"mce-visual-caret-before"),f(),y=h.ownerDocument.createRange(),y.setStart(E,0),y.setEnd(E,0)}else return a=CN(h,g),y=h.ownerDocument.createRange(),Zr(a.nextSibling)?(y.setStart(a,0),y.setEnd(a,0)):(y.setStart(a,1),y.setEnd(a,1)),y;return y},u=()=>{CP(t),a&&(Ys(a),a=null),o.on(g=>{l.remove(g.caret),o.clear()}),r&&(clearInterval(r),r=void 0)},f=()=>{r=setInterval(()=>{o.on(g=>{s()?l.toggleClass(g.caret,"mce-visual-caret-hidden"):l.addClass(g.caret,"mce-visual-caret-hidden")})},500)};return{show:c,hide:u,getCss:()=>".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}",reposition:()=>{o.on(g=>{const h=nb(t,g.element,g.before);l.setStyles(g.caret,{...h})})},destroy:()=>clearInterval(r)}},sb=()=>be.browser.isFirefox(),Zr=e=>gP(e)||pP(e),Qr=e=>(Zr(e)||Zn(e)&&sb())&&Ja(C.fromDom(e)).exists(Is),vP=nn,ku=Be,EP=Rn,ob=ri("display","block table table-cell table-caption list-item"),rb=Wt,ab=Po,SP=G,wP=B,kP=sn,Lo=e=>e>0,Xs=e=>e<0,_i=(e,t)=>{let n;for(;n=e(t);)if(!ab(n))return n;return null},Jr=(e,t,n,s,o)=>{const r=new Xe(e,s),a=ku(e)||ab(e);let i;if(Xs(t)){if(a&&(i=_i(r.prev.bind(r),!0),n(i)))return i;for(;i=_i(r.prev.bind(r),o);)if(n(i))return i}if(Lo(t)){if(a&&(i=_i(r.next.bind(r),!0),n(i)))return i;for(;i=_i(r.next.bind(r),o);)if(n(i))return i}return null},xP=(e,t)=>{const n=o=>vP(o.dom),s=o=>o.dom===t;return Kn(C.fromDom(e),n,s).map(o=>o.dom).getOr(t)},hs=(e,t)=>{for(;e&&e!==t;){if(ob(e))return e;e=e.parentNode}return null},Dn=(e,t,n)=>hs(e.container(),n)===hs(t.container(),n),xu=(e,t)=>{if(!t)return m.none();const n=t.container(),s=t.offset();return SP(n)?m.from(n.childNodes[s+e]):m.none()},ib=(e,t)=>{var n;const o=((n=t.ownerDocument)!==null&&n!==void 0?n:document).createRange();return e?(o.setStartBefore(t),o.setEndBefore(t)):(o.setStartAfter(t),o.setEndAfter(t)),o},_P=(e,t,n)=>hs(t,e)===hs(n,e),lb=(e,t,n)=>{const s=e?"previousSibling":"nextSibling";let o=n;for(;o&&o!==t;){let r=o[s];if(r&&rb(r)&&(r=r[s]),ku(r)||EP(r)){if(_P(t,r,o))return r;break}if(kP(r))break;o=o.parentNode}return null},ea=K(ib,!0),ta=K(ib,!1),_u=(e,t,n)=>{let s;const o=K(lb,!0,t),r=K(lb,!1,t),a=n.startContainer,i=n.startOffset;if(Po(a)){const l=wP(a)?a.parentNode:a,c=l.getAttribute("data-mce-caret");if(c==="before"&&(s=l.nextSibling,Qr(s)))return ea(s);if(c==="after"&&(s=l.previousSibling,Qr(s)))return ta(s)}if(!n.collapsed)return n;if(B(a)){if(rb(a)){if(e===1){if(s=r(a),s)return ea(s);if(s=o(a),s)return ta(s)}if(e===-1){if(s=o(a),s)return ta(s);if(s=r(a),s)return ea(s)}return n}if(fi(a)&&i>=a.data.length-1)return e===1&&(s=r(a),s)?ea(s):n;if(ui(a)&&i<=1)return e===-1&&(s=o(a),s)?ta(s):n;if(i===a.data.length)return s=r(a),s?ea(s):n;if(i===0)return s=o(a),s?ta(s):n}return n},cb=(e,t)=>xu(e?0:-1,t).filter(ku),na=(e,t,n)=>{const s=_u(e,t,n);return e===-1?N.fromRangeStart(s):N.fromRangeEnd(s)},Ni=e=>m.from(e.getNode()).map(C.fromDom),NP=e=>m.from(e.getNode(!0)).map(C.fromDom),Nu=(e,t)=>{let n=t;for(;n=e(n);)if(n.isVisible())return n;return n},Ai=(e,t)=>{const n=Dn(e,t);return!n&&Me(e.getNode())?!0:n};var tt;(function(e){e[e.Backwards=-1]="Backwards",e[e.Forwards=1]="Forwards"})(tt||(tt={}));const AP=Be,Bn=B,ub=G,Au=Me,$o=sn,fb=RN,Ti=Sp,TP=(e,t)=>{const n=[];let s=e;for(;s&&s!==t;)n.push(s),s=s.parentNode;return n},db=(e,t)=>e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null,mb=(e,t)=>{if(Lo(e)){if($o(t.previousSibling)&&!Bn(t.previousSibling))return N.before(t);if(Bn(t))return N(t,0)}if(Xs(e)){if($o(t.nextSibling)&&!Bn(t.nextSibling))return N.after(t);if(Bn(t))return N(t,t.data.length)}return Xs(e)?Au(t)?N.before(t):N.after(t):N.before(t)},RP=(e,t)=>{const n=t.nextSibling;return n&&$o(n)?Bn(n)?N(n,0):N.before(n):Tu(tt.Forwards,N.after(t),e)},Tu=(e,t,n)=>{let s,o,r,a;if(!ub(n)||!t)return null;if(t.isEqual(N.after(n))&&n.lastChild){if(a=N.after(n.lastChild),Xs(e)&&$o(n.lastChild)&&ub(n.lastChild))return Au(n.lastChild)?N.before(n.lastChild):a}else a=t;const i=a.container();let l=a.offset();if(Bn(i)){if(Xs(e)&&l>0)return N(i,--l);if(Lo(e)&&l<i.length)return N(i,++l);s=i}else{if(Xs(e)&&l>0&&(o=db(i,l-1),$o(o)))return!fb(o)&&(r=Jr(o,e,Ti,o),r)?Bn(r)?N(r,r.data.length):N.after(r):Bn(o)?N(o,o.data.length):N.before(o);if(Lo(e)&&l<i.childNodes.length&&(o=db(i,l),$o(o)))return Au(o)?RP(n,o):!fb(o)&&(r=Jr(o,e,Ti,o),r)?Bn(r)?N(r,0):N.before(r):Bn(o)?N(o,0):N.after(o);s=o||a.getNode()}if(s&&(Lo(e)&&a.isAtEnd()||Xs(e)&&a.isAtStart())&&(s=Jr(s,e,We,n,!0),Ti(s,n)))return mb(e,s);o=s&&Jr(s,e,Ti,n);const c=Ts(oe(TP(i,n),AP));return c&&(!o||!c.contains(o))?(Lo(e)?a=N.after(c):a=N.before(c),a):o?mb(e,o):null},On=e=>({next:t=>Tu(tt.Forwards,t,e),prev:t=>Tu(tt.Backwards,t,e)}),PP=(e,t,n)=>{const s=e?N.before(n):N.after(n);return Vt(e,t,s)},DP=e=>Me(e)?N.before(e):N.after(e),gb=e=>N.isTextPosition(e)?e.offset()===0:sn(e.getNode()),pb=e=>{if(N.isTextPosition(e)){const t=e.container();return e.offset()===t.data.length}else return sn(e.getNode(!0))},hb=(e,t)=>!N.isTextPosition(e)&&!N.isTextPosition(t)&&e.getNode()===t.getNode(!0),BP=e=>!N.isTextPosition(e)&&Me(e.getNode()),OP=(e,t,n)=>e?!hb(t,n)&&!BP(t)&&pb(t)&&gb(n):!hb(n,t)&&gb(t)&&pb(n),Vt=(e,t,n)=>{const s=On(t);return m.from(e?s.next(n):s.prev(n))},Fo=(e,t,n)=>Vt(e,t,n).bind(s=>Dn(n,s,t)&&OP(e,n,s)?Vt(e,t,s):m.some(s)),bb=(e,t,n,s)=>Fo(e,t,n).bind(o=>s(o)?bb(e,t,o,s):m.some(o)),Mo=(e,t)=>{const n=e?t.firstChild:t.lastChild;return B(n)?m.some(N(n,e?0:n.data.length)):n?sn(n)?m.some(e?N.before(n):DP(n)):PP(e,t,n):m.none()},_t=K(Vt,!0),Bt=K(Vt,!1),ht=K(Mo,!0),on=K(Mo,!1),Ru="_mce_caret",jt=e=>G(e)&&e.id===Ru,Zs=(e,t)=>{let n=t;for(;n&&n!==e;){if(jt(n))return n;n=n.parentNode}return null},IP=e=>Q(e.start),LP=e=>re(e,"rng"),$P=e=>re(e,"id"),Cb=e=>re(e,"name"),yb=e=>$.isArray(e.start),Ri=e=>!Cb(e)&&_s(e.forward)?e.forward:!0,vb=(e,t)=>(G(t)&&e.isBlock(t)&&!t.innerHTML&&(t.innerHTML='<br data-mce-bogus="1" />'),t),FP=(e,t)=>{const n=m.from(Eh(e.getRoot(),t.start)),s=m.from(Eh(e.getRoot(),t.end));return mt(n,s,(o,r)=>{const a=e.createRng();return a.setStart(o.container(),o.offset()),a.setEnd(r.container(),r.offset()),{range:a,forward:Ri(t)}})},MP=(e,t)=>{var n;const o=((n=e.ownerDocument)!==null&&n!==void 0?n:document).createTextNode(Ze);e.appendChild(o),t.setStart(o,0),t.setEnd(o,0)},UP=e=>!e.hasChildNodes(),zP=(e,t)=>on(e).fold($e,n=>(t.setStart(n.container(),n.offset()),t.setEnd(n.container(),n.offset()),!0)),Eb=(e,t,n)=>UP(t)&&Zs(e,t)?(MP(t,n),!0):!1,Sb=(e,t,n,s)=>{const o=n[t?"start":"end"],r=e.getRoot();if(o){let a=r,i=o[0];for(let l=o.length-1;a&&l>=1;l--){const c=a.childNodes;if(Eb(r,a,s))return!0;if(o[l]>c.length-1)return Eb(r,a,s)?!0:zP(a,s);a=c[o[l]]}B(a)&&(i=Math.min(o[0],a.data.length)),G(a)&&(i=Math.min(o[0],a.childNodes.length)),t?s.setStart(a,i):s.setEnd(a,i)}return!0},Pu=e=>B(e)&&e.data.length>0,wb=(e,t,n)=>{const s=e.get(n.id+"_"+t),o=s==null?void 0:s.parentNode,r=n.keep;if(s&&o){let a,i;if(t==="start"?r?s.hasChildNodes()?(a=s.firstChild,i=1):Pu(s.nextSibling)?(a=s.nextSibling,i=0):Pu(s.previousSibling)?(a=s.previousSibling,i=s.previousSibling.data.length):(a=o,i=e.nodeIndex(s)+1):(a=o,i=e.nodeIndex(s)):r?s.hasChildNodes()?(a=s.firstChild,i=1):Pu(s.previousSibling)?(a=s.previousSibling,i=s.previousSibling.data.length):(a=o,i=e.nodeIndex(s)):(a=o,i=e.nodeIndex(s)),!r){const l=s.previousSibling,c=s.nextSibling;$.each($.grep(s.childNodes),f=>{B(f)&&(f.data=f.data.replace(/\uFEFF/g,""))});let u;for(;u=e.get(n.id+"_"+t);)e.remove(u,!0);if(B(c)&&B(l)&&!be.browser.isOpera()){const f=l.data.length;l.appendData(c.data),e.remove(c),a=l,i=f}}return m.some(N(a,i))}else return m.none()},HP=(e,t)=>{const n=e.createRng();return Sb(e,!0,t,n)&&Sb(e,!1,t,n)?m.some({range:n,forward:Ri(t)}):m.none()},WP=(e,t)=>{const n=wb(e,"start",t),s=wb(e,"end",t);return mt(n,s.or(n),(o,r)=>{const a=e.createRng();return a.setStart(vb(e,o.container()),o.offset()),a.setEnd(vb(e,r.container()),r.offset()),{range:a,forward:Ri(t)}})},VP=(e,t)=>m.from(e.select(t.name)[t.index]).map(n=>{const s=e.createRng();return s.selectNode(n),{range:s,forward:!0}}),jP=(e,t)=>{const n=e.dom;if(t){if(yb(t))return HP(n,t);if(IP(t))return FP(n,t);if($P(t))return WP(n,t);if(Cb(t))return VP(n,t);if(LP(t))return m.some({range:t.rng,forward:Ri(t)})}return m.none()},qP=(e,t,n)=>AT(e,t,n),KP=(e,t)=>{jP(e,t).each(({range:n,forward:s})=>{e.setRng(n,s)})},qt=e=>G(e)&&e.tagName==="SPAN"&&e.getAttribute("data-mce-type")==="bookmark",Pi=(e=>t=>e===t)(Je),Uo=e=>e!==""&&` \f
\r	\v`.indexOf(e)!==-1,Du=e=>!Uo(e)&&!Pi(e)&&!Lc(e),Bu=e=>{const t=[];if(e)for(let n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t},GP=e=>en(e,t=>{const n=vi(t);return n?[C.fromDom(n)]:[]}),YP=e=>Bu(e).length>1,XP=e=>oe(GP(e),Br),ZP=e=>gt(e,"td[data-mce-selected],th[data-mce-selected]"),kb=(e,t)=>{const n=ZP(t);return n.length>0?n:XP(e)},zo=e=>kb(Bu(e.selection.getSel()),C.fromDom(e.getBody())),sa=(e,t)=>_r(e,"table",t),QP=e=>{const t=e.startContainer,n=e.startOffset;return B(t)?n===0?m.some(C.fromDom(t)):m.none():m.from(t.childNodes[n]).map(C.fromDom)},JP=e=>{const t=e.endContainer,n=e.endOffset;return B(t)?n===t.data.length?m.some(C.fromDom(t)):m.none():m.from(t.childNodes[n-1]).map(C.fromDom)},xb=e=>wc(e).fold(z([e]),t=>[e].concat(xb(t))),Ou=e=>kc(e).fold(z([e]),t=>pe(t)==="br"?Ds(t).map(n=>[e].concat(Ou(n))).getOr([]):[e].concat(Ou(t))),Iu=(e,t)=>mt(QP(t),JP(t),(n,s)=>{const o=Ye(xb(e),K(ve,n)),r=Ye(Ou(e),K(ve,s));return o.isSome()&&r.isSome()}).getOr(!1),Lu=(e,t,n,s)=>{const o=n,r=new Xe(n,o),a=pr(e.schema.getMoveCaretBeforeOnEnterElements(),(l,c)=>!Ne(["td","th","table"],c.toLowerCase()));let i=n;do{if(B(i)&&$.trim(i.data).length!==0){s?t.setStart(i,0):t.setEnd(i,i.data.length);return}if(a[i.nodeName]){s?t.setStartBefore(i):i.nodeName==="BR"?t.setEndBefore(i):t.setEndAfter(i);return}}while(i=s?r.next():r.prev());o.nodeName==="BODY"&&(s?t.setStart(o,0):t.setEnd(o,o.childNodes.length))},Di=e=>{const t=e.selection.getSel();return M(t)&&t.rangeCount>0},$u=(e,t)=>{const n=zo(e);n.length>0?P(n,s=>{const o=s.dom,r=e.dom.createRng();r.setStartBefore(o),r.setEndAfter(o),t(r,!0)}):t(e.selection.getRng(),!1)},_b=(e,t,n)=>{const s=Ah(e,t);n(s),e.moveToBookmark(s)},oa=e=>dn(e==null?void 0:e.nodeType),Fu=e=>G(e)&&!qt(e)&&!jt(e)&&!Fs(e),eD=(e,t)=>{if(Fu(t)&&!/^(TD|TH)$/.test(t.nodeName)){const n=e.getAttrib(t,"data-mce-selected"),s=parseInt(n,10);return!isNaN(s)&&s>0}else return!1},Nb=(e,t,n)=>{const{selection:s,dom:o}=e,r=s.getNode(),a=Be(r);_b(s,!0,()=>{t()}),a&&Be(r)&&o.isChildOf(r,e.getBody())?e.selection.select(r):n(s.getStart())&&tD(o,s)},tD=(e,t)=>{var n,s;const o=t.getRng(),{startContainer:r,startOffset:a}=o,i=t.getNode();if(!eD(e,i)&&G(r)){const l=r.childNodes,c=e.getRoot();let u;if(a<l.length){const f=l[a];u=new Xe(f,(n=e.getParent(f,e.isBlock))!==null&&n!==void 0?n:c)}else{const f=l[l.length-1];u=new Xe(f,(s=e.getParent(f,e.isBlock))!==null&&s!==void 0?s:c),u.next(!0)}for(let f=u.current();f;f=u.next()){if(e.getContentEditable(f)==="false")return;if(B(f)&&!Uu(f)){o.setStart(f,0),t.setRng(o);return}}}},Ab=(e,t,n)=>{if(e){const s=t?"nextSibling":"previousSibling";for(e=n?e:e[s];e;e=e[s])if(G(e)||!Uu(e))return e}},Mu=(e,t)=>!!e.getTextBlockElements()[t.nodeName.toLowerCase()]||zs(e,t),Ho=(e,t,n)=>e.schema.isValidChild(t,n),Uu=(e,t=!1)=>{if(M(e)&&B(e)){const n=t?e.data.replace(/ /g," "):e.data;return us(n)}else return!1},nD=e=>M(e)&&B(e)&&e.length===0,sD=(e,t)=>{const n="[data-mce-cef-wrappable]",s=hR(e),o=Cr(s)?n:`${n},${s}`;return mn(C.fromDom(t),o)},Tb=(e,t)=>{const n=e.dom;return Fu(t)&&n.getContentEditable(t)==="false"&&sD(e,t)&&n.select('[contenteditable="true"]',t).length===0},bs=(e,t)=>ke(e)?e(t):(M(t)&&(e=e.replace(/%(\w+)/g,(n,s)=>t[s]||n)),e),zu=(e,t)=>(e=e||"",t=t||"",e=""+(e.nodeName||e),t=""+(t.nodeName||t),e.toLowerCase()===t.toLowerCase()),Hu=(e,t)=>{if(je(e))return null;{let n=String(e);return(t==="color"||t==="backgroundColor")&&(n=Lr(n)),t==="fontWeight"&&e===700&&(n="bold"),t==="fontFamily"&&(n=n.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),n}},Bi=(e,t,n)=>{const s=e.getStyle(t,n);return Hu(s,n)},Rb=(e,t)=>{let n;return e.getParent(t,s=>G(s)?(n=e.getStyle(s,"text-decoration"),!!n&&n!=="none"):!1),n},Oi=(e,t,n)=>e.getParents(t,n,e.getRoot()),Wu=(e,t,n)=>{const s=e.formatter.get(t);return M(s)&&Ue(s,n)},oD=(e,t)=>Wu(e,t,s=>{const o=r=>ke(r)||r.length>1&&r.charAt(0)==="%";return Ue(["styles","attributes"],r=>Pe(s,r).exists(a=>{const i=Ge(a)?a:mc(a);return Ue(i,o)}))}),rD=(e,t,n)=>{const s=["inline","block","selector","attributes","styles","classes"],o=r=>pr(r,(a,i)=>Ue(s,l=>l===i));return Wu(e,t,r=>{const a=o(r);return Wu(e,n,i=>{const l=o(i);return _x(a,l)})})},In=e=>vo(e,"block"),aD=e=>In(e)&&e.wrapper===!0,iD=e=>In(e)&&e.wrapper!==!0,Kt=e=>vo(e,"selector"),Qe=e=>vo(e,"inline"),lD=e=>Kt(e)&&Qe(e)&&So(Pe(e,"mixed"),!0),Vu=e=>Kt(e)&&e.expand!==!1&&!Qe(e),cD=e=>{const t=[];let n=e;for(;n;){if(B(n)&&n.data!==Ze||n.childNodes.length>1)return[];G(n)&&t.push(n),n=n.firstChild}return t},Pb=e=>cD(e).length>0,ju=e=>jt(e.dom)&&Pb(e.dom),Wo=qt,Db=Oi,Bb=Uu,uD=Mu,fD=e=>Me(e)&&e.getAttribute("data-mce-bogus")&&!e.nextSibling,Ob=(e,t)=>{let n=t;for(;n;){if(G(n)&&e.getContentEditable(n))return e.getContentEditable(n)==="false"?n:t;n=n.parentNode}return t},Ib=(e,t,n,s)=>{const o=t.data;if(e){for(let r=n;r>0;r--)if(s(o.charAt(r-1)))return r}else for(let r=n;r<o.length;r++)if(s(o.charAt(r)))return r;return-1},dD=(e,t,n)=>Ib(e,t,n,s=>Pi(s)||Uo(s)),mD=(e,t,n)=>Ib(e,t,n,Du),Lb=(e,t,n,s,o,r)=>{let a;const i=e.getParent(n,e.isBlock)||t,l=(u,f,d)=>{const p=qs(e),b=o?p.backwards:p.forwards;return m.from(b(u,f,(g,h)=>Wo(g.parentNode)?-1:(a=g,d(o,g,h)),i))};return l(n,s,dD).bind(u=>r?l(u.container,u.offset+(o?-1:0),mD):m.some(u)).orThunk(()=>a?m.some({container:a,offset:o?0:a.length}):m.none())},$b=(e,t,n,s,o)=>{const r=s[o];B(s)&&Cr(s.data)&&r&&(s=r);const a=Db(e,s);for(let i=0;i<a.length;i++)for(let l=0;l<t.length;l++){const c=t[l];if(!(M(c.collapsed)&&c.collapsed!==n.collapsed)&&Kt(c)&&e.is(a[i],c.selector))return a[i]}return s},Fb=(e,t,n,s)=>{var o;let r=n;const a=e.getRoot(),i=t[0];if(In(i)&&(r=i.wrapper?null:e.getParent(n,i.block,a)),!r){const l=(o=e.getParent(n,"LI,TD,TH,SUMMARY"))!==null&&o!==void 0?o:a;r=e.getParent(B(n)?n.parentNode:n,c=>c!==a&&uD(e.schema,c),l)}if(r&&In(i)&&i.wrapper&&(r=Db(e,r,"ul,ol").reverse()[0]||r),!r)for(r=n;r&&r[s]&&!e.isBlock(r[s])&&(r=r[s],!zu(r,"br")););return r||n},Mb=(e,t,n,s)=>{const o=n.parentNode;return M(n[s])?!1:o===t||je(o)||e.isBlock(o)?!0:Mb(e,t,o,s)},Ii=(e,t,n,s,o)=>{let r=n;const a=o?"previousSibling":"nextSibling",i=e.getRoot();if(B(n)&&!Bb(n)&&(o?s>0:s<n.data.length))return n;for(;r;){if(!t[0].block_expand&&e.isBlock(r))return r;for(let l=r[a];l;l=l[a]){const c=B(l)&&!Mb(e,i,l,a);if(!Wo(l)&&!fD(l)&&!Bb(l,c))return r}if(r===i||r.parentNode===i){n=r;break}r=r.parentNode}return n},Ub=e=>Wo(e.parentNode)||Wo(e),Qs=(e,t,n,s=!1)=>{let{startContainer:o,startOffset:r,endContainer:a,endOffset:i}=t;const l=n[0];return G(o)&&o.hasChildNodes()&&(o=gs(o,r),B(o)&&(r=0)),G(a)&&a.hasChildNodes()&&(a=gs(a,t.collapsed?i:i-1),B(a)&&(i=a.data.length)),o=Ob(e,o),a=Ob(e,a),Ub(o)&&(o=Wo(o)?o:o.parentNode,t.collapsed?o=o.previousSibling||o:o=o.nextSibling||o,B(o)&&(r=t.collapsed?o.length:0)),Ub(a)&&(a=Wo(a)?a:a.parentNode,t.collapsed?a=a.nextSibling||a:a=a.previousSibling||a,B(a)&&(i=t.collapsed?0:a.length)),t.collapsed&&(Lb(e,e.getRoot(),o,r,!0,s).each(({container:f,offset:d})=>{o=f,r=d}),Lb(e,e.getRoot(),a,i,!1,s).each(({container:f,offset:d})=>{a=f,i=d})),(Qe(l)||l.block_expand)&&((!Qe(l)||!B(o)||r===0)&&(o=Ii(e,n,o,r,!0)),(!Qe(l)||!B(a)||i===a.data.length)&&(a=Ii(e,n,a,i,!1))),Vu(l)&&(o=$b(e,n,t,o,"previousSibling"),a=$b(e,n,t,a,"nextSibling")),(In(l)||Kt(l))&&(o=Fb(e,n,o,"previousSibling"),a=Fb(e,n,a,"nextSibling"),In(l)&&(e.isBlock(o)||(o=Ii(e,n,o,r,!0)),e.isBlock(a)||(a=Ii(e,n,a,i,!1)))),G(o)&&o.parentNode&&(r=e.nodeIndex(o),o=o.parentNode),G(a)&&a.parentNode&&(i=e.nodeIndex(a)+1,a=a.parentNode),{startContainer:o,startOffset:r,endContainer:a,endOffset:i}},ra=(e,t,n)=>{var s;const o=t.startOffset,r=gs(t.startContainer,o),a=t.endOffset,i=gs(t.endContainer,a-1),l=h=>{const y=h[0];B(y)&&y===r&&o>=y.data.length&&h.splice(0,1);const E=h[h.length-1];return a===0&&h.length>0&&E===i&&B(E)&&h.splice(h.length-1,1),h},c=(h,y,E)=>{const v=[];for(;h&&h!==E;h=h[y])v.push(h);return v},u=(h,y)=>e.getParent(h,E=>E.parentNode===y,y),f=(h,y,E)=>{const v=E?"nextSibling":"previousSibling";for(let S=h,R=S.parentNode;S&&S!==y;S=R){R=S.parentNode;const O=c(S===h?S:S[v],v);O.length&&(E||O.reverse(),n(l(O)))}};if(r===i)return n(l([r]));const d=(s=e.findCommonAncestor(r,i))!==null&&s!==void 0?s:e.getRoot();if(e.isChildOf(r,i))return f(r,d,!0);if(e.isChildOf(i,r))return f(i,d);const p=u(r,d)||r,b=u(i,d)||i;f(r,p,!0);const g=c(p===r?p:p.nextSibling,"nextSibling",b===i?b.nextSibling:b);g.length&&n(l(g)),f(i,b)},gD=['pre[class*=language-][contenteditable="false"]',"figure.image","div[data-ephox-embed-iri]","div.tiny-pageembed","div.mce-toc","div[data-mce-toc]"],pD=e=>Ht(e)&&ii(e)===Ze,hD=(e,t,n,s)=>tn(t).fold(()=>"skipping",o=>s==="br"||pD(t)?"valid":KA(t)?"existing":jt(t.dom)?"caret":Ue(gD,r=>mn(t,r))?"valid-block":!Ho(e,n,s)||!Ho(e,pe(o),n)?"invalid-child":"valid"),bD=(e,t)=>{const n=Qs(e.dom,t,[{inline:"span"}]);t.setStart(n.startContainer,n.startOffset),t.setEnd(n.endContainer,n.endOffset),e.selection.setRng(t)},zb=(e,t,n,s,o,r)=>{const{uid:a=t,...i}=n;ko(e,Ur()),st(e,`${Bo()}`,a),st(e,`${Vs()}`,s);const{attributes:l={},classes:c=[]}=o(a,i);if(Wn(e,l),ZA(e,c),r){c.length>0&&st(e,`${Hr()}`,c.join(","));const u=Pt(l);u.length>0&&st(e,`${Wr()}`,u.join(","))}},CD=e=>{Sr(e,Ur()),ot(e,`${Bo()}`),ot(e,`${Vs()}`),ot(e,`${zr()}`);const t=Vn(e,`${Wr()}`).map(s=>s.split(",")).getOr([]),n=Vn(e,`${Hr()}`).map(s=>s.split(",")).getOr([]);P(t,s=>ot(e,s)),QA(e,n),ot(e,`${Hr()}`),ot(e,`${Wr()}`)},Hb=(e,t,n,s,o)=>{const r=C.fromTag("span",e);return zb(r,t,n,s,o,!1),r},yD=(e,t,n,s,o,r)=>{const a=[],i=Hb(e.getDoc(),n,r,s,o),l=ms(),c=()=>{l.clear()},u=()=>l.get().getOrThunk(()=>{const b=js(i);return a.push(b),l.set(b),b}),f=b=>{P(b,d)},d=b=>{switch(hD(e,b,"span",pe(b))){case"invalid-child":{c();const h=rt(b);f(h),c();break}case"valid-block":{c(),zb(b,n,r,s,o,!0);break}case"valid":{const h=u();op(b,h);break}}},p=b=>{const g=he(b,C.fromDom);f(g)};return ra(e.dom,t,b=>{c(),p(b)}),a},vD=(e,t,n,s)=>{e.undoManager.transact(()=>{const o=e.selection,r=o.getRng(),a=zo(e).length>0,i=Vr("mce-annotation");if(r.collapsed&&!a&&bD(e,r),o.getRng().collapsed&&!a){const l=Hb(e.getDoc(),i,s,t,n.decorate);ni(l,Je),o.getRng().insertNode(l.dom),o.select(l.dom)}else _b(o,!1,()=>{$u(e,l=>{yD(e,l,i,t,n.decorate,s)})})})},Wb=e=>{const t=XA();YA(e,t);const n=GA(e,t),s=Qa("span"),o=r=>{P(r,a=>{s(a)?Yn(a):CD(a)})};return{register:(r,a)=>{t.register(r,a)},annotate:(r,a)=>{t.lookup(r).each(i=>{vD(e,r,i,a)})},annotationChanged:(r,a)=>{n.addListener(r,a)},remove:r=>{Qp(e,m.some(r)).each(({elements:a})=>{const i=e.selection.getBookmark();o(a),e.selection.moveToBookmark(i)})},removeAll:r=>{const a=e.selection.getBookmark();Te(th(e,r),(i,l)=>{o(i)}),e.selection.moveToBookmark(a)},getAll:r=>{const a=th(e,r);return ja(a,i=>he(i,l=>l.dom))}}},aa=e=>({getBookmark:K(qP,e),moveToBookmark:K(KP,e)});aa.isBookmarkNode=qt;const Vb=(e,t,n)=>n.collapsed?!1:Ue(n.getClientRects(),s=>nT(s,e,t)),ED=(e,t)=>e.dispatch("PreProcess",t),SD=(e,t)=>e.dispatch("PostProcess",t),wD=e=>{e.dispatch("remove")},kD=e=>{e.dispatch("detach")},xD=(e,t)=>{e.dispatch("SwitchMode",{mode:t})},_D=(e,t,n,s,o)=>{e.dispatch("ObjectResizeStart",{target:t,width:n,height:s,origin:o})},ND=(e,t,n,s,o)=>{e.dispatch("ObjectResized",{target:t,width:n,height:s,origin:o})},AD=e=>{e.dispatch("PreInit")},TD=e=>{e.dispatch("PostRender")},RD=e=>{e.dispatch("Init")},PD=(e,t)=>{e.dispatch("PlaceholderToggle",{state:t})},jb=(e,t,n)=>{e.dispatch(t,n)},qb=(e,t,n,s)=>{e.dispatch("FormatApply",{format:t,node:n,vars:s})},Kb=(e,t,n,s)=>{e.dispatch("FormatRemove",{format:t,node:n,vars:s})},DD=(e,t)=>e.dispatch("BeforeSetContent",t),Gb=(e,t)=>e.dispatch("SetContent",t),BD=(e,t)=>e.dispatch("BeforeGetContent",t),Yb=(e,t)=>e.dispatch("GetContent",t),OD=(e,t)=>{e.dispatch("AutocompleterStart",t)},ID=(e,t)=>{e.dispatch("AutocompleterUpdate",t)},LD=e=>{e.dispatch("AutocompleterEnd")},$D=(e,t,n)=>e.dispatch("PastePreProcess",{content:t,internal:n}),FD=(e,t,n)=>e.dispatch("PastePostProcess",{node:t,internal:n}),Xb=(e,t)=>e.dispatch("PastePlainTextToggle",{state:t}),MD=(e,t)=>e.dispatch("EditableRootStateChange",{state:t}),H={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:e=>e.shiftKey||e.ctrlKey||e.altKey||H.metaKeyPressed(e),metaKeyPressed:e=>be.os.isMacOS()||be.os.isiOS()?e.metaKey:e.ctrlKey&&!e.altKey},Js="data-mce-selected",UD="table,img,figure.image,hr,video,span.mce-preview-object,details",Zb=Math.abs,Li=Math.round,qu={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},zD=e=>e.type==="longpress"||e.type.indexOf("touch")===0,Qb=(e,t)=>{const n=t.dom,s=t.getDoc(),o=document,r=t.getBody();let a,i,l,c,u,f,d,p,b,g,h,y,E,v,S,R,O;const U=I=>M(I)&&(pp(I)||n.is(I,"figure.image")),A=I=>Rn(I)||n.hasClass(I,"mce-preview-object"),x=(I,te)=>{if(zD(I)){const de=I.touches[0];return U(I.target)&&!Vb(de.clientX,de.clientY,te)}else return U(I.target)&&!Vb(I.clientX,I.clientY,te)},T=I=>{const te=I.target;x(I,t.selection.getRng())&&!I.isDefaultPrevented()&&t.selection.select(te)},V=I=>n.hasClass(I,"mce-preview-object")&&M(I.firstElementChild)?[I,I.firstElementChild]:n.is(I,"figure.image")?[I.querySelector("img")]:[I],Z=I=>{const te=Vh(t);return!te||I.getAttribute("data-mce-resize")==="false"||I===t.getBody()?!1:n.hasClass(I,"mce-preview-object")&&M(I.firstElementChild)?mn(C.fromDom(I.firstElementChild),te):mn(C.fromDom(I),te)},ae=I=>A(I)?n.create("img",{src:be.transparentSrc}):I.cloneNode(!0),ie=(I,te,de)=>{if(M(de)){const we=V(I);P(we,Se=>{Se.style[te]||!t.schema.isValid(Se.nodeName.toLowerCase(),te)?n.setStyle(Se,te,de):n.setAttrib(Se,te,""+de)})}},Ce=(I,te,de)=>{ie(I,"width",te),ie(I,"height",de)},xe=I=>{let te,de,we,Se,qe;te=I.screenX-f,de=I.screenY-d,v=te*c[2]+g,S=de*c[3]+h,v=v<5?5:v,S=S<5?5:S,(U(a)||A(a))&&lR(t)!==!1?we=!H.modifierPressed(I):we=H.modifierPressed(I),we&&(Zb(te)>Zb(de)?(S=Li(v*y),v=Li(S/y)):(v=Li(S/y),S=Li(v*y))),Ce(i,v,S),Se=c.startPos.x+te,qe=c.startPos.y+de,Se=Se>0?Se:0,qe=qe>0?qe:0,n.setStyles(l,{left:Se,top:qe,display:"block"}),l.innerHTML=v+" &times; "+S,c[2]<0&&i.clientWidth<=v&&n.setStyle(i,"left",p+(g-v)),c[3]<0&&i.clientHeight<=S&&n.setStyle(i,"top",b+(h-S)),te=r.scrollWidth-R,de=r.scrollHeight-O,te+de!==0&&n.setStyles(l,{left:Se-te,top:qe-de}),E||(_D(t,a,g,h,"corner-"+c.name),E=!0)},Ie=()=>{const I=E;E=!1,I&&(ie(a,"width",v),ie(a,"height",S)),n.unbind(s,"mousemove",xe),n.unbind(s,"mouseup",Ie),o!==s&&(n.unbind(o,"mousemove",xe),n.unbind(o,"mouseup",Ie)),n.remove(i),n.remove(l),n.remove(u),nt(a),I&&(ND(t,a,v,S,"corner-"+c.name),n.setAttrib(a,"style",n.getAttrib(a,"style"))),t.nodeChanged()},nt=I=>{ue();const te=n.getPos(I,r),de=te.x,we=te.y,Se=I.getBoundingClientRect(),qe=Se.width||Se.right-Se.left,ln=Se.height||Se.bottom-Se.top;a!==I&&(F(),a=I,v=S=0);const Un=t.dispatch("ObjectSelected",{target:I});Z(I)&&!Un.isDefaultPrevented()?Te(qu,(St,Jt)=>{const se=_e=>{const Le=V(a)[0];f=_e.screenX,d=_e.screenY,g=Le.clientWidth,h=Le.clientHeight,y=h/g,c=St,c.name=Jt,c.startPos={x:qe*St[0]+de,y:ln*St[1]+we},R=r.scrollWidth,O=r.scrollHeight,u=n.add(r,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"}),n.setStyles(u,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),i=ae(a),n.addClass(i,"mce-clonedresizable"),n.setAttrib(i,"data-mce-bogus","all"),i.contentEditable="false",n.setStyles(i,{left:de,top:we,margin:0}),Ce(i,qe,ln),i.removeAttribute(Js),r.appendChild(i),n.bind(s,"mousemove",xe),n.bind(s,"mouseup",Ie),o!==s&&(n.bind(o,"mousemove",xe),n.bind(o,"mouseup",Ie)),l=n.add(r,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},g+" &times; "+h)};let ge=n.get("mceResizeHandle"+Jt);ge&&n.remove(ge),ge=n.add(r,"div",{id:"mceResizeHandle"+Jt,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+Jt+"-resize; margin:0; padding:0"}),n.bind(ge,"mousedown",_e=>{_e.stopImmediatePropagation(),_e.preventDefault(),se(_e)}),St.elm=ge,n.setStyles(ge,{left:qe*St[0]+de-ge.offsetWidth/2,top:ln*St[1]+we-ge.offsetHeight/2})}):F(!1)},ye=yi(nt,0),F=(I=!0)=>{ye.cancel(),ue(),a&&I&&a.removeAttribute(Js),Te(qu,(te,de)=>{const we=n.get("mceResizeHandle"+de);we&&(n.unbind(we),n.remove(we))})},Y=(I,te)=>n.isChildOf(I,te),me=I=>{if(E||t.removed||t.composing)return;const te=I.type==="mousedown"?I.target:e.getNode(),de=Os(C.fromDom(te),UD).map(Se=>Se.dom).filter(Se=>n.isEditable(Se.parentElement)||Se.nodeName==="IMG"&&n.isEditable(Se)).getOrUndefined(),we=M(de)?n.getAttrib(de,Js,"1"):"1";if(P(n.select(`img[${Js}],hr[${Js}]`),Se=>{Se.removeAttribute(Js)}),M(de)&&Y(de,r)&&t.hasFocus()){j();const Se=e.getStart(!0);if(Y(Se,de)&&Y(e.getEnd(!0),de)){n.setAttrib(de,Js,we),ye.throttle(de);return}}F()},ue=()=>{Te(qu,I=>{I.elm&&(n.unbind(I.elm),delete I.elm)})},j=()=>{try{t.getDoc().execCommand("enableObjectResizing",!1,"false")}catch{}};return t.on("init",()=>{j(),t.on("NodeChange ResizeEditor ResizeWindow ResizeContent drop",me),t.on("keyup compositionend",I=>{a&&a.nodeName==="TABLE"&&me(I)}),t.on("hide blur",F),t.on("contextmenu longpress",T,!0)}),t.on("remove",ue),{isResizable:Z,showResizeRect:nt,hideResizeRect:F,updateResizeRect:me,destroy:()=>{ye.cancel(),a=i=u=null}}},HD=(e,t)=>{t.fold(n=>{e.setStartBefore(n.dom)},(n,s)=>{e.setStart(n.dom,s)},n=>{e.setStartAfter(n.dom)})},WD=(e,t)=>{t.fold(n=>{e.setEndBefore(n.dom)},(n,s)=>{e.setEnd(n.dom,s)},n=>{e.setEndAfter(n.dom)})},Jb=(e,t,n)=>{const s=e.document.createRange();return HD(s,t),WD(s,n),s},Ku=(e,t,n,s,o)=>{const r=e.document.createRange();return r.setStart(t.dom,n),r.setEnd(s.dom,o),r},ia=Pn.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),eC=(e,t,n)=>t(C.fromDom(n.startContainer),n.startOffset,C.fromDom(n.endContainer),n.endOffset),VD=(e,t)=>t.match({domRange:n=>({ltr:z(n),rtl:m.none}),relative:(n,s)=>({ltr:Rs(()=>Jb(e,n,s)),rtl:Rs(()=>m.some(Jb(e,s,n)))}),exact:(n,s,o,r)=>({ltr:Rs(()=>Ku(e,n,s,o,r)),rtl:Rs(()=>m.some(Ku(e,o,r,n,s)))})}),jD=(e,t)=>{const n=t.ltr();return n.collapsed?t.rtl().filter(o=>o.collapsed===!1).map(o=>ia.rtl(C.fromDom(o.endContainer),o.endOffset,C.fromDom(o.startContainer),o.startOffset)).getOrThunk(()=>eC(e,ia.ltr,n)):eC(e,ia.ltr,n)},qD=(e,t)=>{const n=VD(e,t);return jD(e,n)};ia.ltr,ia.rtl;const tC={create:(e,t,n,s)=>({start:e,soffset:t,finish:n,foffset:s})},KD=(e,t,n)=>{var s,o;return m.from((o=(s=e.dom).caretPositionFromPoint)===null||o===void 0?void 0:o.call(s,t,n)).bind(r=>{if(r.offsetNode===null)return m.none();const a=e.dom.createRange();return a.setStart(r.offsetNode,r.offset),a.collapse(),m.some(a)})},GD=(e,t,n)=>{var s,o;return m.from((o=(s=e.dom).caretRangeFromPoint)===null||o===void 0?void 0:o.call(s,t,n))},YD=(()=>document.caretPositionFromPoint?KD:document.caretRangeFromPoint?GD:m.none)(),XD=(e,t,n)=>{const s=C.fromDom(e.document);return YD(s,t,n).map(o=>tC.create(C.fromDom(o.startContainer),o.startOffset,C.fromDom(o.endContainer),o.endOffset))},Gu=Pn.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),ZD=(e,t,n,s)=>e.fold(t,n,s),QD=e=>e.fold(kt,kt,kt),JD=Gu.before,e1=Gu.on,t1=Gu.after,Jn={before:JD,on:e1,after:t1,cata:ZD,getStart:QD},$i=Pn.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),n1=e=>$i.exact(e.start,e.soffset,e.finish,e.foffset),s1=e=>e.match({domRange:t=>C.fromDom(t.startContainer),relative:(t,n)=>Jn.getStart(t),exact:(t,n,s,o)=>t}),o1=$i.domRange,r1=$i.relative,a1=$i.exact,i1=e=>{const t=s1(e);return kr(t)},l1=tC.create,Vo={domRange:o1,relative:r1,exact:a1,exactFromRange:n1,getWin:i1,range:l1},Fi=(e,t)=>{const n=pe(e);return n==="input"?Jn.after(e):Ne(["br","img"],n)?t===0?Jn.before(e):Jn.after(e):Jn.on(e,t)},c1=(e,t)=>{const n=e.fold(Jn.before,Fi,Jn.after),s=t.fold(Jn.before,Fi,Jn.after);return Vo.relative(n,s)},nC=(e,t,n,s)=>{const o=Fi(e,t),r=Fi(n,s);return Vo.relative(o,r)},u1=e=>e.match({domRange:t=>{const n=C.fromDom(t.startContainer),s=C.fromDom(t.endContainer);return nC(n,t.startOffset,s,t.endOffset)},relative:c1,exact:nC}),Yu=(e,t)=>{const s=(t||document).createDocumentFragment();return P(e,o=>{s.appendChild(o.dom)}),C.fromDom(s)},f1=e=>{const t=Vo.getWin(e).dom,n=(o,r,a,i)=>Ku(t,o,r,a,i),s=u1(e);return qD(t,s).match({ltr:n,rtl:n})},d1=(e,t,n)=>XD(e,t,n),sC=(e,t,n)=>{const s=kr(C.fromDom(n));return d1(s.dom,e,t).map(o=>{const r=n.createRange();return r.setStart(o.start.dom,o.soffset),r.setEnd(o.finish.dom,o.foffset),r}).getOrUndefined()},Xu=(e,t)=>M(e)&&M(t)&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset,m1=(e,t,n)=>{let s=e;for(;s&&s!==t;){if(n(s))return s;s=s.parentNode}return null},oC=(e,t,n)=>m1(e,t,n)!==null,g1=(e,t,n)=>oC(e,t,s=>s.nodeName===n),p1=(e,t)=>Wt(e)&&!oC(e,t,jt),rC=(e,t,n)=>{const s=t.parentNode;if(s){const o=new Xe(t,e.getParent(s,e.isBlock)||e.getRoot());let r;for(;r=o[n?"prev":"next"]();)if(Me(r))return!0}return!1},h1=(e,t)=>{var n;return((n=e.previousSibling)===null||n===void 0?void 0:n.nodeName)===t},b1=(e,t)=>{let n=t;for(;n&&n!==e;){if(Be(n))return!0;n=n.parentNode}return!1},Zu=(e,t,n,s,o)=>{const r=e.getRoot(),a=e.schema.getNonEmptyElements(),i=o.parentNode;let l,c;if(!i)return m.none();const u=e.getParent(i,e.isBlock)||r;if(s&&Me(o)&&t&&e.isEmpty(u))return m.some(N(i,e.nodeIndex(o)));const f=new Xe(o,u);for(;c=f[s?"prev":"next"]();){if(e.getContentEditableParent(c)==="false"||p1(c,r))return m.none();if(B(c)&&c.data.length>0)return g1(c,r,"A")?m.none():m.some(N(c,s?c.data.length:0));if(e.isBlock(c)||a[c.nodeName.toLowerCase()])return m.none();l=c}return is(l)?m.none():n&&l?m.some(N(l,0)):m.none()},aC=(e,t,n,s)=>{const o=e.getRoot();let r,a=!1,i=n?s.startContainer:s.endContainer,l=n?s.startOffset:s.endOffset;const c=G(i)&&l===i.childNodes.length,u=e.schema.getNonEmptyElements();let f=n;if(Wt(i))return m.none();if(G(i)&&l>i.childNodes.length-1&&(f=!1),Rr(i)&&(i=o,l=0),i===o){if(f&&(r=i.childNodes[l>0?l-1:0],r&&(Wt(r)||u[r.nodeName]||Zn(r))))return m.none();if(i.hasChildNodes()){if(l=Math.min(!f&&l>0?l-1:l,i.childNodes.length-1),i=i.childNodes[l],l=B(i)&&c?i.data.length:0,!t&&i===o.lastChild&&Zn(i)||b1(o,i)||Wt(i)||Ic(i))return m.none();if(i.hasChildNodes()&&!Zn(i)){r=i;const d=new Xe(i,o);do{if(Be(r)||Wt(r)){a=!1;break}if(B(r)&&r.data.length>0){l=f?0:r.data.length,i=r,a=!0;break}if(u[r.nodeName.toLowerCase()]&&!eN(r)){l=e.nodeIndex(r),i=r.parentNode,f||l++,a=!0;break}}while(r=f?d.next():d.prev())}}}return t&&(B(i)&&l===0&&Zu(e,c,t,!0,i).each(d=>{i=d.container(),l=d.offset(),a=!0}),G(i)&&(r=i.childNodes[l],r||(r=i.childNodes[l-1]),r&&Me(r)&&!h1(r,"A")&&!rC(e,r,!1)&&!rC(e,r,!0)&&Zu(e,c,t,!0,r).each(d=>{i=d.container(),l=d.offset(),a=!0}))),f&&!t&&B(i)&&l===i.data.length&&Zu(e,c,t,!1,i).each(d=>{i=d.container(),l=d.offset(),a=!0}),a&&i?m.some(N(i,l)):m.none()},Mi=(e,t)=>{const n=t.collapsed,s=t.cloneRange(),o=N.fromRangeStart(t);return aC(e,n,!0,s).each(r=>{(!n||!N.isAbove(o,r))&&s.setStart(r.container(),r.offset())}),n||aC(e,n,!1,s).each(r=>{s.setEnd(r.container(),r.offset())}),n&&s.collapse(!0),Xu(t,s)?m.none():m.some(s)},Ui=(e,t)=>e.splitText(t),zi=e=>{let t=e.startContainer,n=e.startOffset,s=e.endContainer,o=e.endOffset;if(t===s&&B(t)){if(n>0&&n<t.data.length)if(s=Ui(t,n),t=s.previousSibling,o>n){o=o-n;const r=Ui(s,o).previousSibling;t=s=r,o=r.data.length,n=0}else o=0}else if(B(t)&&n>0&&n<t.data.length&&(t=Ui(t,n),n=0),B(s)&&o>0&&o<s.data.length){const r=Ui(s,o).previousSibling;s=r,o=r.data.length}return{startContainer:t,startOffset:n,endContainer:s,endOffset:o}},eo=e=>({walk:(r,a)=>ra(e,r,a),split:zi,expand:(r,a={type:"word"})=>{if(a.type==="word"){const i=Qs(e,r,[{inline:"span"}]),l=e.createRng();return l.setStart(i.startContainer,i.startOffset),l.setEnd(i.endContainer,i.endOffset),l}return r},normalize:r=>Mi(e,r).fold($e,a=>(r.setStart(a.startContainer,a.startOffset),r.setEnd(a.endContainer,a.endOffset),!0))});eo.compareRanges=Xu,eo.getCaretRangeFromPoint=sC,eo.getSelectedNode=vi,eo.getNode=gs;const C1=((e,t)=>{const n=(i,l)=>{if(!dn(l)&&!l.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+l);const c=i.dom;Ar(c)&&(c.style[e]=l+"px")},s=i=>{const l=t(i);if(l<=0||l===null){const c=Tn(i,e);return parseFloat(c)||0}return l},o=s,r=(i,l)=>Tt(l,(c,u)=>{const f=Tn(i,u),d=f===void 0?0:parseInt(f,10);return isNaN(d)?c:c+d},0);return{set:n,get:s,getOuter:o,aggregate:r,max:(i,l,c)=>{const u=r(i,c);return l>u?l-u:0}}})("height",e=>{const t=e.dom;return _o(e)?t.getBoundingClientRect().height:t.offsetHeight}),y1=e=>C1.get(e),iC=()=>C.fromDom(document),lC=(e,t)=>e.view(t).fold(z([]),s=>{const o=e.owner(s),r=lC(e,o);return[s].concat(r)}),v1=(e,t)=>{const n=t.owner(e);return lC(t,n)};var E1=Object.freeze({__proto__:null,view:e=>{var t;return(e.dom===document?m.none():m.from((t=e.dom.defaultView)===null||t===void 0?void 0:t.frameElement)).map(C.fromDom)},owner:e=>qn(e)});const S1=e=>{const t=iC(),n=Dc(t),s=v1(e,E1),o=Pc(e),r=dr(s,(a,i)=>{const l=Pc(i);return{left:a.left+l.left,top:a.top+l.top}},{left:0,top:0});return Ao(r.left+o.left+n.left,r.top+o.top+n.top)},Qu=e=>pe(e)==="textarea",w1=(e,t)=>e.dispatch("ScrollIntoView",t).isDefaultPrevented(),k1=(e,t)=>{e.dispatch("AfterScrollIntoView",t)},x1=(e,t)=>{const n=rt(e);if(n.length===0||Qu(e))return{element:e,offset:t};if(t<n.length&&!Qu(n[t]))return{element:n[t],offset:0};{const s=n[n.length-1];return Qu(s)?{element:e,offset:t}:pe(s)==="img"?{element:s,offset:1}:Ht(s)?{element:s,offset:ii(s).length}:{element:s,offset:rt(s).length}}},cC=(e,t)=>{const n=q_(e),s=y1(e);return{element:e,bottom:n.top+s,height:s,pos:n,cleanup:t}},_1=(e,t)=>{const n=x1(e,t),s=C.fromHtml('<span data-mce-bogus="all" style="display: inline-block;">'+Ze+"</span>");return Dt(n.element,s),cC(s,()=>De(s))},N1=e=>cC(C.fromDom(e),ce),uC=(e,t,n,s)=>{T1(e,(o,r)=>A1(e,t,n,s),n)},fC=(e,t,n,s,o)=>{const r={elm:s.element.dom,alignToTop:o};if(w1(e,r))return;const a=Dc(t).top;n(e,t,a,s,o),k1(e,r)},A1=(e,t,n,s)=>{const o=C.fromDom(e.getBody()),r=C.fromDom(e.getDoc());I_(o);const a=_1(C.fromDom(n.startContainer),n.startOffset);fC(e,r,t,a,s),a.cleanup()},dC=(e,t,n,s)=>{const o=C.fromDom(e.getDoc());fC(e,o,n,N1(t),s)},T1=(e,t,n)=>{const s=n.startContainer,o=n.startOffset,r=n.endContainer,a=n.endOffset;t(C.fromDom(s),C.fromDom(r));const i=e.dom.createRng();i.setStart(s,o),i.setEnd(r,a),e.selection.setRng(n)},Ju=(e,t,n,s,o)=>{const r=t.pos;if(s)ip(r.left,r.top,o);else{const a=r.top-n+t.height;ip(-e.getBody().getBoundingClientRect().left,a,o)}},mC=(e,t,n,s,o,r)=>{const a=s+n,i=o.pos.top,l=o.bottom,c=l-i>=s;i<n?Ju(e,o,s,r!==!1,t):i>a?Ju(e,o,s,c?r!==!1:r===!0,t):l>a&&!c&&Ju(e,o,s,r===!0,t)},gC=(e,t,n,s,o)=>{const r=kr(t).dom.innerHeight;mC(e,t,n,r,s,o)},pC=(e,t,n,s,o)=>{const r=kr(t).dom.innerHeight;mC(e,t,n,r,s,o);const a=S1(s.element),i=up(window);a.top<i.y?lp(s.element,o!==!1):a.top>i.bottom&&lp(s.element,o===!0)},R1=(e,t,n)=>uC(e,gC,t,n),P1=(e,t,n)=>dC(e,t,gC,n),D1=(e,t,n)=>uC(e,pC,t,n),B1=(e,t,n)=>dC(e,t,pC,n),O1=(e,t,n)=>{(e.inline?P1:B1)(e,t,n)},la=(e,t,n)=>{(e.inline?R1:D1)(e,t,n)},hC=(e,t=!1)=>e.dom.focus({preventScroll:t}),bC=e=>{const t=as(e).dom;return e.dom===t.activeElement},ef=(e=iC())=>m.from(e.dom.activeElement).map(C.fromDom),I1=e=>ef(as(e)).filter(t=>e.dom.contains(t.dom)),CC=(e,t)=>{const n=Ht(t)?ii(t).length:rt(t).length+1;return e>n?n:e<0?0:e},L1=e=>Vo.range(e.start,CC(e.soffset,e.start),e.finish,CC(e.foffset,e.finish)),yC=(e,t)=>!oi(t.dom)&&(jn(e,t)||ve(e,t)),vC=e=>t=>yC(e,t.start)&&yC(e,t.finish),$1=e=>e.inline||be.browser.isFirefox(),F1=e=>Vo.range(C.fromDom(e.startContainer),e.startOffset,C.fromDom(e.endContainer),e.endOffset),M1=e=>{const t=e.getSelection();return(!t||t.rangeCount===0?m.none():m.from(t.getRangeAt(0))).map(F1)},U1=e=>{const t=kr(e);return M1(t.dom).filter(vC(e))},z1=(e,t)=>m.from(t).filter(vC(e)).map(L1),H1=e=>{const t=document.createRange();try{return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),m.some(t)}catch{return m.none()}},tf=e=>{const t=$1(e)?U1(C.fromDom(e.getBody())):m.none();e.bookmark=t.isSome()?t:e.bookmark},nf=e=>(e.bookmark?e.bookmark:m.none()).bind(n=>z1(C.fromDom(e.getBody()),n)).bind(H1),W1=e=>{nf(e).each(t=>e.selection.setRng(t))},EC={isEditorUIElement:e=>{const t=e.className.toString();return t.indexOf("tox-")!==-1||t.indexOf("mce-")!==-1}},V1=(e,t)=>(dn(t)||(t=0),setTimeout(e,t)),j1=(e,t)=>(dn(t)||(t=0),setInterval(e,t)),Gt={setEditorTimeout:(e,t,n)=>V1(()=>{e.removed||t()},n),setEditorInterval:(e,t,n)=>{const s=j1(()=>{e.removed?clearInterval(s):t()},n);return s}},q1=e=>e.type==="nodechange"&&e.selectionChange,K1=(e,t)=>{const n=()=>{t.throttle()};Ae.DOM.bind(document,"mouseup",n),e.on("remove",()=>{Ae.DOM.unbind(document,"mouseup",n)})},G1=(e,t)=>{e.on("mouseup touchend",n=>{t.throttle()})},Y1=(e,t)=>{G1(e,t),e.on("keyup NodeChange AfterSetSelectionRange",n=>{q1(n)||tf(e)})},X1=e=>{const t=yi(()=>{tf(e)},0);e.on("init",()=>{e.inline&&K1(e,t),Y1(e,t)}),e.on("remove",()=>{t.cancel()})};let jo;const sf=Ae.DOM,Z1=e=>G(e)&&EC.isEditorUIElement(e),of=e=>{const t=e.classList;return t!==void 0?t.contains("tox-edit-area")||t.contains("tox-edit-area__iframe")||t.contains("mce-content-body"):!1},Hi=(e,t)=>{const n=bR(e);return sf.getParent(t,o=>Z1(o)||(n?e.dom.is(o,n):!1))!==null},rf=e=>{try{const t=as(C.fromDom(e.getElement()));return ef(t).fold(()=>document.body,n=>n.dom)}catch{return document.body}},Q1=(e,t)=>{const n=t.editor;X1(n);const s=(o,r)=>{if(QR(o)&&o.inline!==!0){const a=C.fromDom(o.getContainer());r(a,"tox-edit-focus")}};n.on("focusin",()=>{const o=e.focusedEditor;of(rf(n))&&s(n,ko),o!==n&&(o&&o.dispatch("blur",{focusedEditor:n}),e.setActive(n),e.focusedEditor=n,n.dispatch("focus",{blurredEditor:o}),n.focus(!0))}),n.on("focusout",()=>{Gt.setEditorTimeout(n,()=>{const o=e.focusedEditor;(!of(rf(n))||o!==n)&&s(n,Sr),!Hi(n,rf(n))&&o===n&&(n.dispatch("blur",{focusedEditor:null}),e.focusedEditor=null)})}),jo||(jo=o=>{const r=e.activeEditor;r&&Zg(o).each(a=>{const i=a;i.ownerDocument===document&&i!==document.body&&!Hi(r,i)&&e.focusedEditor===r&&(r.dispatch("blur",{focusedEditor:null}),e.focusedEditor=null)})},sf.bind(document,"focusin",jo))},J1=(e,t)=>{e.focusedEditor===t.editor&&(e.focusedEditor=null),!e.activeEditor&&jo&&(sf.unbind(document,"focusin",jo),jo=null)},eB=e=>{e.on("AddEditor",K(Q1,e)),e.on("RemoveEditor",K(J1,e))},tB=(e,t)=>e.dom.getParent(t,n=>e.dom.getContentEditable(n)==="true"),nB=e=>e.collapsed?m.from(gs(e.startContainer,e.startOffset)).map(C.fromDom):m.none(),sB=(e,t)=>nB(t).bind(n=>dN(n)?m.some(n):jn(e,n)?m.none():m.some(e)),SC=(e,t)=>{sB(C.fromDom(e.getBody()),t).bind(n=>ht(n.dom)).fold(()=>{e.selection.normalize()},n=>e.selection.setRng(n.toRange()))},af=e=>{if(e.setActive)try{e.setActive()}catch{e.focus()}else e.focus()},oB=e=>bC(e)||I1(e).isSome(),rB=e=>M(e.iframeElement)&&bC(C.fromDom(e.iframeElement)),aB=e=>{const t=e.getBody();return t&&oB(C.fromDom(t))},iB=e=>{const t=as(C.fromDom(e.getElement()));return ef(t).filter(n=>!of(n.dom)&&Hi(e,n.dom)).isSome()},to=e=>e.inline?aB(e):rB(e),wC=e=>to(e)||iB(e),lB=e=>{const t=e.selection,n=e.getBody();let s=t.getRng();e.quirks.refreshContentEditable(),M(e.bookmark)&&!to(e)&&nf(e).each(r=>{e.selection.setRng(r),s=r});const o=tB(e,t.getNode());if(o&&e.dom.isChildOf(o,n)){af(o),SC(e,s),lf(e);return}e.inline||(be.browser.isOpera()||af(n),e.getWin().focus()),(be.browser.isFirefox()||e.inline)&&(af(n),SC(e,s)),lf(e)},lf=e=>e.editorManager.setActive(e),cB=(e,t)=>{e.removed||(t?lf(e):lB(e))},kC=(e,t)=>t.collapsed?e.isEditable(t.startContainer):e.isEditable(t.startContainer)&&e.isEditable(t.endContainer),xC=(e,t,n,s,o)=>{const r=n?t.startContainer:t.endContainer,a=n?t.startOffset:t.endOffset;return m.from(r).map(C.fromDom).map(i=>!s||!t.collapsed?xo(i,o(i,a)).getOr(i):i).bind(i=>$t(i)?m.some(i):tn(i).filter($t)).map(i=>i.dom).getOr(e)},_C=(e,t,n=!1)=>xC(e,t,!0,n,(s,o)=>Math.min(xc(s),o)),NC=(e,t,n=!1)=>xC(e,t,!1,n,(s,o)=>o>0?o-1:o),AC=(e,t)=>{const n=e;for(;e&&B(e)&&e.length===0;)e=t?e.nextSibling:e.previousSibling;return e||n},uB=(e,t)=>{if(!t)return e;let n=t.startContainer,s=t.endContainer;const o=t.startOffset,r=t.endOffset;let a=t.commonAncestorContainer;t.collapsed||(n===s&&r-o<2&&n.hasChildNodes()&&(a=n.childNodes[o]),B(n)&&B(s)&&(n.length===o?n=AC(n.nextSibling,!0):n=n.parentNode,r===0?s=AC(s.previousSibling,!1):s=s.parentNode,n&&n===s&&(a=n)));const i=B(a)?a.parentNode:a;return Xn(i)?i:e},fB=(e,t,n,s)=>{const o=[],r=e.getRoot(),a=e.getParent(n||_C(r,t,t.collapsed),e.isBlock),i=e.getParent(s||NC(r,t,t.collapsed),e.isBlock);if(a&&a!==r&&o.push(a),a&&i&&a!==i){let l;const c=new Xe(a,r);for(;(l=c.next())&&l!==i;)e.isBlock(l)&&o.push(l)}return i&&a!==i&&i!==r&&o.push(i),o},dB=(e,t,n)=>m.from(t).bind(s=>m.from(s.parentNode).map(o=>{const r=e.nodeIndex(s),a=e.createRng();return a.setStart(o,r),a.setEnd(o,r+1),n&&(Lu(e,a,s,!0),Lu(e,a,s,!1)),a})),cf=(e,t)=>he(t,n=>{const s=e.dispatch("GetSelectionRange",{range:n});return s.range!==n?s.range:n}),mB=e=>pe(e)==="img"?1:hp(e).fold(()=>rt(e).length,t=>t.length),gB=e=>hp(e).filter(t=>t.trim().length!==0||t.indexOf(Je)>-1).isSome(),pB=e=>Za(e)&&Ft(e,"contenteditable")==="false",hB=["img","br"],TC=e=>gB(e)||Ne(hB,pe(e))||pB(e),bB=e=>Jg(e,TC),CB=e=>yB(e,TC),yB=(e,t)=>{const n=s=>{const o=rt(s);for(let r=o.length-1;r>=0;r--){const a=o[r];if(t(a))return m.some(a);const i=n(a);if(i.isSome())return i}return m.none()};return n(e)},RC="[data-mce-autocompleter]",vB=(e,t)=>{if(PC(C.fromDom(e.getBody())).isNone()){const n=C.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',e.getDoc());Ve(n,C.fromDom(t.extractContents())),t.insertNode(n.dom),tn(n).each(s=>s.dom.normalize()),CB(n).map(s=>{e.selection.setCursorLocation(s.dom,mB(s))})}},EB=e=>Os(e,RC),PC=e=>Nr(e,RC),SB=(e,t)=>PC(t).each(n=>{const s=e.selection.getBookmark();Yn(n),e.selection.moveToBookmark(s)}),wB={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},Wi=(e,t,n)=>{const s=n?"lastChild":"firstChild",o=n?"prev":"next";if(e[s])return e[s];if(e!==t){let r=e[o];if(r)return r;for(let a=e.parent;a&&a!==t;a=a.parent)if(r=a[o],r)return r}},kB=e=>{var t;const n=(t=e.value)!==null&&t!==void 0?t:"";if(!us(n))return!1;const s=e.parent;return!(s&&(s.name!=="span"||s.attr("style"))&&/^[ ]+$/.test(n))},DC=e=>{const t=e.name==="a"&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t};class vt{static create(t,n){const s=new vt(t,wB[t]||1);return n&&Te(n,(o,r)=>{s.attr(r,o)}),s}constructor(t,n){this.name=t,this.type=n,n===1&&(this.attributes=[],this.attributes.map={})}replace(t){const n=this;return t.parent&&t.remove(),n.insert(t,n),n.remove(),n}attr(t,n){const s=this;if(!Q(t))return M(t)&&Te(t,(r,a)=>{s.attr(a,r)}),s;const o=s.attributes;if(o){if(n!==void 0){if(n===null){if(t in o.map){delete o.map[t];let r=o.length;for(;r--;)if(o[r].name===t)return o.splice(r,1),s}return s}if(t in o.map){let r=o.length;for(;r--;)if(o[r].name===t){o[r].value=n;break}}else o.push({name:t,value:n});return o.map[t]=n,s}return o.map[t]}}clone(){const t=this,n=new vt(t.name,t.type),s=t.attributes;if(s){const o=[];o.map={};for(let r=0,a=s.length;r<a;r++){const i=s[r];i.name!=="id"&&(o[o.length]={name:i.name,value:i.value},o.map[i.name]=i.value)}n.attributes=o}return n.value=t.value,n}wrap(t){const n=this;return n.parent&&(n.parent.insert(t,n),t.append(n)),n}unwrap(){const t=this;for(let n=t.firstChild;n;){const s=n.next;t.insert(n,t,!0),n=s}t.remove()}remove(){const t=this,n=t.parent,s=t.next,o=t.prev;return n&&(n.firstChild===t?(n.firstChild=s,s&&(s.prev=null)):o&&(o.next=s),n.lastChild===t?(n.lastChild=o,o&&(o.next=null)):s&&(s.prev=o),t.parent=t.next=t.prev=null),t}append(t){const n=this;t.parent&&t.remove();const s=n.lastChild;return s?(s.next=t,t.prev=s,n.lastChild=t):n.lastChild=n.firstChild=t,t.parent=n,t}insert(t,n,s){t.parent&&t.remove();const o=n.parent||this;return s?(n===o.firstChild?o.firstChild=t:n.prev&&(n.prev.next=t),t.prev=n.prev,t.next=n,n.prev=t):(n===o.lastChild?o.lastChild=t:n.next&&(n.next.prev=t),t.next=n.next,t.prev=n,n.next=t),t.parent=o,t}getAll(t){const n=this,s=[];for(let o=n.firstChild;o;o=Wi(o,n))o.name===t&&s.push(o);return s}children(){const t=this,n=[];for(let s=t.firstChild;s;s=s.next)n.push(s);return n}empty(){const t=this;if(t.firstChild){const n=[];for(let o=t.firstChild;o;o=Wi(o,t))n.push(o);let s=n.length;for(;s--;){const o=n[s];o.parent=o.firstChild=o.lastChild=o.next=o.prev=null}}return t.firstChild=t.lastChild=null,t}isEmpty(t,n={},s){var o;const r=this;let a=r.firstChild;if(DC(r))return!1;if(a)do{if(a.type===1){if(a.attr("data-mce-bogus"))continue;if(t[a.name]||DC(a))return!1}if(a.type===8||a.type===3&&!kB(a)||a.type===3&&a.parent&&n[a.parent.name]&&us((o=a.value)!==null&&o!==void 0?o:"")||s&&s(a))return!1}while(a=Wi(a,r));return!0}walk(t){return Wi(this,null,t)}}const xB=$.makeMap("NOSCRIPT STYLE SCRIPT XMP IFRAME NOEMBED NOFRAMES PLAINTEXT"," "),BC=e=>Q(e.nodeValue)&&e.nodeValue.includes(Ze),OC=e=>`${e.length===0?"":`${he(e,t=>`[${t}]`).join(",")},`}[data-mce-bogus="all"]`,_B=(e,t)=>t.querySelectorAll(OC(e)),IC=e=>document.createTreeWalker(e,NodeFilter.SHOW_COMMENT,t=>BC(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP),LC=e=>document.createTreeWalker(e,NodeFilter.SHOW_TEXT,t=>{if(BC(t)){const n=t.parentNode;return n&&re(xB,n.nodeName)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}else return NodeFilter.FILTER_SKIP}),NB=e=>IC(e).nextNode()!==null,AB=e=>LC(e).nextNode()!==null,TB=(e,t)=>t.querySelector(OC(e))!==null,RB=(e,t)=>{P(_B(e,t),n=>{const s=C.fromDom(n);Ft(s,"data-mce-bogus")==="all"?De(s):P(e,o=>{vr(s,o)&&ot(s,o)})})},$C=e=>{let t=e.nextNode();for(;t!==null;)t.nodeValue=null,t=e.nextNode()},PB=kn($C,IC),DB=kn($C,LC),FC=(e,t)=>{const n=[{condition:K(TB,t),action:K(RB,t)},{condition:NB,action:PB},{condition:AB,action:DB}];let s=e,o=!1;return P(n,({condition:r,action:a})=>{r(s)&&(o||(s=e.cloneNode(!0),o=!0),a(s))}),s},MC=e=>{const t=gt(e,"[data-mce-bogus]");P(t,n=>{Ft(n,"data-mce-bogus")==="all"?De(n):Ms(n)?(Dt(n,C.fromText(Pr)),De(n)):Yn(n)})},UC=e=>{const t=gt(e,"input");P(t,n=>{ot(n,"name")})},BB=(e,t)=>{const n=pt(e),s=new RegExp(`^(<${n}[^>]*>(&nbsp;|&#160;|\\s| |<br \\/>|)<\\/${n}>[\r
]*|<br \\/>[\r
]*)$`);return t.replace(s,"")},OB=(e,t)=>{const n=e.getDoc(),s=as(C.fromDom(e.getBody())),o=C.fromTag("div",n);st(o,"data-mce-bogus","all"),ei(o,{position:"fixed",left:"-9999999px",top:"0"}),ni(o,t.innerHTML),MC(o),UC(o);const r=__(s);Ve(r,o);const a=Mt(o.dom.innerText);return De(o),a},IB=(e,t,n)=>{let s;return t.format==="raw"?s=$.trim(Mt(FC(n,e.serializer.getTempAttrs()).innerHTML)):t.format==="text"?s=OB(e,n):t.format==="tree"?s=e.serializer.serialize(n,t):s=BB(e,e.serializer.serialize(n,t)),t.format!=="text"&&!li(C.fromDom(n))&&Q(s)?$.trim(s):s},LB=(e,t)=>m.from(e.getBody()).fold(z(t.format==="tree"?new vt("body",11):""),n=>IB(e,t,n)),zC=$.makeMap,HC=e=>{const t=[];e=e||{};const n=e.indent,s=zC(e.indent_before||""),o=zC(e.indent_after||""),r=fs.getEncodeFunc(e.entity_encoding||"raw",e.entities),a=e.element_format!=="xhtml";return{start:(i,l,c)=>{if(n&&s[i]&&t.length>0){const u=t[t.length-1];u.length>0&&u!==`
`&&t.push(`
`)}if(t.push("<",i),l)for(let u=0,f=l.length;u<f;u++){const d=l[u];t.push(" ",d.name,'="',r(d.value,!0),'"')}if(!c||a?t[t.length]=">":t[t.length]=" />",c&&n&&o[i]&&t.length>0){const u=t[t.length-1];u.length>0&&u!==`
`&&t.push(`
`)}},end:i=>{let l;t.push("</",i,">"),n&&o[i]&&t.length>0&&(l=t[t.length-1],l.length>0&&l!==`
`&&t.push(`
`))},text:(i,l)=>{i.length>0&&(t[t.length]=l?i:r(i))},cdata:i=>{t.push("<![CDATA[",i,"]]>")},comment:i=>{t.push("<!--",i,"-->")},pi:(i,l)=>{l?t.push("<?",i," ",r(l),"?>"):t.push("<?",i,"?>"),n&&t.push(`
`)},doctype:i=>{t.push("<!DOCTYPE",i,">",n?`
`:"")},reset:()=>{t.length=0},getContent:()=>t.join("").replace(/\n$/,"")}},Cs=(e={},t=ds())=>{const n=HC(e);return e.validate="validate"in e?e.validate:!0,{serialize:o=>{const r=e.validate,a={3:l=>{var c;n.text((c=l.value)!==null&&c!==void 0?c:"",l.raw)},8:l=>{var c;n.comment((c=l.value)!==null&&c!==void 0?c:"")},7:l=>{n.pi(l.name,l.value)},10:l=>{var c;n.doctype((c=l.value)!==null&&c!==void 0?c:"")},4:l=>{var c;n.cdata((c=l.value)!==null&&c!==void 0?c:"")},11:l=>{let c=l;if(c=c.firstChild)do i(c);while(c=c.next)}};n.reset();const i=l=>{var c;const u=a[l.type];if(u)u(l);else{const f=l.name,d=f in t.getVoidElements();let p=l.attributes;if(r&&p&&p.length>1){const b=[];b.map={};const g=t.getElementRule(l.name);if(g){for(let h=0,y=g.attributesOrder.length;h<y;h++){const E=g.attributesOrder[h];if(E in p.map){const v=p.map[E];b.map[E]=v,b.push({name:E,value:v})}}for(let h=0,y=p.length;h<y;h++){const E=p[h].name;if(!(E in b.map)){const v=p.map[E];b.map[E]=v,b.push({name:E,value:v})}}p=b}}if(n.start(f,p,d),Us(f))Q(l.value)&&n.text(l.value,!0),n.end(f);else if(!d){let b=l.firstChild;if(b){(f==="pre"||f==="textarea")&&b.type===3&&((c=b.value)===null||c===void 0?void 0:c[0])===`
`&&n.text(`
`,!0);do i(b);while(b=b.next)}n.end(f)}}};return o.type===1&&!e.inner?i(o):o.type===3?a[3](o):a[11](o),n.getContent()}}},WC=new Set;P(["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"],t=>{WC.add(t)});const VC=["font","text-decoration","text-emphasis"],uf=(e,t)=>Pt(e.parseStyle(e.getAttrib(t,"style"))),$B=e=>WC.has(e),FB=(e,t)=>rs(uf(e,t),n=>!$B(n)),MB=e=>oe(e,t=>Ue(VC,n=>ct(t,n))),UB=(e,t,n)=>{const s=uf(e,t),o=uf(e,n),r=a=>{var i,l;const c=(i=e.getStyle(t,a))!==null&&i!==void 0?i:"",u=(l=e.getStyle(n,a))!==null&&l!==void 0?l:"";return xn(c)&&xn(u)&&c!==u};return Ue(s,a=>{const i=l=>Ue(l,c=>c===a);if(!i(o)&&i(VC)){const l=MB(o);return Ue(l,r)}else return r(a)})},jC=(e,t,n)=>m.from(n.container()).filter(B).exists(s=>{const o=e?0:-1;return t(s.data.charAt(n.offset()+o))}),ff=K(jC,!0,Uo),df=K(jC,!1,Uo),zB=e=>{const t=e.container();return B(t)&&(t.data.length===0||ci(t.data)&&aa.isBookmarkNode(t.parentNode))},ys=(e,t)=>n=>xu(e?0:-1,n).filter(t).isSome(),qC=e=>pp(e)&&Tn(C.fromDom(e),"display")==="block",KC=e=>Be(e)&&!Z_(e),HB=ys(!0,qC),WB=ys(!1,qC),ca=ys(!0,Rn),ua=ys(!1,Rn),GC=ys(!0,Zn),YC=ys(!1,Zn),vs=ys(!0,KC),Es=ys(!1,KC),VB=e=>e.slice(0,-1),jB=(e,t,n)=>jn(t,e)?VB(Kg(e,s=>n(s)||ve(s,t))):[],XC=(e,t)=>jB(e,t,$e),es=(e,t)=>[e].concat(XC(e,t)),mf=(e,t,n)=>bb(e,t,n,zB),qB=e=>t=>e.isBlock(pe(t)),ZC=(e,t,n)=>Ye(es(C.fromDom(t.container()),e),qB(n)),QC=(e,t,n,s)=>mf(e,t.dom,n).forall(o=>ZC(t,n,s).fold(()=>!Dn(o,n,t.dom),r=>!Dn(o,n,t.dom)&&jn(r,C.fromDom(o.container())))),JC=(e,t,n,s)=>ZC(t,n,s).fold(()=>mf(e,t.dom,n).forall(o=>!Dn(o,n,t.dom)),o=>mf(e,o.dom,n).isNone()),gf=K(JC,!1),ey=K(JC,!0),KB=K(QC,!1),GB=K(QC,!0),YB=e=>Ni(e).exists(Ms),Vi=(e,t,n,s)=>{const o=oe(es(C.fromDom(n.container()),t),a=>s.isBlock(pe(a))),r=Rt(o).getOr(t);return Vt(e,r.dom,n).filter(YB)},pf=(e,t,n)=>Ni(t).exists(Ms)||Vi(!0,e,t,n).isSome(),hf=(e,t,n)=>NP(t).exists(Ms)||Vi(!1,e,t,n).isSome(),XB=K(Vi,!1),ZB=K(Vi,!0),ty=e=>N.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd(),ny=(e,t,n)=>{const s=oe(es(C.fromDom(t.container()),e),o=>n.isBlock(pe(o)));return Rt(s).getOr(e)},sy=(e,t,n)=>ty(t)?df(t):df(t)||Bt(ny(e,t,n).dom,t).exists(df),oy=(e,t,n)=>ty(t)?ff(t):ff(t)||_t(ny(e,t,n).dom,t).exists(ff),QB=e=>Ne(["pre","pre-wrap"],e),bf=e=>Ni(e).bind(t=>Bs(t,$t)).exists(t=>QB(Tn(t,"white-space"))),JB=(e,t)=>Bt(e.dom,t).isNone(),eO=(e,t)=>_t(e.dom,t).isNone(),tO=(e,t,n)=>JB(e,t)||eO(e,t)||gf(e,t,n)||ey(e,t,n)||hf(e,t,n)||pf(e,t,n),nO=e=>M(e)&&Be(e)&&ob(e),ry=(e,t)=>n=>nO(new Xe(n,e)[t]()),sO=(e,t)=>{const n=_t(e.dom,t).getOr(t),s=ry(e.dom,"next");return t.isAtEnd()&&(s(t.container())||s(n.container()))},oO=(e,t)=>{const n=Bt(e.dom,t).getOr(t),s=ry(e.dom,"prev");return t.isAtStart()&&(s(t.container())||s(n.container()))},ay=(e,t,n)=>bf(t)?!1:tO(e,t,n)||sy(e,t,n)||oy(e,t,n),fa=(e,t,n)=>bf(t)?!1:gf(e,t,n)||KB(e,t,n)||hf(e,t,n)||sy(e,t,n)||oO(e,t),rO=e=>{const t=e.container(),n=e.offset();return B(t)&&n<t.data.length?N(t,n+1):e},da=(e,t,n)=>bf(t)?!1:ey(e,t,n)||GB(e,t,n)||pf(e,t,n)||oy(e,t,n)||sO(e,t),Cf=(e,t,n)=>fa(e,t,n)||da(e,rO(t),n),iy=(e,t)=>Pi(e.charAt(t)),ly=(e,t)=>Uo(e.charAt(t)),aO=e=>{const t=e.container();return B(t)&&dt(t.data,Je)},iO=e=>{const t=e.split("");return he(t,(n,s)=>Pi(n)&&s>0&&s<t.length-1&&Du(t[s-1])&&Du(t[s+1])?" ":n).join("")},cy=(e,t,n,s)=>{const o=t.data,r=N(t,0);return!n&&iy(o,0)&&!Cf(e,r,s)?(t.data=" "+o.slice(1),!0):n&&ly(o,0)&&fa(e,r,s)?(t.data=Je+o.slice(1),!0):!1},lO=e=>{const t=e.data,n=iO(t);return n!==t?(e.data=n,!0):!1},uy=(e,t,n,s)=>{const o=t.data,r=N(t,o.length-1);return!n&&iy(o,o.length-1)&&!Cf(e,r,s)?(t.data=o.slice(0,-1)+" ",!0):n&&ly(o,o.length-1)&&da(e,r,s)?(t.data=o.slice(0,-1)+Je,!0):!1},cO=(e,t,n)=>{const s=t.container();if(!B(s))return m.none();if(aO(t)){const o=cy(e,s,!1,n)||lO(s)||uy(e,s,!1,n);return wo(o,t)}else if(Cf(e,t,n)){const o=cy(e,s,!0,n)||uy(e,s,!0,n);return wo(o,t)}else return m.none()},uO=e=>{const t=C.fromDom(e.getBody());e.selection.isCollapsed()&&cO(t,N.fromRangeStart(e.selection.getRng()),e.schema).each(n=>{e.selection.setRng(n.toRange())})},fy=(e,t,n,s)=>{if(n===0)return;const o=C.fromDom(e),r=Kn(o,c=>s.isBlock(pe(c))).getOr(o),a=e.data.slice(t,t+n),i=t+n>=e.data.length&&da(r,N(e,e.data.length),s),l=t===0&&fa(r,N(e,0),s);e.replaceData(t,n,kp(a,4,l,i))},ji=(e,t,n)=>{const s=e.data.slice(t),o=s.length-$x(s).length;fy(e,t,o,n)},yf=(e,t,n)=>{const s=e.data.slice(0,t),o=s.length-cg(s).length;fy(e,t-o,o,n)},vf=(e,t,n,s,o=!0)=>{const r=cg(e.data).length,a=o?e:t,i=o?t:e;return o?a.appendData(i.data):a.insertData(0,i.data),De(C.fromDom(i)),s&&ji(a,r,n),a},fO=(e,t)=>{const n=e.container(),s=e.offset();return!N.isTextPosition(e)&&n===t.parentNode&&s>N.before(t).offset()},dO=(e,t)=>fO(t,e)?N(t.container(),t.offset()-1):t,mO=e=>B(e)?N(e,0):N.before(e),gO=e=>B(e)?N(e,e.data.length):N.after(e),dy=e=>sn(e.previousSibling)?m.some(gO(e.previousSibling)):e.previousSibling?on(e.previousSibling):m.none(),my=e=>sn(e.nextSibling)?m.some(mO(e.nextSibling)):e.nextSibling?ht(e.nextSibling):m.none(),pO=(e,t)=>m.from(t.previousSibling?t.previousSibling:t.parentNode).bind(n=>Bt(e,N.before(n))).orThunk(()=>_t(e,N.after(t))),hO=(e,t)=>_t(e,N.after(t)).orThunk(()=>Bt(e,N.before(t))),bO=(e,t)=>dy(t).orThunk(()=>my(t)).orThunk(()=>pO(e,t)),CO=(e,t)=>my(t).orThunk(()=>dy(t)).orThunk(()=>hO(e,t)),yO=(e,t,n)=>e?CO(t,n):bO(t,n),vO=(e,t,n)=>yO(e,t,n).map(K(dO,n)),gy=(e,t,n)=>{n.fold(()=>{e.focus()},s=>{e.selection.setRng(s.toRange(),t)})},EO=e=>t=>t.dom===e,SO=(e,t)=>t&&re(e.schema.getBlockElements(),pe(t)),wO=(e,t)=>{if(ze(e)){const n=C.fromHtml('<br data-mce-bogus="1">');return t?P(rt(e),s=>{ju(s)||De(s)}):No(e),Ve(e,n),m.some(N.before(n.dom))}else return m.none()},kO=(e,t,n,s)=>{const o=Ds(e).filter(Ht),r=xr(e).filter(Ht);return De(e),e_(o,r,t,(a,i,l)=>{const c=a.dom,u=i.dom,f=c.data.length;return vf(c,u,n,s),l.container()===u?N(c,f):l}).orThunk(()=>(s&&(o.each(a=>yf(a.dom,a.dom.length,n)),r.each(a=>ji(a.dom,0,n))),t))},xO=(e,t)=>re(e.schema.getTextInlineElements(),pe(t)),no=(e,t,n,s=!0,o=!1)=>{const r=vO(t,e.getBody(),n.dom),a=Kn(n,K(SO,e),EO(e.getBody())),i=kO(n,r,e.schema,xO(e,n));e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):a.bind(l=>wO(l,o)).fold(()=>{s&&gy(e,t,i)},l=>{s&&gy(e,t,m.some(l))})},_O=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,NO=e=>_O.test(e),so=(e,t)=>mn(C.fromDom(t),iR(e))&&!zs(e.schema,t)&&e.dom.isEditable(t),py=e=>{var t;return Ae.DOM.getStyle(e,"direction",!0)==="rtl"||NO((t=e.textContent)!==null&&t!==void 0?t:"")},AO=(e,t,n)=>oe(Ae.DOM.getParents(n.container(),"*",t),e),Ss=(e,t,n)=>{const s=AO(e,t,n);return m.from(s[s.length-1])},TO=(e,t,n)=>{const s=hs(t,e),o=hs(n,e);return M(s)&&s===o},RO=e=>Mc(e)||Uc(e),Yt=(e,t)=>{const n=t.container(),s=t.offset();return e?cs(n)?B(n.nextSibling)?N(n.nextSibling,0):N.after(n):Mc(t)?N(n,s+1):t:cs(n)?B(n.previousSibling)?N(n.previousSibling,n.previousSibling.data.length):N.before(n):Uc(t)?N(n,s-1):t},hy=K(Yt,!0),by=K(Yt,!1),Cy=(e,t)=>{const n=s=>s.stopImmediatePropagation();e.on("beforeinput input",n,!0),e.getDoc().execCommand(t),e.off("beforeinput input",n)},PO=e=>{e.execCommand("delete")},Ef=e=>Cy(e,"Delete"),DO=e=>Cy(e,"ForwardDelete"),BO=e=>t=>So(tn(t),e,ve),OO=e=>bp(e)||Dr(e),qi=(e,t)=>jn(e,t)?Bs(t,OO,BO(e)):m.none(),Sf=(e,t=!0)=>{e.dom.isEmpty(e.getBody())&&e.setContent("",{no_selection:!t})},yy=(e,t,n)=>mt(ht(n),on(n),(s,o)=>{const r=Yt(!0,s),a=Yt(!1,o),i=Yt(!1,t);return e?_t(n,i).exists(l=>l.isEqual(a)&&t.isEqual(r)):Bt(n,i).exists(l=>l.isEqual(r)&&t.isEqual(a))}).getOr(!0),vy=e=>(l_(e)?Ds(e):kc(e)).bind(vy).orThunk(()=>m.some(e)),Ey=(e,t,n,s=!0)=>{var o;t.deleteContents();const r=vy(n).getOr(n),a=C.fromDom((o=e.dom.getParent(r.dom,e.dom.isBlock))!==null&&o!==void 0?o:n.dom);if(a.dom===e.getBody()?Sf(e,s):ze(a)&&(ls(a),s&&e.selection.setCursorLocation(a.dom,0)),!ve(n,a)){const i=So(tn(a),n)?[]:S_(a);P(i.concat(rt(n)),l=>{!ve(l,a)&&!jn(l,a)&&ze(l)&&De(l)})}},IO=(e,t,n)=>Kn(e,t,n).isSome(),LO=(e,t)=>R_(e,t).isSome(),Sy=(e,t)=>Jg(e,t).isSome(),$O=e=>t=>ve(e,t),wf=e=>gt(e,"td,th"),wy=(e,t)=>sa(C.fromDom(e),t),FO=e=>mt(e.startTable,e.endTable,(t,n)=>{const s=Sy(t,r=>ve(r,n)),o=Sy(n,r=>ve(r,t));return!s&&!o?e:{...e,startTable:s?m.none():e.startTable,endTable:o?m.none():e.endTable,isSameTable:!1,isMultiTable:!1}}).getOr(e),MO=e=>FO(e),UO=(e,t)=>{const n=wy(e.startContainer,t),s=wy(e.endContainer,t),o=n.isSome(),r=s.isSome(),a=mt(n,s,ve).getOr(!1);return MO({startTable:n,endTable:s,isStartInTable:o,isEndInTable:r,isSameTable:a,isMultiTable:!a&&o&&r})},kf=(e,t)=>({start:e,end:t}),zO=(e,t,n)=>({rng:e,table:t,cells:n}),ma=Pn.generate([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]),Ki=(e,t)=>Os(C.fromDom(e),"td,th",t),ky=e=>!ve(e.start,e.end),xy=(e,t)=>sa(e.start,t).bind(n=>sa(e.end,t).bind(s=>wo(ve(n,s),n))),HO=(e,t)=>!ky(e)&&xy(e,t).exists(n=>{const s=n.dom.rows;return s.length===1&&s[0].cells.length===1}),WO=(e,t)=>{const n=Ki(e.startContainer,t),s=Ki(e.endContainer,t);return mt(n,s,kf)},VO=e=>t=>sa(t,e).bind(n=>As(wf(n)).map(s=>kf(t,s))),jO=e=>t=>sa(t,e).bind(n=>Rt(wf(n)).map(s=>kf(s,t))),xf=e=>t=>xy(t,e).map(n=>zO(t,n,wf(n))),_y=(e,t,n,s)=>{if(n.collapsed||!e.forall(ky))return m.none();if(t.isSameTable){const o=e.bind(xf(s));return m.some({start:o,end:o})}else{const o=Ki(n.startContainer,s),r=Ki(n.endContainer,s),a=o.bind(VO(s)).bind(xf(s)),i=r.bind(jO(s)).bind(xf(s));return m.some({start:a,end:i})}},Ny=(e,t)=>mr(e,n=>ve(n,t)),_f=e=>mt(Ny(e.cells,e.rng.start),Ny(e.cells,e.rng.end),(t,n)=>e.cells.slice(t,n+1)),qO=(e,t,n)=>e.exists(s=>HO(s,n)&&Iu(s.start,t)),Ay=(e,t)=>{const{startTable:n,endTable:s}=t,o=e.cloneRange();return n.each(r=>o.setStartAfter(r.dom)),s.each(r=>o.setEndBefore(r.dom)),o},KO=(e,t,n,s)=>_y(e,t,n,s).bind(({start:o,end:r})=>o.or(r)).bind(o=>{const{isSameTable:r}=t,a=_f(o).getOr([]);if(r&&o.cells.length===a.length)return m.some(ma.fullTable(o.table));if(a.length>0){if(r)return m.some(ma.partialTable(a,m.none()));{const i=Ay(n,t);return m.some(ma.partialTable(a,m.some({...t,rng:i})))}}else return m.none()}),GO=(e,t,n,s)=>_y(e,t,n,s).bind(({start:o,end:r})=>{const a=o.bind(_f).getOr([]),i=r.bind(_f).getOr([]);if(a.length>0&&i.length>0){const l=Ay(n,t);return m.some(ma.multiTable(a,i,l))}else return m.none()}),YO=(e,t)=>{const n=$O(e),s=WO(t,n),o=UO(t,n);return qO(s,t,n)?s.map(r=>ma.singleCellTable(t,r.start)):o.isMultiTable?GO(s,o,t,n):KO(s,o,t,n)},Ty=e=>P(e,t=>{ot(t,"contenteditable"),ls(t)}),XO=(e,t)=>m.from(e.dom.getParent(t,e.dom.isBlock)).map(C.fromDom),ZO=(e,t,n)=>{n.each(s=>{t?De(s):(ls(s),e.selection.setCursorLocation(s.dom,0))})},Nf=(e,t,n,s)=>{const o=n.cloneRange();s?(o.setStart(n.startContainer,n.startOffset),o.setEndAfter(t.dom.lastChild)):(o.setStartBefore(t.dom.firstChild),o.setEnd(n.endContainer,n.endOffset)),Af(e,o,t,!1).each(r=>r())},Ry=e=>{const t=zo(e),n=C.fromDom(e.selection.getNode());ai(n.dom)&&ze(n)?e.selection.setCursorLocation(n.dom,0):e.selection.collapse(!0),t.length>1&&Ue(t,s=>ve(s,n))&&st(n,"data-mce-selected","1")},Py=(e,t,n)=>m.some(()=>{const s=e.selection.getRng(),o=n.bind(({rng:r,isStartInTable:a})=>{const i=XO(e,a?r.endContainer:r.startContainer);r.deleteContents(),ZO(e,a,i.filter(ze));const l=a?t[0]:t[t.length-1];return Nf(e,l,s,a),ze(l)?m.none():m.some(a?t.slice(1):t.slice(0,-1))}).getOr(t);Ty(o),Ry(e)}),QO=(e,t,n,s)=>m.some(()=>{const o=e.selection.getRng(),r=t[0],a=n[n.length-1];Nf(e,r,o,!0),Nf(e,a,o,!1);const i=ze(r)?t:t.slice(1),l=ze(a)?n:n.slice(0,-1);Ty(i.concat(l)),s.deleteContents(),Ry(e)}),Af=(e,t,n,s=!0)=>m.some(()=>{Ey(e,t,n,s)}),JO=(e,t)=>m.some(()=>no(e,!1,t)),eI=(e,t,n)=>YO(t,n).bind(s=>s.fold(K(Af,e),K(JO,e),K(Py,e),K(QO,e))),tI=(e,t)=>Gi(e,t),nI=(e,t,n,s)=>Tf(t,s).fold(()=>eI(e,t,n),o=>tI(e,o)),sI=(e,t,n)=>{const s=C.fromDom(e.getBody()),o=e.selection.getRng();return n.length!==0?Py(e,n,m.none()):nI(e,s,o,t)},Dy=(e,t)=>Ye(es(t,e),Br),Tf=(e,t)=>Ye(es(t,e),Qa("caption")),oI=(e,t,n,s,o)=>Fo(n,e.getBody(),o).bind(r=>Dy(t,C.fromDom(r.getNode())).bind(a=>ve(a,s)?m.none():m.some(ce))),Gi=(e,t)=>m.some(()=>{ls(t),e.selection.setCursorLocation(t.dom,0)}),rI=(e,t,n,s)=>ht(e.dom).bind(o=>on(e.dom).map(r=>t?n.isEqual(o)&&s.isEqual(r):n.isEqual(r)&&s.isEqual(o))).getOr(!0),aI=(e,t)=>Gi(e,t),iI=(e,t,n)=>Tf(e,C.fromDom(n.getNode())).fold(()=>m.some(ce),s=>wo(!ve(s,t),ce)),lI=(e,t,n,s,o)=>Fo(n,e.getBody(),o).fold(()=>m.some(ce),r=>rI(s,n,o,r)?aI(e,s):iI(t,s,r)),cI=(e,t,n,s)=>{const o=N.fromRangeStart(e.selection.getRng());return Dy(n,s).bind(r=>ze(r)?Gi(e,r):oI(e,n,t,r,o))},uI=(e,t,n,s)=>{const o=N.fromRangeStart(e.selection.getRng());return ze(s)?Gi(e,s):lI(e,n,t,s,o)},By=(e,t)=>e?GC(t):YC(t),fI=(e,t)=>{const n=N.fromRangeStart(e.selection.getRng());return By(t,n)||Vt(t,e.getBody(),n).exists(s=>By(t,s))},dI=(e,t,n)=>{const s=C.fromDom(e.getBody());return Tf(s,n).fold(()=>cI(e,t,s,n).orThunk(()=>wo(fI(e,t),ce)),o=>uI(e,t,s,o))},Rf=(e,t)=>{const n=C.fromDom(e.selection.getStart(!0)),s=zo(e);return e.selection.isCollapsed()&&s.length===0?dI(e,t,n):sI(e,n,s)},oo=(e,t)=>{let n=t;for(;n&&n!==e;){if(nn(n)||Be(n))return n;n=n.parentNode}return null},mI=["data-ephox-","data-mce-","data-alloy-","data-snooker-","_"],gI=$.each,Pf=e=>{const t=e.dom,n=new Set(e.serializer.getTempAttrs()),s=(r,a)=>{if(r.nodeName!==a.nodeName||r.nodeType!==a.nodeType)return!1;const i=c=>{const u={};return gI(t.getAttribs(c),f=>{const d=f.nodeName.toLowerCase();d!=="style"&&!o(d)&&(u[d]=t.getAttrib(c,d))}),u},l=(c,u)=>{for(const f in c)if(re(c,f)){const d=u[f];if(lt(d)||c[f]!==d)return!1;delete u[f]}for(const f in u)if(re(u,f))return!1;return!0};return G(r)&&G(a)&&(!l(i(r),i(a))||!l(t.parseStyle(t.getAttrib(r,"style")),t.parseStyle(t.getAttrib(a,"style"))))?!1:!qt(r)&&!qt(a)},o=r=>Ue(mI,a=>ct(r,a))||n.has(r);return{compare:s,isAttributeInternal:o}},Oy=e=>["h1","h2","h3","h4","h5","h6"].includes(e.name),pI=e=>e.name==="summary",hI=(e,t)=>{let n=e;for(;n=n.walk();)t(n)},Iy=(e,t,n,s)=>{const o=n.name;for(let r=0,a=e.length;r<a;r++){const i=e[r];if(i.name===o){const l=s.nodes[o];l?l.nodes.push(n):s.nodes[o]={filter:i,nodes:[n]}}}if(n.attributes)for(let r=0,a=t.length;r<a;r++){const i=t[r],l=i.name;if(l in n.attributes.map){const c=s.attributes[l];c?c.nodes.push(n):s.attributes[l]={filter:i,nodes:[n]}}}},bI=(e,t,n)=>{const s={nodes:{},attributes:{}};return n.firstChild&&hI(n,o=>{Iy(e,t,o,s)}),s},Ly=(e,t)=>{const n=(s,o)=>{Te(s,r=>{const a=Lt(r.nodes);P(r.filter.callbacks,i=>{for(let l=a.length-1;l>=0;l--){const c=a[l];(!(o?c.attr(r.filter.name)!==void 0:c.name===r.filter.name)||je(c.parent))&&a.splice(l,1)}a.length>0&&i(a,r.filter.name,t)})})};n(e.nodes,!1),n(e.attributes,!0)},$y=(e,t,n,s={})=>{const o=bI(e,t,n);Ly(o,s)},Df=(e,t,n,s)=>{if((e.pad_empty_with_br||t.insert)&&n(s)){const r=new vt("br",1);t.insert&&r.attr("data-mce-bogus","1"),s.empty().append(r)}else s.empty().append(new vt("#text",3)).value=Je},CI=e=>{var t;return Fy(e,"#text")&&((t=e==null?void 0:e.firstChild)===null||t===void 0?void 0:t.value)===Je},Fy=(e,t)=>{const n=e==null?void 0:e.firstChild;return M(n)&&n===e.lastChild&&n.name===t},yI=(e,t)=>{const n=e.getElementRule(t.name);return(n==null?void 0:n.paddEmpty)===!0},ga=(e,t,n,s)=>s.isEmpty(t,n,o=>yI(e,o)),vI=(e,t)=>M(e)&&(t(e)||e.name==="br"),EI=e=>{let t;for(let n=e;n;n=n.parent){const s=n.attr("contenteditable");if(s==="false")break;s==="true"&&(t=n)}return m.from(t)},Bf=(e,t,n=e.parent)=>{if(t.getSpecialElements()[e.name])e.empty().remove();else{const s=e.children();for(const o of s)n&&!t.isValidChild(n.name,o.name)&&Bf(o,t,n);e.unwrap()}},Of=(e,t,n,s=ce)=>{const o=t.getTextBlockElements(),r=t.getNonEmptyElements(),a=t.getWhitespaceElements(),i=$.makeMap("tr,td,th,tbody,thead,tfoot,table,summary"),l=new Set,c=u=>u!==n&&!i[u.name];for(let u=0;u<e.length;u++){const f=e[u];let d,p,b;if(!f.parent||l.has(f))continue;if(o[f.name]&&f.parent.name==="li"){let h=f.next;for(;h&&o[h.name];){h.name="li",l.add(h),f.parent.insert(h,f.parent);h=h.next}f.unwrap();continue}const g=[f];for(d=f.parent;d&&!t.isValidChild(d.name,f.name)&&c(d);d=d.parent)g.push(d);if(d&&g.length>1)if(If(t,f,d))Bf(f,t);else{g.reverse(),p=g[0].clone(),s(p);let h=p;for(let y=0;y<g.length-1;y++){t.isValidChild(h.name,g[y].name)&&y>0?(b=g[y].clone(),s(b),h.append(b)):b=h;for(let E=g[y].firstChild;E&&E!==g[y+1];){const v=E.next;b.append(E),E=v}h=b}ga(t,r,a,p)?d.insert(f,g[0],!0):(d.insert(p,g[0],!0),d.insert(f,p)),d=g[0],(ga(t,r,a,d)||Fy(d,"br"))&&d.empty().remove()}else if(f.parent){if(f.name==="li"){let h=f.prev;if(h&&(h.name==="ul"||h.name==="ol")){h.append(f);continue}if(h=f.next,h&&(h.name==="ul"||h.name==="ol")&&h.firstChild){h.insert(f,h.firstChild,!0);continue}const y=new vt("ul",1);s(y),f.wrap(y);continue}if(t.isValidChild(f.parent.name,"div")&&t.isValidChild("div",f.name)){const h=new vt("div",1);s(h),f.wrap(h)}else Bf(f,t)}}},SI=(e,t)=>{let n=e;for(;n;){if(n.name===t)return!0;n=n.parent}return!1},If=(e,t,n=t.parent)=>n?e.children[t.name]&&!e.isValidChild(n.name,t.name)||t.name==="a"&&SI(n,"a")?!0:pI(n)&&Oy(t)?!((n==null?void 0:n.firstChild)===t&&(n==null?void 0:n.lastChild)===t):!1:!1,wI=(e,t,n,s)=>{const o=document.createRange();return o.setStart(e,t),o.setEnd(n,s),o},kI=e=>{const t=N.fromRangeStart(e),n=N.fromRangeEnd(e),s=e.commonAncestorContainer;return Vt(!1,s,n).map(o=>!Dn(t,n,s)&&Dn(t,o,s)?wI(t.container(),t.offset(),o.container(),o.offset()):e).getOr(e)},Lf=e=>e.collapsed?e:kI(e),xI=e=>M(e.firstChild)&&e.firstChild===e.lastChild,_I=e=>e.name==="br"||e.value===Je,NI=(e,t)=>e.getBlockElements()[t.name]&&xI(t)&&_I(t.firstChild),AI=(e,t)=>{const n=e.getNonEmptyElements();return M(t)&&(t.isEmpty(n)||NI(e,t))},TI=(e,t)=>{let n=t.firstChild,s=t.lastChild;return n&&n.name==="meta"&&(n=n.next),s&&s.attr("id")==="mce_marker"&&(s=s.prev),AI(e,s)&&(s=s==null?void 0:s.prev),!n||n!==s?!1:n.name==="ul"||n.name==="ol"},RI=e=>{var t,n;const s=e.firstChild,o=e.lastChild;return s&&s.nodeName==="META"&&((t=s.parentNode)===null||t===void 0||t.removeChild(s)),o&&o.id==="mce_marker"&&((n=o.parentNode)===null||n===void 0||n.removeChild(o)),e},PI=(e,t,n)=>{const s=t.serialize(n),o=e.createFragment(s);return RI(o)},DI=e=>{var t;return oe((t=e==null?void 0:e.childNodes)!==null&&t!==void 0?t:[],n=>n.nodeName==="LI")},BI=e=>e.data===Je||Me(e),OI=e=>M(e==null?void 0:e.firstChild)&&e.firstChild===e.lastChild&&BI(e.firstChild),II=e=>!e.firstChild||OI(e),LI=e=>e.length>0&&II(e[e.length-1])?e.slice(0,-1):e,$f=(e,t)=>{const n=e.getParent(t,e.isBlock);return n&&n.nodeName==="LI"?n:null},$I=(e,t)=>!!$f(e,t),FI=(e,t)=>{const n=t.cloneRange(),s=t.cloneRange();return n.setStartBefore(e),s.setEndAfter(e),[n.cloneContents(),s.cloneContents()]},MI=(e,t)=>{const n=N.before(e),o=On(t).next(n);return o?o.toRange():null},My=(e,t)=>{const n=N.after(e),o=On(t).prev(n);return o?o.toRange():null},UI=(e,t,n,s)=>{const o=FI(e,s),r=e.parentNode;return r&&(r.insertBefore(o[0],e),$.each(t,a=>{r.insertBefore(a,e)}),r.insertBefore(o[1],e),r.removeChild(e)),My(t[t.length-1],n)},zI=(e,t,n)=>{const s=e.parentNode;return s&&$.each(t,o=>{s.insertBefore(o,e)}),MI(e,n)},HI=(e,t,n,s)=>(s.insertAfter(t.reverse(),e),My(t[0],n)),WI=(e,t,n,s)=>{const o=PI(t,e,s),r=$f(t,n.startContainer),a=LI(DI(o.firstChild)),i=1,l=2,c=t.getRoot(),u=f=>{const d=N.fromRangeStart(n),p=On(t.getRoot()),b=f===i?p.prev(d):p.next(d),g=b==null?void 0:b.getNode();return g?$f(t,g)!==r:!0};return r?u(i)?zI(r,a,c):u(l)?HI(r,a,c,t):UI(r,a,c,n):null},VI=["pre"],jI=(e,t,n,s)=>{var o;const r=t.firstChild,a=t.lastChild,i=a.attr("data-mce-type")==="bookmark"?a.prev:a,l=r===i,c=Ne(VI,r.name);if(l&&c){const u=r.attr("contenteditable")!=="false",f=((o=e.getParent(n,e.isBlock))===null||o===void 0?void 0:o.nodeName.toLowerCase())===r.name,d=m.from(oo(s,n)).forall(nn);return u&&f&&d}else return!1},Ff=ai,qI=(e,t,n)=>{if(M(n)){const s=e.getParent(t.endContainer,Ff);return n===s&&Iu(C.fromDom(n),t)}else return!1},KI=(e,t,n)=>{var s;if(n.getAttribute("data-mce-bogus")==="all")(s=n.parentNode)===null||s===void 0||s.insertBefore(e.dom.createFragment(t),n);else{const o=n.firstChild,r=n.lastChild;!o||o===r&&o.nodeName==="BR"?e.dom.setHTML(n,t):e.selection.setContent(t,{no_events:!0})}},GI=(e,t,n)=>{m.from(e.getParent(t,"td,th")).map(C.fromDom).each(s=>pN(s,n))},YI=(e,t)=>{const n=e.schema.getTextInlineElements(),s=e.dom;if(t){const o=e.getBody(),r=Pf(e);$.each(s.select("*[data-mce-fragment]"),a=>{if(M(n[a.nodeName.toLowerCase()])&&FB(s,a)){for(let l=a.parentElement;M(l)&&l!==o&&!UB(s,a,l);l=l.parentElement)if(r.compare(l,a)){s.remove(a,!0);break}}})}},XI=e=>{let t=e;for(;t=t.walk();)t.type===1&&t.attr("data-mce-fragment","1")},ZI=e=>{$.each(e.getElementsByTagName("*"),t=>{t.removeAttribute("data-mce-fragment")})},QI=e=>!!e.getAttribute("data-mce-fragment"),JI=(e,t)=>M(t)&&!e.schema.getVoidElements()[t.nodeName],eL=(e,t)=>{var n,s,o;let r;const a=e.dom,i=e.selection;if(!t)return;i.scrollIntoView(t);const l=oo(e.getBody(),t);if(l&&a.getContentEditable(l)==="false"){a.remove(t),i.select(l);return}let c=a.createRng();const u=t.previousSibling;if(B(u)){c.setStart(u,(s=(n=u.nodeValue)===null||n===void 0?void 0:n.length)!==null&&s!==void 0?s:0);const p=t.nextSibling;B(p)&&(u.appendData(p.data),(o=p.parentNode)===null||o===void 0||o.removeChild(p))}else c.setStartBefore(t),c.setEndBefore(t);const f=p=>{let b=N.fromRangeStart(p);return b=On(e.getBody()).next(b),b==null?void 0:b.toRange()},d=a.getParent(t,a.isBlock);if(a.remove(t),d&&a.isEmpty(d)){const p=Ff(d);No(C.fromDom(d)),c.setStart(d,0),c.setEnd(d,0),!p&&!QI(d)&&(r=f(c))?(c=r,a.remove(d)):a.add(d,a.create("br",p?{}:{"data-mce-bogus":"1"}))}i.setRng(c)},tL=e=>{const t=e.dom,n=Lf(e.selection.getRng());e.selection.setRng(n);const s=t.getParent(n.startContainer,Ff);qI(t,n,s)?Af(e,n,C.fromDom(s)):n.startContainer===n.endContainer&&n.endOffset-n.startOffset===1&&B(n.startContainer.childNodes[n.startOffset])?n.deleteContents():e.getDoc().execCommand("Delete",!1)},nL=e=>{for(let t=e;t;t=t.walk())if(t.attr("id")==="mce_marker")return m.some(t);return m.none()},sL=(e,t,n)=>{var s;return Ue(n.children(),Oy)&&((s=e.getParent(t,e.isBlock))===null||s===void 0?void 0:s.nodeName)==="SUMMARY"},oL=(e,t,n)=>{var s,o;const r=e.selection,a=e.dom,i=e.parser,l=n.merge,c=Cs({validate:!0},e.schema),u='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';n.preserve_zwsp||(t=Mt(t)),t.indexOf("{$caret}")===-1&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,u);let f=r.getRng();const d=f.startContainer,p=e.getBody();d===p&&r.isCollapsed()&&a.isBlock(p.firstChild)&&JI(e,p.firstChild)&&a.isEmpty(p.firstChild)&&(f=a.createRng(),f.setStart(p.firstChild,0),f.setEnd(p.firstChild,0),r.setRng(f)),r.isCollapsed()||tL(e);const b=r.getNode(),g={context:b.nodeName.toLowerCase(),data:n.data,insert:!0},h=i.parse(t,g);if(n.paste===!0&&TI(e.schema,h)&&$I(a,b))return f=WI(c,a,r.getRng(),h),f&&r.setRng(f),t;n.paste===!0&&jI(a,h,b,e.getBody())&&((s=h.firstChild)===null||s===void 0||s.unwrap()),XI(h);let y=h.lastChild;if(y&&y.attr("id")==="mce_marker"){const E=y;for(y=y.prev;y;y=y.walk(!0))if(y.type===3||!a.isBlock(y.name)){y.parent&&e.schema.isValidChild(y.parent.name,"span")&&y.parent.insert(E,y,y.name==="br");break}}if(e._selectionOverrides.showBlockCaretContainer(b),!g.invalid&&!sL(a,b,h))t=c.serialize(h),KI(e,t,b);else{e.selection.setContent(u);let E=r.getNode(),v;const S=e.getBody();for(Rr(E)?E=v=S:v=E;v&&v!==S;)E=v,v=v.parentNode;t=E===S?S.innerHTML:a.getOuterHTML(E);const R=i.parse(t),O=nL(R),U=O.bind(EI).getOr(R);O.each(V=>V.replace(h));const A=h.children(),x=(o=h.parent)!==null&&o!==void 0?o:R;h.unwrap();const T=oe(A,V=>If(e.schema,V,x));Of(T,e.schema,U),$y(i.getNodeFilters(),i.getAttributeFilters(),R),t=c.serialize(R),E===S?a.setHTML(S,t):a.setOuterHTML(E,t)}return YI(e,l),eL(e,a.get("mce_marker")),ZI(e.getBody()),GI(a,r.getStart(),e.schema),XN(e.schema,e.getBody(),r.getStart()),t},Yi=e=>e instanceof vt,rL=e=>{to(e)&&ht(e.getBody()).each(t=>{const n=t.getNode(),s=Zn(n)?ht(n).getOr(t):t;e.selection.setRng(s.toRange())})},Mf=(e,t,n)=>{e.dom.setHTML(e.getBody(),t),n!==!0&&rL(e)},aL=(e,t,n,s)=>{if(n=Mt(n),n.length===0||/^\s+$/.test(n)){const o='<br data-mce-bogus="1">';t.nodeName==="TABLE"?n="<tr><td>"+o+"</td></tr>":/^(UL|OL)$/.test(t.nodeName)&&(n="<li>"+o+"</li>");const r=pt(e);return e.schema.isValidChild(t.nodeName.toLowerCase(),r.toLowerCase())?(n=o,n=e.dom.createHTML(r,Yr(e),n)):n||(n=o),Mf(e,n,s.no_selection),{content:n,html:n}}else{s.format!=="raw"&&(n=Cs({validate:!1},e.schema).serialize(e.parser.parse(n,{isRootContent:!0,insert:!0})));const o=li(C.fromDom(t))?n:$.trim(n);return Mf(e,o,s.no_selection),{content:o,html:o}}},iL=(e,t,n,s)=>{$y(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),n);const o=Cs({validate:!1},e.schema).serialize(n),r=Mt(li(C.fromDom(t))?o:$.trim(o));return Mf(e,r,s.no_selection),{content:n,html:r}},lL=(e,t,n)=>m.from(e.getBody()).map(s=>Yi(t)?iL(e,s,t,n):aL(e,s,t,n)).getOr({content:t,html:Yi(n.content)?"":n.content}),Uy=e=>ke(e)?e:$e,cL=(e,t,n)=>{let s=e.dom;const o=Uy(n);for(;s.parentNode;){s=s.parentNode;const r=C.fromDom(s),a=t(r);if(a.isSome())return a;if(o(r))break}return m.none()},Uf=(e,t,n)=>{const s=t(e),o=Uy(n);return s.orThunk(()=>o(e)?m.none():cL(e,t,o))},zf=zu,zy=(e,t,n)=>{const s=e.formatter.get(n);if(s)for(let o=0;o<s.length;o++){const r=s[o];if(Kt(r)&&r.inherit===!1&&e.dom.is(t,r.selector))return!0}return!1},Hf=(e,t,n,s,o)=>{const r=e.dom.getRoot();if(t===r)return!1;const a=e.dom.getParent(t,i=>zy(e,i,n)?!0:i.parentNode===r||!!Ln(e,i,n,s,!0));return!!Ln(e,a,n,s,o)},Xi=(e,t,n)=>Qe(n)&&zf(t,n.inline)||In(n)&&zf(t,n.block)?!0:Kt(n)?G(t)&&e.is(t,n.selector):!1,Hy=(e,t,n,s,o,r)=>{const a=n[s],i=s==="attributes";if(ke(n.onmatch))return n.onmatch(t,n,s);if(a){if(sg(a)){for(let l=0;l<a.length;l++)if(i?e.getAttrib(t,a[l]):Bi(e,t,a[l]))return!0}else for(const l in a)if(re(a,l)){const c=i?e.getAttrib(t,l):Bi(e,t,l),u=bs(a[l],r),f=je(c)||Cr(c);if(f&&je(u))continue;if(o&&f&&!n.exact||(!o||n.exact)&&!zf(c,Hu(u,l)))return!1}}return!0},Ln=(e,t,n,s,o)=>{const r=e.formatter.get(n),a=e.dom;if(r&&G(t))for(let i=0;i<r.length;i++){const l=r[i];if(Xi(e.dom,t,l)&&Hy(a,t,l,"attributes",o,s)&&Hy(a,t,l,"styles",o,s)){const c=l.classes;if(c){for(let u=0;u<c.length;u++)if(!e.dom.hasClass(t,bs(c[u],s)))return}return l}}},Wf=(e,t,n,s,o)=>{if(s)return Hf(e,s,t,n,o);if(s=e.selection.getNode(),Hf(e,s,t,n,o))return!0;const r=e.selection.getStart();return!!(r!==s&&Hf(e,r,t,n,o))},uL=(e,t,n)=>{const s=[],o={},r=e.selection.getStart();return e.dom.getParent(r,a=>{for(let i=0;i<t.length;i++){const l=t[i];!o[l]&&Ln(e,a,l,n)&&(o[l]=!0,s.push(l))}},e.dom.getRoot()),s},fL=(e,t)=>{const n=o=>ve(o,C.fromDom(e.getBody())),s=(o,r)=>Ln(e,o.dom,r)?m.some(r):m.none();return m.from(e.selection.getStart(!0)).bind(o=>Uf(C.fromDom(o),r=>yo(t,a=>s(r,a)),n)).getOrNull()},dL=(e,t)=>{const n=e.formatter.get(t),s=e.dom;if(n&&e.selection.isEditable()){const o=e.selection.getStart(),r=Oi(s,o);for(let a=n.length-1;a>=0;a--){const i=n[a];if(!Kt(i))return!0;for(let l=r.length-1;l>=0;l--)if(s.is(r[l],i.selector))return!0}}return!1},mL=(e,t,n)=>Tt(n,(s,o)=>{const r=oD(e,o);return e.formatter.matchNode(t,o,{},r)?s.concat([o]):s},[]),pa=Ze,gL=(e,t)=>e.importNode(t,!0),Wy=e=>{if(e){const t=new Xe(e,e);for(let n=t.current();n;n=t.next())if(B(n))return n}return null},Vf=e=>{const t=C.fromTag("span");return Wn(t,{id:Ru,"data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&Ve(t,C.fromText(pa)),t},pL=e=>{const t=Wy(e);return t&&t.data.charAt(0)===pa&&t.deleteData(0,1),t},jf=(e,t,n)=>{const s=e.dom,o=e.selection;if(Pb(t))no(e,!1,C.fromDom(t),n,!0);else{const r=o.getRng(),a=s.getParent(t,s.isBlock),i=r.startContainer,l=r.startOffset,c=r.endContainer,u=r.endOffset,f=pL(t);s.remove(t,!0),i===f&&l>0&&r.setStart(f,l-1),c===f&&u>0&&r.setEnd(f,u-1),a&&s.isEmpty(a)&&ls(C.fromDom(a)),o.setRng(r)}},qf=(e,t,n)=>{const s=e.dom,o=e.selection;if(t)jf(e,t,n);else if(t=Zs(e.getBody(),o.getStart()),!t)for(;t=s.get(Ru);)jf(e,t,n)},hL=(e,t,n)=>{var s,o;const r=e.dom,a=r.getParent(n,K(Mu,e.schema));a&&r.isEmpty(a)?(s=n.parentNode)===null||s===void 0||s.replaceChild(t,n):(gN(C.fromDom(n)),r.isEmpty(n)?(o=n.parentNode)===null||o===void 0||o.replaceChild(t,n):r.insertAfter(t,n))},Vy=(e,t)=>(e.appendChild(t),t),jy=(e,t)=>{var n;const s=dr(e,(r,a)=>Vy(r,a.cloneNode(!1)),t),o=(n=s.ownerDocument)!==null&&n!==void 0?n:document;return Vy(s,o.createTextNode(pa))},bL=(e,t,n,s,o,r)=>{const a=e.formatter,i=e.dom,l=oe(Pt(a.get()),f=>f!==s&&!dt(f,"removeformat")),c=mL(e,n,l);if(oe(c,f=>!rD(e,f,s)).length>0){const f=n.cloneNode(!1);return i.add(t,f),a.remove(s,o,f,r),i.remove(f),m.some(f)}else return m.none()},CL=(e,t,n)=>{let s;const o=e.selection,r=e.formatter.get(t);if(!r)return;const a=o.getRng();let i=a.startOffset;const c=a.startContainer.nodeValue;s=Zs(e.getBody(),o.getStart());const u=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(c&&i>0&&i<c.length&&u.test(c.charAt(i))&&u.test(c.charAt(i-1))){const f=o.getBookmark();a.collapse(!0);let d=Qs(e.dom,a,r);d=zi(d),e.formatter.apply(t,n,d),o.moveToBookmark(f)}else{let f=s?Wy(s):null;(!s||(f==null?void 0:f.data)!==pa)&&(s=gL(e.getDoc(),Vf(!0).dom),f=s.firstChild,a.insertNode(s),i=1),e.formatter.apply(t,n,s),o.setCursorLocation(f,i)}},yL=(e,t,n,s)=>{const o=e.dom,r=e.selection;let a=!1;const i=e.formatter.get(t);if(!i)return;const l=r.getRng(),c=l.startContainer,u=l.startOffset;let f=c;B(c)&&(u!==c.data.length&&(a=!0),f=f.parentNode);const d=[];let p;for(;f;){if(Ln(e,f,t,n,s)){p=f;break}f.nextSibling&&(a=!0),d.push(f),f=f.parentNode}if(p)if(a){const b=r.getBookmark();l.collapse(!0);let g=Qs(o,l,i,!0);g=zi(g),e.formatter.remove(t,n,g,s),r.moveToBookmark(b)}else{const b=Zs(e.getBody(),p),g=M(b)?o.getParents(p.parentNode,We,b):[],h=Vf(!1).dom;hL(e,h,b??p);const y=bL(e,h,p,t,n,s),E=jy([...d,...y.toArray(),...g],h);b&&jf(e,b,M(b)),r.setCursorLocation(E,1),o.isEmpty(p)&&o.remove(p)}},vL=(e,t,n)=>{const s=e.selection,o=e.getBody();qf(e,null,n),(t===8||t===46)&&s.isCollapsed()&&s.getStart().innerHTML===pa&&qf(e,Zs(o,s.getStart()),!0),(t===37||t===39)&&qf(e,Zs(o,s.getStart()),!0)},EL=e=>B(e)&&bc(e.data,Je),SL=e=>{e.on("mouseup keydown",t=>{vL(e,t.keyCode,EL(e.selection.getRng().endContainer))})},qy=e=>{const t=Vf(!1),n=jy(e,t.dom);return{caretContainer:t,caretPosition:N(n,0)}},Ky=(e,t)=>{const{caretContainer:n,caretPosition:s}=qy(t);return Dt(C.fromDom(e),n),De(C.fromDom(e)),s},wL=(e,t)=>{const{caretContainer:n,caretPosition:s}=qy(t);return e.insertNode(n.dom),s},Gy=(e,t)=>{if(jt(t.dom))return!1;const n=e.schema.getTextInlineElements();return re(n,pe(t))&&!jt(t.dom)&&!Fs(t.dom)},ha={},Yy=gn(["pre"]),kL=(e,t)=>{ha[e]||(ha[e]=[]),ha[e].push(t)},xL=(e,t)=>{re(ha,e)&&P(ha[e],n=>{n(t)})};kL("pre",e=>{const t=e.selection.getRng(),n=o=>r=>{const a=r.previousSibling;return Yy(a)&&Ne(o,a)},s=(o,r)=>{const a=C.fromDom(r),i=qn(a).dom;De(a),Ls(C.fromDom(o),[C.fromTag("br",i),C.fromTag("br",i),...rt(a)])};if(!t.collapsed){const o=e.selection.getSelectedBlocks(),r=oe(oe(o,Yy),n(o));P(r,a=>{s(a.previousSibling,a)})}});const Xy=["fontWeight","fontStyle","color","fontSize","fontFamily"],_L=e=>Ct(e.styles)&&Ue(Pt(e.styles),t=>Ne(Xy,t)),NL=e=>Ye(e,t=>Qe(t)&&t.inline==="span"&&_L(t)),Zy=(e,t)=>{const n=e.get(t);return Ge(n)?NL(n):m.none()},Qy=(e,t)=>Bt(t,N.fromRangeStart(e)).isNone(),Jy=(e,t)=>_t(t,N.fromRangeEnd(e)).exists(n=>!Me(n.getNode())||_t(t,n).isSome())===!1,ev=e=>t=>tN(t)&&e.isEditable(t),AL=e=>{const t=e.getSelectedBlocks(),n=e.getRng();if(e.isCollapsed())return[];if(t.length===1)return Qy(n,t[0])&&Jy(n,t[0])?t:[];{const s=Rt(t).filter(a=>Qy(n,a)).toArray(),o=As(t).filter(a=>Jy(n,a)).toArray(),r=t.slice(1,-1);return s.concat(r).concat(o)}},TL=e=>oe(AL(e),ev(e.dom)),tv=e=>oe(e.getSelectedBlocks(),ev(e.dom)),Kf=$.each,Gf=e=>G(e)&&!qt(e)&&!jt(e)&&!Fs(e),nv=(e,t)=>{for(let n=e;n;n=n[t]){if(B(n)&&xn(n.data))return e;if(G(n)&&!qt(n))return n}return e},sv=(e,t,n)=>{const s=Pf(e),o=Xn(t)&&e.dom.isEditable(t),r=Xn(n)&&e.dom.isEditable(n);if(o&&r){const a=nv(t,"previousSibling"),i=nv(n,"nextSibling");if(s.compare(a,i)){for(let l=a.nextSibling;l&&l!==i;){const c=l;l=l.nextSibling,a.appendChild(c)}return e.dom.remove(i),$.each($.grep(i.childNodes),l=>{a.appendChild(l)}),a}}return n},ov=(e,t,n,s)=>{var o;if(s&&t.merge_siblings!==!1){const r=(o=sv(e,Ab(s),s))!==null&&o!==void 0?o:s;sv(e,r,Ab(r,!0))}},RL=(e,t,n)=>{if(t.clear_child_styles){const s=t.links?"*:not(a)":"*";Kf(e.select(s,n),o=>{Gf(o)&&e.isEditable(o)&&Kf(t.styles,(r,a)=>{e.setStyle(o,a,"")})})}},Yf=(e,t,n)=>{Kf(e.childNodes,s=>{Gf(s)&&(t(s)&&n(s),s.hasChildNodes()&&Yf(s,t,n))})},PL=(e,t)=>{t.nodeName==="SPAN"&&e.getAttribs(t).length===0&&e.remove(t,!0)},rv=(e,t)=>n=>!!(n&&Bi(e,n,t)),av=(e,t,n)=>s=>{e.setStyle(s,t,n),s.getAttribute("style")===""&&s.removeAttribute("style"),PL(e,s)},ro=Pn.generate([{keep:[]},{rename:["name"]},{removed:[]}]),DL=/^(src|href|style)$/,Xf=$.each,Zi=zu,BL=e=>/^(TR|TH|TD)$/.test(e.nodeName),iv=(e,t,n)=>e.isChildOf(t,n)&&t!==n&&!e.isBlock(n),lv=(e,t,n)=>{let s=t[n?"startContainer":"endContainer"],o=t[n?"startOffset":"endOffset"];if(G(s)){const r=s.childNodes.length-1;!n&&o&&o--,s=s.childNodes[o>r?r:o]}return B(s)&&n&&o>=s.data.length&&(s=new Xe(s,e.getBody()).next()||s),B(s)&&!n&&o===0&&(s=new Xe(s,e.getBody()).prev()||s),s},cv=(e,t)=>{const n=t?"firstChild":"lastChild",s=e[n];return BL(e)&&s?e.nodeName==="TR"&&s[n]||s:e},Zf=(e,t,n,s)=>{var o;const r=e.create(n,s);return(o=t.parentNode)===null||o===void 0||o.insertBefore(r,t),r.appendChild(t),r},uv=(e,t,n,s,o)=>{const r=C.fromDom(t),a=C.fromDom(e.create(s,o)),i=n?Yg(r):Gg(r);return Ls(a,i),n?(Dt(r,a),Tc(a,r)):(Gn(r,a),Ve(a,r)),a.dom},OL=(e,t)=>t.links&&e.nodeName==="A",fv=(e,t,n)=>{const s=t.parentNode;let o;const r=e.dom,a=pt(e);In(n)&&s===r.getRoot()&&(!n.list_block||!Zi(t,n.list_block))&&P(Lt(t.childNodes),i=>{Ho(e,a,i.nodeName.toLowerCase())?o?o.appendChild(i):(o=Zf(r,i,a),r.setAttribs(o,Yr(e))):o=null}),!(lD(n)&&!Zi(n.inline,t))&&r.remove(t,!0)},dv=(e,t,n)=>dn(e)?{name:t,value:null}:{name:e,value:bs(t,n)},mv=(e,t)=>{e.getAttrib(t,"style")===""&&(t.removeAttribute("style"),t.removeAttribute("data-mce-style"))},gv=(e,t,n,s,o)=>{let r=!1;Xf(n.styles,(a,i)=>{const{name:l,value:c}=dv(i,a,s),u=Hu(c,l);(n.remove_similar||wt(c)||!G(o)||Zi(Bi(e,o,l),u))&&e.setStyle(t,l,""),r=!0}),r&&mv(e,t)},IL=(e,t,n)=>{t==="removeformat"?P(tv(e.selection),s=>{P(Xy,o=>e.dom.setStyle(s,o,"")),mv(e.dom,s)}):Zy(e.formatter,t).each(s=>{P(tv(e.selection),o=>gv(e.dom,o,s,n,null))})},pv=(e,t,n,s,o)=>{const r=e.dom,a=Pf(e),i=e.schema;if(Qe(t)&&Kc(i,t.inline)&&zs(i,s)&&s.parentElement===e.getBody())return fv(e,s,t),ro.removed();if(!t.ceFalseOverride&&s&&r.getContentEditableParent(s)==="false"||s&&!Xi(r,s,t)&&!OL(s,t))return ro.keep();const l=s,c=t.preserve_attributes;if(Qe(t)&&t.remove==="all"&&Ge(c)){const u=oe(r.getAttribs(l),f=>Ne(c,f.name.toLowerCase()));if(r.removeAllAttribs(l),P(u,f=>r.setAttrib(l,f.name,f.value)),u.length>0)return ro.rename("span")}if(t.remove!=="all"){gv(r,l,t,n,o),Xf(t.attributes,(f,d)=>{const{name:p,value:b}=dv(d,f,n);if(t.remove_similar||wt(b)||!G(o)||Zi(r.getAttrib(o,p),b)){if(p==="class"){const g=r.getAttrib(l,p);if(g){let h="";if(P(g.split(/\s+/),y=>{/mce\-\w+/.test(y)&&(h+=(h?" ":"")+y)}),h){r.setAttrib(l,p,h);return}}}if(DL.test(p)&&l.removeAttribute("data-mce-"+p),p==="style"&&gn(["li"])(l)&&r.getStyle(l,"list-style-type")==="none"){l.removeAttribute(p),r.setStyle(l,"list-style-type","none");return}p==="class"&&l.removeAttribute("className"),l.removeAttribute(p)}}),Xf(t.classes,f=>{f=bs(f,n),(!G(o)||r.hasClass(o,f))&&r.removeClass(l,f)});const u=r.getAttribs(l);for(let f=0;f<u.length;f++){const d=u[f].nodeName;if(!a.isAttributeInternal(d))return ro.keep()}}return t.remove!=="none"?(fv(e,l,t),ro.removed()):ro.keep()},LL=(e,t,n,s,o)=>{let r;return t.parentNode&&P(Oi(e.dom,t.parentNode).reverse(),a=>{if(!r&&G(a)&&a.id!=="_start"&&a.id!=="_end"){const i=Ln(e,a,n,s,o);i&&i.split!==!1&&(r=a)}}),r},$L=(e,t,n,s)=>pv(e,t,n,s,s).fold(z(s),o=>(e.dom.createFragment().appendChild(s),e.dom.rename(s,o)),z(null)),FL=(e,t,n,s,o,r,a,i)=>{var l,c;let u,f;const d=e.dom;if(n){const p=n.parentNode;for(let b=s.parentNode;b&&b!==p;b=b.parentNode){let g=d.clone(b,!1);for(let h=0;h<t.length&&(g=$L(e,t[h],i,g),g!==null);h++);g&&(u&&g.appendChild(u),f||(f=g),u=g)}r&&(!a.mixed||!d.isBlock(n))&&(s=(l=d.split(n,s))!==null&&l!==void 0?l:s),u&&f&&((c=o.parentNode)===null||c===void 0||c.insertBefore(u,o),f.appendChild(o),Qe(a)&&ov(e,a,i,u))}return s},ML=(e,t,n,s,o)=>{const r=e.formatter.get(t),a=r[0],i=e.dom,l=e.selection,c=g=>{const h=LL(e,g,t,n,o);return FL(e,r,h,g,g,!0,a,n)},u=g=>qt(g)&&G(g)&&(g.id==="_start"||g.id==="_end"),f=g=>Ue(r,h=>ba(e,h,n,g,g)),d=g=>{const h=Lt(g.childNodes),E=f(g)||Ue(r,R=>Xi(i,g,R)),v=g.parentNode;if(!E&&M(v)&&Vu(a)&&f(v),a.deep&&h.length)for(let R=0;R<h.length;R++)d(h[R]);P(["underline","line-through","overline"],R=>{G(g)&&e.dom.getStyle(g,"text-decoration")===R&&g.parentNode&&Rb(i,g.parentNode)===R&&ba(e,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:R}},void 0,g)})},p=g=>{const h=i.get(g?"_start":"_end");if(h){let y=h[g?"firstChild":"lastChild"];return u(y)&&(y=y[g?"firstChild":"lastChild"]),B(y)&&y.data.length===0&&(y=g?h.previousSibling||h.nextSibling:h.nextSibling||h.previousSibling),i.remove(h,!0),y}else return null},b=g=>{let h,y,E=Qs(i,g,r,g.collapsed);if(a.split){if(E=zi(E),h=lv(e,E,!0),y=lv(e,E),h!==y){if(h=cv(h,!0),y=cv(y,!1),iv(i,h,y)){const S=m.from(h.firstChild).getOr(h);c(uv(i,S,!0,"span",{id:"_start","data-mce-type":"bookmark"})),p(!0);return}if(iv(i,y,h)){const S=m.from(y.lastChild).getOr(y);c(uv(i,S,!1,"span",{id:"_end","data-mce-type":"bookmark"})),p(!1);return}h=Zf(i,h,"span",{id:"_start","data-mce-type":"bookmark"}),y=Zf(i,y,"span",{id:"_end","data-mce-type":"bookmark"});const v=i.createRng();v.setStartAfter(h),v.setEndBefore(y),ra(i,v,S=>{P(S,R=>{!qt(R)&&!qt(R.parentNode)&&c(R)})}),c(h),c(y),h=p(!0),y=p()}else h=y=c(h);E.startContainer=h.parentNode?h.parentNode:h,E.startOffset=i.nodeIndex(h),E.endContainer=y.parentNode?y.parentNode:y,E.endOffset=i.nodeIndex(y)+1}ra(i,E,v=>{P(v,d)})};if(s){if(oa(s)){const g=i.createRng();g.setStartBefore(s),g.setEndAfter(s),b(g)}else b(s);Kb(e,t,s,n);return}!l.isCollapsed()||!Qe(a)||zo(e).length?(Nb(e,()=>$u(e,b),g=>Qe(a)&&Wf(e,t,n,g)),e.nodeChanged()):yL(e,t,n,o),IL(e,t,n),Kb(e,t,s,n)},hv=(e,t,n,s,o)=>{(s||e.selection.isEditable())&&ML(e,t,n,s,o)},ba=(e,t,n,s,o)=>pv(e,t,n,s,o).fold($e,r=>(e.dom.rename(s,r),!0),We),bv=$.each,UL=(e,t,n,s)=>{const o=r=>{if(Xn(r)&&G(r.parentNode)&&e.isEditable(r)){const a=Rb(e,r.parentNode);e.getStyle(r,"color")&&a?e.setStyle(r,"text-decoration",a):e.getStyle(r,"text-decoration")===a&&e.setStyle(r,"text-decoration",null)}};t.styles&&(t.styles.color||t.styles.textDecoration)&&($.walk(s,o,"childNodes"),o(s))},zL=(e,t,n,s)=>{if(t.styles&&t.styles.backgroundColor){const o=rv(e,"fontSize");Yf(s,r=>o(r)&&e.isEditable(r),av(e,"backgroundColor",bs(t.styles.backgroundColor,n)))}},HL=(e,t,n,s)=>{if(Qe(t)&&(t.inline==="sub"||t.inline==="sup")){const o=rv(e,"fontSize");Yf(s,a=>o(a)&&e.isEditable(a),av(e,"fontSize",""));const r=oe(e.select(t.inline==="sup"?"sub":"sup",s),e.isEditable);e.remove(r,!0)}},WL=(e,t,n,s)=>{bv(t,o=>{Qe(o)&&bv(e.dom.select(o.inline,s),r=>{Gf(r)&&ba(e,o,n,r,o.exact?r:null)}),RL(e.dom,o,s)})},VL=(e,t,n,s,o)=>{const r=o.parentNode;Ln(e,r,n,s)&&ba(e,t,s,o)||t.merge_with_parents&&r&&e.dom.getParent(r,a=>Ln(e,a,n,s)?(ba(e,t,s,o),!0):!1)},Qi=$.each,jL=(e,t,n,s)=>{if(pR(e)&&Qe(t)&&n.parentNode){const o=zp(e.schema),r=LO(C.fromDom(n),a=>jt(a.dom));return vo(o,s)&&ze(C.fromDom(n.parentNode),!1)&&!r}else return!1},Cv=(e,t,n,s)=>{if(Qi(n.styles,(o,r)=>{e.setStyle(t,r,bs(o,s))}),n.styles){const o=e.getAttrib(t,"style");o&&e.setAttrib(t,"data-mce-style",o)}},qL=(e,t,n,s)=>{const o=e.formatter.get(t),r=o[0],a=!s&&e.selection.isCollapsed(),i=e.dom,l=e.selection,c=(b,g=r)=>{ke(g.onformat)&&g.onformat(b,g,n,s),Cv(i,b,g,n),Qi(g.attributes,(h,y)=>{i.setAttrib(b,y,bs(h,n))}),Qi(g.classes,h=>{const y=bs(h,n);i.hasClass(b,y)||i.addClass(b,y)})},u=(b,g)=>{let h=!1;return Qi(b,y=>Kt(y)?i.getContentEditable(g)==="false"&&!y.ceFalseOverride||M(y.collapsed)&&y.collapsed!==a?!0:i.is(g,y.selector)&&!jt(g)?(c(g,y),h=!0,!1):!0:!1),h},f=b=>{if(Q(b)){const g=i.create(b);return c(g),g}else return null},d=(b,g,h)=>{const y=[];let E=!0;const v=r.inline||r.block,S=f(v),R=A=>aD(r)&&Ln(e,A,t,n),O=(A,x,T)=>{const V=iD(r)&&Mu(e.schema,A)&&Ho(e,x,v);return T&&V},U=(A,x,T,V)=>{const Z=A.nodeName.toLowerCase(),ae=Ho(e,v,Z)&&Ho(e,x,v),ie=!h&&B(A)&&ci(A.data),Ce=jt(A),xe=!Qe(r)||!b.isBlock(A);return(T||V)&&ae&&!ie&&!Ce&&xe};ra(b,g,A=>{let x;const T=V=>{let Z=!1,ae=E,ie=!1;const Ce=V.parentNode,xe=Ce.nodeName.toLowerCase(),Ie=b.getContentEditable(V);M(Ie)&&(ae=E,E=Ie==="true",Z=!0,ie=Tb(e,V));const nt=E&&!Z;if(Me(V)&&!jL(e,r,V,xe)){x=null,In(r)&&b.remove(V);return}if(R(V)){x=null;return}if(O(V,xe,nt)){const ye=b.rename(V,v);c(ye),y.push(ye),x=null;return}if(Kt(r)){let ye=u(o,V);if(!ye&&M(Ce)&&Vu(r)&&(ye=u(o,Ce)),!Qe(r)||ye){x=null;return}}M(S)&&U(V,xe,nt,ie)?(x||(x=b.clone(S,!1),Ce.insertBefore(x,V),y.push(x)),ie&&Z&&(E=ae),x.appendChild(V)):(x=null,P(Lt(V.childNodes),T),Z&&(E=ae),x=null)};P(A,T)}),r.links===!0&&P(y,A=>{const x=T=>{T.nodeName==="A"&&c(T,r),P(Lt(T.childNodes),x)};x(A)}),P(y,A=>{const x=Z=>{let ae=0;return P(Z.childNodes,ie=>{!nD(ie)&&!qt(ie)&&ae++}),ae},T=Z=>Ye(Z.childNodes,Fu).filter(ie=>b.getContentEditable(ie)!=="false"&&Xi(b,ie,r)).map(ie=>{const Ce=b.clone(ie,!1);return c(Ce),b.replace(Ce,Z,!0),b.remove(ie,!0),Ce}).getOr(Z),V=x(A);if((y.length>1||!b.isBlock(A))&&V===0){b.remove(A,!0);return}(Qe(r)||In(r)&&r.wrapper)&&(!r.exact&&V===1&&(A=T(A)),WL(e,o,n,A),VL(e,r,t,n,A),zL(b,r,n,A),UL(b,r,n,A),HL(b,r,n,A),ov(e,r,n,A))})},p=oa(s)?s:l.getNode();if(i.getContentEditable(p)==="false"&&!Tb(e,p)){s=p,u(o,s),qb(e,t,s,n);return}if(r){if(s)if(oa(s)){if(!u(o,s)){const b=i.createRng();b.setStartBefore(s),b.setEndAfter(s),d(i,Qs(i,b,o),!0)}}else d(i,s,!0);else!a||!Qe(r)||zo(e).length?(l.setRng(Lf(l.getRng())),Nb(e,()=>{$u(e,(b,g)=>{const h=g?b:Qs(i,b,o);d(i,h,!1)})},We),e.nodeChanged()):CL(e,t,n),Zy(e.formatter,t).each(b=>{P(TL(e.selection),g=>Cv(i,g,b,n))});xL(t,e)}qb(e,t,s,n)},yv=(e,t,n,s)=>{(s||e.selection.isEditable())&&qL(e,t,n,s)},vv=e=>re(e,"vars"),KL=(e,t)=>{e.set({}),t.on("NodeChange",n=>{kv(t,n.element,e.get())}),t.on("FormatApply FormatRemove",n=>{const s=m.from(n.node).map(o=>oa(o)?o:o.startContainer).bind(o=>G(o)?m.some(o):m.from(o.parentElement)).getOrThunk(()=>Ev(t));kv(t,s,e.get())})},Ev=e=>e.selection.getStart(),Sv=(e,t,n,s,o)=>Jm(t,i=>{const l=e.formatter.matchNode(i,n,o??{},s);return!lt(l)},i=>zy(e,i,n)?!0:s?!1:M(e.formatter.matchNode(i,n,o,!0))),wv=(e,t)=>{const n=t??Ev(e);return oe(Oi(e.dom,n),s=>G(s)&&!Fs(s))},kv=(e,t,n)=>{const s=wv(e,t);Te(n,(o,r)=>{const a=i=>{const l=Sv(e,s,r,i.similar,vv(i)?i.vars:void 0),c=l.isSome();if(i.state.get()!==c){i.state.set(c);const u=l.getOr(t);vv(i)?i.callback(c,{node:u,format:r,parents:s}):P(i.callbacks,f=>f(c,{node:u,format:r,parents:s}))}};P([o.withSimilar,o.withoutSimilar],a),P(o.withVars,a)})},GL=(e,t,n,s,o,r)=>{const a=t.get();P(n.split(","),i=>{const l=Pe(a,i).getOrThunk(()=>{const u={withSimilar:{state:et(!1),similar:!0,callbacks:[]},withoutSimilar:{state:et(!1),similar:!1,callbacks:[]},withVars:[]};return a[i]=u,u}),c=()=>{const u=wv(e);return Sv(e,u,i,o,r).isSome()};if(lt(r)){const u=o?l.withSimilar:l.withoutSimilar;u.callbacks.push(s),u.callbacks.length===1&&u.state.set(c())}else l.withVars.push({state:et(c()),similar:o,vars:r,callback:s})}),t.set(a)},YL=(e,t,n)=>{const s=e.get();P(t.split(","),o=>Pe(s,o).each(r=>{s[o]={withSimilar:{...r.withSimilar,callbacks:oe(r.withSimilar.callbacks,a=>a!==n)},withoutSimilar:{...r.withoutSimilar,callbacks:oe(r.withoutSimilar.callbacks,a=>a!==n)},withVars:oe(r.withVars,a=>a.callback!==n)}})),e.set(s)},XL=(e,t,n,s,o,r)=>(GL(e,t,n,s,o,r),{unbind:()=>YL(t,n,s)}),ZL=(e,t,n,s)=>{const o=e.formatter.get(t);o&&(Wf(e,t,n,s)&&(!("toggle"in o[0])||o[0].toggle)?hv(e,t,n,s):yv(e,t,n,s))},xv=$.explode,_v=()=>{const e={};return{addFilter:(o,r)=>{P(xv(o),a=>{re(e,a)||(e[a]={name:a,callbacks:[]}),e[a].callbacks.push(r)})},getFilters:()=>mc(e),removeFilter:(o,r)=>{P(xv(o),a=>{if(re(e,a))if(M(r)){const i=e[a],l=oe(i.callbacks,c=>c!==r);l.length>0?i.callbacks=l:delete e[a]}else delete e[a]})}}},QL=(e,t)=>{P(t,n=>{e.attr(n,null)})},JL=(e,t,n)=>{e.addNodeFilter("font",s=>{P(s,o=>{const r=t.parse(o.attr("style")),a=o.attr("color"),i=o.attr("face"),l=o.attr("size");a&&(r.color=a),i&&(r["font-family"]=i),l&&Ya(l).each(c=>{r["font-size"]=n[c-1]}),o.name="span",o.attr("style",t.serialize(r)),QL(o,["color","face","size"])})})},e$=(e,t,n)=>{e.addNodeFilter("strike",s=>{const o=t.type!=="html4";P(s,r=>{if(o)r.name="s";else{const a=n.parse(r.attr("style"));a["text-decoration"]="line-through",r.name="span",r.attr("style",n.serialize(a))}})})},t$=(e,t,n)=>{var s;const o=nu();t.convert_fonts_to_spans&&JL(e,o,$.explode((s=t.font_size_legacy_values)!==null&&s!==void 0?s:"")),e$(e,n,o)},n$=(e,t,n)=>{t.inline_styles&&t$(e,t,n)},Nv=(e,t,n)=>{t.addNodeFilter("br",(s,o,r)=>{const a=$.extend({},n.getBlockElements()),i=n.getNonEmptyElements(),l=n.getWhitespaceElements();a.body=1;const c=u=>u.name in a||Yc(n,u);for(let u=0,f=s.length;u<f;u++){let d=s[u],p=d.parent;if(p&&c(p)&&d===p.lastChild){let b=d.prev;for(;b;){const g=b.name;if(g!=="span"||b.attr("data-mce-type")!=="bookmark"){g==="br"&&(d=null);break}b=b.prev}if(d&&(d.remove(),ga(n,i,l,p))){const g=n.getElementRule(p.name);g&&(g.removeEmpty?p.remove():g.paddEmpty&&Df(e,r,c,p))}}else{let b=d;for(;p&&p.firstChild===b&&p.lastChild===b&&(b=p,!a[p.name]);)p=p.parent;if(b===p){const g=new vt("#text",3);g.value=Je,d.replace(g)}}}})},s$=e=>fetch(e).then(t=>t.ok?t.blob():Promise.reject()).catch(()=>Promise.reject({message:`Cannot convert ${e} to Blob. Resource might not exist or is inaccessible.`,uriType:"blob"})),o$=e=>{const t=/([a-z0-9+\/=\s]+)/i.exec(e);return t?t[1]:""},Qf=e=>{const[t,...n]=e.split(","),s=n.join(","),o=/data:([^/]+\/[^;]+)(;.+)?/.exec(t);if(o){const r=o[2]===";base64",a=r?o$(s):decodeURIComponent(s);return m.some({type:o[1],data:a,base64Encoded:r})}else return m.none()},Av=(e,t,n=!0)=>{let s=t;if(n)try{s=atob(t)}catch{return m.none()}const o=new Uint8Array(s.length);for(let r=0;r<o.length;r++)o[r]=s.charCodeAt(r);return m.some(new Blob([o],{type:e}))},r$=e=>new Promise((t,n)=>{Qf(e).bind(({type:s,data:o,base64Encoded:r})=>Av(s,o,r)).fold(()=>n("Invalid data URI"),t)}),a$=e=>ct(e,"blob:")?s$(e):ct(e,"data:")?r$(e):Promise.reject("Unknown URI format"),Tv=e=>new Promise((t,n)=>{const s=new FileReader;s.onloadend=()=>{t(s.result)},s.onerror=()=>{var o;n((o=s.error)===null||o===void 0?void 0:o.message)},s.readAsDataURL(e)});let i$=0;const l$=e=>(e||"blobid")+i$++,Rv=(e,t,n)=>Qf(e).bind(({data:s,type:o,base64Encoded:r})=>{if(t&&!r)return m.none();{const a=r?s:btoa(s);return n(a,o)}}),Pv=(e,t,n)=>{const s=e.create(l$(),t,n);return e.add(s),s},Dv=(e,t,n=!1)=>Rv(t,n,(s,o)=>m.from(e.getByData(s,o)).orThunk(()=>Av(o,s).map(r=>Pv(e,r,s)))),c$=(e,t)=>{const n=()=>Promise.reject("Invalid data URI");if(ct(t,"blob:")){const s=e.getByUri(t);return M(s)?Promise.resolve(s):a$(t).then(o=>Tv(o).then(r=>Rv(r,!1,a=>m.some(Pv(e,o,a))).getOrThunk(n)))}else return ct(t,"data:")?Dv(e,t).fold(n,s=>Promise.resolve(s)):Promise.reject("Unknown image data format")},u$=e=>M(e.attr("data-mce-bogus")),f$=e=>e.attr("src")===be.transparentSrc||M(e.attr("data-mce-placeholder")),d$=(e,t)=>{const{blob_cache:n}=t;if(n){const s=o=>{const r=o.attr("src");f$(o)||u$(o)||je(r)||Dv(n,r,!0).each(a=>{o.attr("src",a.blobUri())})};e.addAttributeFilter("src",o=>P(o,s))}},Jf=(e,t)=>ct(e,`${t}/`),m$=(e,t,n,s,o)=>{let r;lt(e)?r="iframe":Jf(e,"image")?r="img":Jf(e,"video")?r="video":Jf(e,"audio")?r="audio":r="iframe";const a=new vt(r,1);return a.attr(r==="audio"?{src:t}:{src:t,width:n,height:s}),(r==="audio"||r==="video")&&a.attr("controls",""),r==="iframe"&&o&&a.attr("sandbox",""),a},g$=(e,t)=>{const n=e.schema;t.remove_trailing_brs&&Nv(t,e,n),e.addAttributeFilter("href",o=>{let r=o.length;const a=l=>l.split(" ").filter(u=>u.length>0).concat(["noopener"]).sort().join(" "),i=l=>{const c=l?$.trim(l):"";return/\b(noopener)\b/g.test(c)?c:a(c)};if(!t.allow_unsafe_link_target)for(;r--;){const l=o[r];l.name==="a"&&l.attr("target")==="_blank"&&l.attr("rel",i(l.attr("rel")))}}),t.allow_html_in_named_anchor||e.addAttributeFilter("id,name",o=>{let r=o.length,a,i,l,c;for(;r--;)if(c=o[r],c.name==="a"&&c.firstChild&&!c.attr("href"))for(l=c.parent,a=c.lastChild;a&&l;)i=a.prev,l.insert(a,c),a=i}),t.fix_list_elements&&e.addNodeFilter("ul,ol",o=>{let r=o.length,a,i;for(;r--;)if(a=o[r],i=a.parent,i&&(i.name==="ul"||i.name==="ol"))if(a.prev&&a.prev.name==="li")a.prev.append(a);else{const l=new vt("li",1);l.attr("style","list-style-type: none"),a.wrap(l)}});const s=n.getValidClasses();t.validate&&s&&e.addAttributeFilter("class",o=>{var r;let a=o.length;for(;a--;){const i=o[a],l=(r=i.attr("class"))!==null&&r!==void 0?r:"",c=$.explode(l," ");let u="";for(let f=0;f<c.length;f++){const d=c[f];let p=!1,b=s["*"];b&&b[d]&&(p=!0),b=s[i.name],!p&&b&&b[d]&&(p=!0),p&&(u&&(u+=" "),u+=d)}u.length||(u=null),i.attr("class",u)}}),d$(e,t),t.convert_unsafe_embeds&&e.addNodeFilter("object,embed",o=>P(o,r=>{r.replace(m$(r.attr("type"),r.name==="object"?r.attr("data"):r.attr("src"),r.attr("width"),r.attr("height"),t.sandbox_iframes))})),t.sandbox_iframes&&e.addNodeFilter("iframe",o=>P(o,r=>r.attr("sandbox","")))},{entries:Bv,setPrototypeOf:Ov,isFrozen:p$,getPrototypeOf:h$,getOwnPropertyDescriptor:b$}=Object;let{freeze:Ot,seal:Cn,create:C$}=Object,{apply:ed,construct:td}=typeof Reflect<"u"&&Reflect;ed||(ed=function(t,n,s){return t.apply(n,s)}),Ot||(Ot=function(t){return t}),Cn||(Cn=function(t){return t}),td||(td=function(t,n){return new t(...n)});const y$=rn(Array.prototype.forEach),v$=rn(Array.prototype.pop),Ca=rn(Array.prototype.push),Ji=rn(String.prototype.toLowerCase),nd=rn(String.prototype.toString),E$=rn(String.prototype.match),yn=rn(String.prototype.replace),S$=rn(String.prototype.indexOf),w$=rn(String.prototype.trim),Xt=rn(RegExp.prototype.test),ya=k$(TypeError);function rn(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return ed(e,t,s)}}function k$(e){return function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return td(e,n)}}function Ee(e,t,n){var s;n=(s=n)!==null&&s!==void 0?s:Ji,Ov&&Ov(e,null);let o=t.length;for(;o--;){let r=t[o];if(typeof r=="string"){const a=n(r);a!==r&&(p$(t)||(t[o]=a),r=a)}e[r]=!0}return e}function qo(e){const t=C$(null);for(const[n,s]of Bv(e))t[n]=s;return t}function el(e,t){for(;e!==null;){const s=b$(e,t);if(s){if(s.get)return rn(s.get);if(typeof s.value=="function")return rn(s.value)}e=h$(e)}function n(s){return console.warn("fallback value for",s),null}return n}const Iv=Ot(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),sd=Ot(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),od=Ot(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),x$=Ot(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),rd=Ot(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),_$=Ot(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Lv=Ot(["#text"]),$v=Ot(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),ad=Ot(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Fv=Ot(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),tl=Ot(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),N$=Cn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),A$=Cn(/<%[\w\W]*|[\w\W]*%>/gm),T$=Cn(/\${[\w\W]*}/gm),R$=Cn(/^data-[\-\w.\u00B7-\uFFFF]/),P$=Cn(/^aria-[\-\w]+$/),Mv=Cn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),D$=Cn(/^(?:\w+script|data):/i),B$=Cn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Uv=Cn(/^html$/i);var zv=Object.freeze({__proto__:null,MUSTACHE_EXPR:N$,ERB_EXPR:A$,TMPLIT_EXPR:T$,DATA_ATTR:R$,ARIA_ATTR:P$,IS_ALLOWED_URI:Mv,IS_SCRIPT_OR_DATA:D$,ATTR_WHITESPACE:B$,DOCTYPE_NAME:Uv});const O$=()=>typeof window>"u"?null:window,I$=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let s=null;const o="data-tt-policy-suffix";n&&n.hasAttribute(o)&&(s=n.getAttribute(o));const r="dompurify"+(s?"#"+s:"");try{return t.createPolicy(r,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function Hv(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:O$();const t=le=>Hv(le);if(t.version="3.0.5",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;const n=e.document,s=n.currentScript;let{document:o}=e;const{DocumentFragment:r,HTMLTemplateElement:a,Node:i,Element:l,NodeFilter:c,NamedNodeMap:u=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:f,DOMParser:d,trustedTypes:p}=e,b=l.prototype,g=el(b,"cloneNode"),h=el(b,"nextSibling"),y=el(b,"childNodes"),E=el(b,"parentNode");if(typeof a=="function"){const le=o.createElement("template");le.content&&le.content.ownerDocument&&(o=le.content.ownerDocument)}let v,S="";const{implementation:R,createNodeIterator:O,createDocumentFragment:U,getElementsByTagName:A}=o,{importNode:x}=n;let T={};t.isSupported=typeof Bv=="function"&&typeof E=="function"&&R&&R.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:V,ERB_EXPR:Z,TMPLIT_EXPR:ae,DATA_ATTR:ie,ARIA_ATTR:Ce,IS_SCRIPT_OR_DATA:xe,ATTR_WHITESPACE:Ie}=zv;let{IS_ALLOWED_URI:nt}=zv,ye=null;const F=Ee({},[...Iv,...sd,...od,...rd,...Lv]);let Y=null;const me=Ee({},[...$v,...ad,...Fv,...tl]);let ue=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),j=null,ee=null,I=!0,te=!0,de=!1,we=!0,Se=!1,qe=!1,ln=!1,Un=!1,St=!1,Jt=!1,se=!1,ge=!0,_e=!1;const Le="user-content-";let Re=!0,At=!1,Sn={},xs=null;const Ql=Ee({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Jl=null;const ec=Ee({},["audio","video","img","source","image","track"]);let ar=null;const tc=Ee({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ir="http://www.w3.org/1998/Math/MathML",go="http://www.w3.org/2000/svg",wn="http://www.w3.org/1999/xhtml";let zn=wn,Ua=!1,lr=null;const nc=Ee({},[ir,go,wn],nd);let ss;const Fm=["application/xhtml+xml","text/html"],sc="text/html";let ft,po=null;const rx=o.createElement("form"),Mm=function(_){return _ instanceof RegExp||_ instanceof Function},oc=function(_){if(!(po&&po===_)){if((!_||typeof _!="object")&&(_={}),_=qo(_),ss=Fm.indexOf(_.PARSER_MEDIA_TYPE)===-1?ss=sc:ss=_.PARSER_MEDIA_TYPE,ft=ss==="application/xhtml+xml"?nd:Ji,ye="ALLOWED_TAGS"in _?Ee({},_.ALLOWED_TAGS,ft):F,Y="ALLOWED_ATTR"in _?Ee({},_.ALLOWED_ATTR,ft):me,lr="ALLOWED_NAMESPACES"in _?Ee({},_.ALLOWED_NAMESPACES,nd):nc,ar="ADD_URI_SAFE_ATTR"in _?Ee(qo(tc),_.ADD_URI_SAFE_ATTR,ft):tc,Jl="ADD_DATA_URI_TAGS"in _?Ee(qo(ec),_.ADD_DATA_URI_TAGS,ft):ec,xs="FORBID_CONTENTS"in _?Ee({},_.FORBID_CONTENTS,ft):Ql,j="FORBID_TAGS"in _?Ee({},_.FORBID_TAGS,ft):{},ee="FORBID_ATTR"in _?Ee({},_.FORBID_ATTR,ft):{},Sn="USE_PROFILES"in _?_.USE_PROFILES:!1,I=_.ALLOW_ARIA_ATTR!==!1,te=_.ALLOW_DATA_ATTR!==!1,de=_.ALLOW_UNKNOWN_PROTOCOLS||!1,we=_.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Se=_.SAFE_FOR_TEMPLATES||!1,qe=_.WHOLE_DOCUMENT||!1,St=_.RETURN_DOM||!1,Jt=_.RETURN_DOM_FRAGMENT||!1,se=_.RETURN_TRUSTED_TYPE||!1,Un=_.FORCE_BODY||!1,ge=_.SANITIZE_DOM!==!1,_e=_.SANITIZE_NAMED_PROPS||!1,Re=_.KEEP_CONTENT!==!1,At=_.IN_PLACE||!1,nt=_.ALLOWED_URI_REGEXP||Mv,zn=_.NAMESPACE||wn,ue=_.CUSTOM_ELEMENT_HANDLING||{},_.CUSTOM_ELEMENT_HANDLING&&Mm(_.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ue.tagNameCheck=_.CUSTOM_ELEMENT_HANDLING.tagNameCheck),_.CUSTOM_ELEMENT_HANDLING&&Mm(_.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ue.attributeNameCheck=_.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),_.CUSTOM_ELEMENT_HANDLING&&typeof _.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ue.allowCustomizedBuiltInElements=_.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Se&&(te=!1),Jt&&(St=!0),Sn&&(ye=Ee({},[...Lv]),Y=[],Sn.html===!0&&(Ee(ye,Iv),Ee(Y,$v)),Sn.svg===!0&&(Ee(ye,sd),Ee(Y,ad),Ee(Y,tl)),Sn.svgFilters===!0&&(Ee(ye,od),Ee(Y,ad),Ee(Y,tl)),Sn.mathMl===!0&&(Ee(ye,rd),Ee(Y,Fv),Ee(Y,tl))),_.ADD_TAGS&&(ye===F&&(ye=qo(ye)),Ee(ye,_.ADD_TAGS,ft)),_.ADD_ATTR&&(Y===me&&(Y=qo(Y)),Ee(Y,_.ADD_ATTR,ft)),_.ADD_URI_SAFE_ATTR&&Ee(ar,_.ADD_URI_SAFE_ATTR,ft),_.FORBID_CONTENTS&&(xs===Ql&&(xs=qo(xs)),Ee(xs,_.FORBID_CONTENTS,ft)),Re&&(ye["#text"]=!0),qe&&Ee(ye,["html","head","body"]),ye.table&&(Ee(ye,["tbody"]),delete j.tbody),_.TRUSTED_TYPES_POLICY){if(typeof _.TRUSTED_TYPES_POLICY.createHTML!="function")throw ya('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof _.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw ya('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');v=_.TRUSTED_TYPES_POLICY,S=v.createHTML("")}else v===void 0&&(v=I$(p,s)),v!==null&&typeof S=="string"&&(S=v.createHTML(""));Ot&&Ot(_),po=_}},os=Ee({},["mi","mo","mn","ms","mtext"]),za=Ee({},["foreignobject","desc","title","annotation-xml"]),w=Ee({},["title","style","font","a","script"]),k=Ee({},sd);Ee(k,od),Ee(k,x$);const L=Ee({},rd);Ee(L,_$);const D=function(_){let q=E(_);(!q||!q.tagName)&&(q={namespaceURI:zn,tagName:"template"});const J=Ji(_.tagName),Fe=Ji(q.tagName);return lr[_.namespaceURI]?_.namespaceURI===go?q.namespaceURI===wn?J==="svg":q.namespaceURI===ir?J==="svg"&&(Fe==="annotation-xml"||os[Fe]):!!k[J]:_.namespaceURI===ir?q.namespaceURI===wn?J==="math":q.namespaceURI===go?J==="math"&&za[Fe]:!!L[J]:_.namespaceURI===wn?q.namespaceURI===go&&!za[Fe]||q.namespaceURI===ir&&!os[Fe]?!1:!L[J]&&(w[J]||!k[J]):!!(ss==="application/xhtml+xml"&&lr[_.namespaceURI]):!1},X=function(_){Ca(t.removed,{element:_});try{_.parentNode.removeChild(_)}catch{_.remove()}},fe=function(_,q){try{Ca(t.removed,{attribute:q.getAttributeNode(_),from:q})}catch{Ca(t.removed,{attribute:null,from:q})}if(q.removeAttribute(_),_==="is"&&!Y[_])if(St||Jt)try{X(q)}catch{}else try{q.setAttribute(_,"")}catch{}},Oe=function(_){let q,J;if(Un)_="<remove></remove>"+_;else{const un=E$(_,/^[\r\n\t ]+/);J=un&&un[0]}ss==="application/xhtml+xml"&&zn===wn&&(_='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+_+"</body></html>");const Fe=v?v.createHTML(_):_;if(zn===wn)try{q=new d().parseFromString(Fe,ss)}catch{}if(!q||!q.documentElement){q=R.createDocument(zn,"template",null);try{q.documentElement.innerHTML=Ua?S:Fe}catch{}}const bt=q.body||q.documentElement;return _&&J&&bt.insertBefore(o.createTextNode(J),bt.childNodes[0]||null),zn===wn?A.call(q,qe?"html":"body")[0]:qe?q.documentElement:bt},It=function(_){return O.call(_.ownerDocument||_,_,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},it=function(_){return _ instanceof f&&(typeof _.nodeName!="string"||typeof _.textContent!="string"||typeof _.removeChild!="function"||!(_.attributes instanceof u)||typeof _.removeAttribute!="function"||typeof _.setAttribute!="function"||typeof _.namespaceURI!="string"||typeof _.insertBefore!="function"||typeof _.hasChildNodes!="function")},ho=function(_){return typeof i=="object"?_ instanceof i:_&&typeof _=="object"&&typeof _.nodeType=="number"&&typeof _.nodeName=="string"},cn=function(_,q,J){T[_]&&y$(T[_],Fe=>{Fe.call(t,q,J,po)})},ax=function(_){let q;if(cn("beforeSanitizeElements",_,null),it(_))return X(_),!0;const J=ft(_.nodeName);if(cn("uponSanitizeElement",_,{tagName:J,allowedTags:ye}),_.hasChildNodes()&&!ho(_.firstElementChild)&&(!ho(_.content)||!ho(_.content.firstElementChild))&&Xt(/<[/\w]/g,_.innerHTML)&&Xt(/<[/\w]/g,_.textContent))return X(_),!0;if(!ye[J]||j[J]){if(!j[J]&&lx(J)&&(ue.tagNameCheck instanceof RegExp&&Xt(ue.tagNameCheck,J)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(J)))return!1;if(Re&&!xs[J]){const Fe=E(_)||_.parentNode,bt=y(_)||_.childNodes;if(bt&&Fe){const un=bt.length;for(let Ke=un-1;Ke>=0;--Ke)Fe.insertBefore(g(bt[Ke],!0),h(_))}}return X(_),!0}return _ instanceof l&&!D(_)||(J==="noscript"||J==="noembed"||J==="noframes")&&Xt(/<\/no(script|embed|frames)/i,_.innerHTML)?(X(_),!0):(Se&&_.nodeType===3&&(q=_.textContent,q=yn(q,V," "),q=yn(q,Z," "),q=yn(q,ae," "),_.textContent!==q&&(Ca(t.removed,{element:_.cloneNode()}),_.textContent=q)),cn("afterSanitizeElements",_,null),!1)},ix=function(_,q,J){if(ge&&(q==="id"||q==="name")&&(J in o||J in rx))return!1;if(!(te&&!ee[q]&&Xt(ie,q))){if(!(I&&Xt(Ce,q))){if(!Y[q]||ee[q]){if(!(lx(_)&&(ue.tagNameCheck instanceof RegExp&&Xt(ue.tagNameCheck,_)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(_))&&(ue.attributeNameCheck instanceof RegExp&&Xt(ue.attributeNameCheck,q)||ue.attributeNameCheck instanceof Function&&ue.attributeNameCheck(q))||q==="is"&&ue.allowCustomizedBuiltInElements&&(ue.tagNameCheck instanceof RegExp&&Xt(ue.tagNameCheck,J)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(J))))return!1}else if(!ar[q]){if(!Xt(nt,yn(J,Ie,""))){if(!((q==="src"||q==="xlink:href"||q==="href")&&_!=="script"&&S$(J,"data:")===0&&Jl[_])){if(!(de&&!Xt(xe,yn(J,Ie,"")))){if(J)return!1}}}}}}return!0},lx=function(_){return _.indexOf("-")>0},cx=function(_){let q,J,Fe,bt;cn("beforeSanitizeAttributes",_,null);const{attributes:un}=_;if(!un)return;const Ke={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Y};for(bt=un.length;bt--;){q=un[bt];const{name:fn,namespaceURI:Um}=q;J=fn==="value"?q.value:w$(q.value);const M4=J;if(Fe=ft(fn),Ke.attrName=Fe,Ke.attrValue=J,Ke.keepAttr=!0,Ke.forceKeepAttr=void 0,cn("uponSanitizeAttribute",_,Ke),J=Ke.attrValue,Ke.forceKeepAttr)continue;if(!Ke.keepAttr){fe(fn,_);continue}if(!we&&Xt(/\/>/i,J)){fe(fn,_);continue}Se&&(J=yn(J,V," "),J=yn(J,Z," "),J=yn(J,ae," "));const ux=ft(_.nodeName);if(!ix(ux,Fe,J)){fe(fn,_);continue}if(_e&&(Fe==="id"||Fe==="name")&&(fe(fn,_),J=Le+J),v&&typeof p=="object"&&typeof p.getAttributeType=="function"&&!Um)switch(p.getAttributeType(ux,Fe)){case"TrustedHTML":{J=v.createHTML(J);break}case"TrustedScriptURL":{J=v.createScriptURL(J);break}}if(J!==M4)try{Um?_.setAttributeNS(Um,fn,J):_.setAttribute(fn,J)}catch{fe(fn,_)}}cn("afterSanitizeAttributes",_,null)},F4=function le(_){let q;const J=It(_);for(cn("beforeSanitizeShadowDOM",_,null);q=J.nextNode();)cn("uponSanitizeShadowNode",q,null),!ax(q)&&(q.content instanceof r&&le(q.content),cx(q));cn("afterSanitizeShadowDOM",_,null)};return t.sanitize=function(le){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},q,J,Fe,bt;if(Ua=!le,Ua&&(le="<!-->"),typeof le!="string"&&!ho(le))if(typeof le.toString=="function"){if(le=le.toString(),typeof le!="string")throw ya("dirty is not a string, aborting")}else throw ya("toString is not a function");if(!t.isSupported)return le;if(ln||oc(_),t.removed=[],typeof le=="string"&&(At=!1),At){if(le.nodeName){const fn=ft(le.nodeName);if(!ye[fn]||j[fn])throw ya("root node is forbidden and cannot be sanitized in-place")}}else if(le instanceof i)q=Oe("<!---->"),J=q.ownerDocument.importNode(le,!0),J.nodeType===1&&J.nodeName==="BODY"||J.nodeName==="HTML"?q=J:q.appendChild(J);else{if(!St&&!Se&&!qe&&le.indexOf("<")===-1)return v&&se?v.createHTML(le):le;if(q=Oe(le),!q)return St?null:se?S:""}q&&Un&&X(q.firstChild);const un=It(At?le:q);for(;Fe=un.nextNode();)ax(Fe)||(Fe.content instanceof r&&F4(Fe.content),cx(Fe));if(At)return le;if(St){if(Jt)for(bt=U.call(q.ownerDocument);q.firstChild;)bt.appendChild(q.firstChild);else bt=q;return(Y.shadowroot||Y.shadowrootmode)&&(bt=x.call(n,bt,!0)),bt}let Ke=qe?q.outerHTML:q.innerHTML;return qe&&ye["!doctype"]&&q.ownerDocument&&q.ownerDocument.doctype&&q.ownerDocument.doctype.name&&Xt(Uv,q.ownerDocument.doctype.name)&&(Ke="<!DOCTYPE "+q.ownerDocument.doctype.name+`>
`+Ke),Se&&(Ke=yn(Ke,V," "),Ke=yn(Ke,Z," "),Ke=yn(Ke,ae," ")),v&&se?v.createHTML(Ke):Ke},t.setConfig=function(le){oc(le),ln=!0},t.clearConfig=function(){po=null,ln=!1},t.isValidAttribute=function(le,_,q){po||oc({});const J=ft(le),Fe=ft(_);return ix(J,Fe,q)},t.addHook=function(le,_){typeof _=="function"&&(T[le]=T[le]||[],Ca(T[le],_))},t.removeHook=function(le){if(T[le])return v$(T[le])},t.removeHooks=function(le){T[le]&&(T[le]=[])},t.removeAllHooks=function(){T={}},t}var Wv=Hv();const Vv=$.each,L$=$.trim,$$=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],F$={ftp:21,http:80,https:443,mailto:25},M$=["img","video"],U$=(e,t)=>M(e)?!e:M(t)?!Ne(M$,t):!0,z$=e=>{try{return decodeURIComponent(e)}catch{return unescape(e)}},jv=(e,t,n)=>{const s=z$(t).replace(/\s/g,"");return e.allow_script_urls?!1:/((java|vb)script|mhtml):/i.test(s)?!0:e.allow_html_data_urls?!1:/^data:image\//i.test(s)?U$(e.allow_svg_data_urls,n)&&/^data:image\/svg\+xml/i.test(s):/^data:/i.test(s)};class an{static parseDataUri(t){let n;const s=decodeURIComponent(t).split(","),o=/data:([^;]+)/.exec(s[0]);return o&&(n=o[1]),{type:n,data:s[1]}}static isDomSafe(t,n,s={}){if(s.allow_script_urls)return!0;{const o=fs.decode(t).replace(/[\s\u0000-\u001F]+/g,"");return!jv(s,o,n)}}static getDocumentBaseUrl(t){var n;let s;return t.protocol.indexOf("http")!==0&&t.protocol!=="file:"?s=(n=t.href)!==null&&n!==void 0?n:"":s=t.protocol+"//"+t.host+t.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(s)&&(s=s.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(s)||(s+="/")),s}constructor(t,n={}){this.path="",this.directory="",t=L$(t),this.settings=n;const s=n.base_uri,o=this;if(/^([\w\-]+):([^\/]{2})/i.test(t)||/^\s*#/.test(t)){o.source=t;return}const r=t.indexOf("//")===0;if(t.indexOf("/")===0&&!r&&(t=(s&&s.protocol||"http")+"://mce_host"+t),!/^[\w\-]*:?\/\//.test(t)){const i=s?s.path:new an(document.location.href).directory;if((s==null?void 0:s.protocol)==="")t="//mce_host"+o.toAbsPath(i,t);else{const l=/([^#?]*)([#?]?.*)/.exec(t);l&&(t=(s&&s.protocol||"http")+"://mce_host"+o.toAbsPath(i,l[1])+l[2])}}t=t.replace(/@@/g,"(mce_at)");const a=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);a&&Vv($$,(i,l)=>{let c=a[l];c&&(c=c.replace(/\(mce_at\)/g,"@@")),o[i]=c}),s&&(o.protocol||(o.protocol=s.protocol),o.userInfo||(o.userInfo=s.userInfo),!o.port&&o.host==="mce_host"&&(o.port=s.port),(!o.host||o.host==="mce_host")&&(o.host=s.host),o.source=""),r&&(o.protocol="")}setPath(t){const n=/^(.*?)\/?(\w+)?$/.exec(t);n&&(this.path=n[0],this.directory=n[1],this.file=n[2]),this.source="",this.getURI()}toRelative(t){if(t==="./")return t;const n=new an(t,{base_uri:this});if(n.host!=="mce_host"&&this.host!==n.host&&n.host||this.port!==n.port||this.protocol!==n.protocol&&n.protocol!=="")return n.getURI();const s=this.getURI(),o=n.getURI();if(s===o||s.charAt(s.length-1)==="/"&&s.substr(0,s.length-1)===o)return s;let r=this.toRelPath(this.path,n.path);return n.query&&(r+="?"+n.query),n.anchor&&(r+="#"+n.anchor),r}toAbsolute(t,n){const s=new an(t,{base_uri:this});return s.getURI(n&&this.isSameOrigin(s))}isSameOrigin(t){if(this.host==t.host&&this.protocol==t.protocol){if(this.port==t.port)return!0;const n=this.protocol?F$[this.protocol]:null;if(n&&(this.port||n)==(t.port||n))return!0}return!1}toRelPath(t,n){let s=0,o="",r,a;const i=t.substring(0,t.lastIndexOf("/")).split("/"),l=n.split("/");if(i.length>=l.length){for(r=0,a=i.length;r<a;r++)if(r>=l.length||i[r]!==l[r]){s=r+1;break}}if(i.length<l.length){for(r=0,a=l.length;r<a;r++)if(r>=i.length||i[r]!==l[r]){s=r+1;break}}if(s===1)return n;for(r=0,a=i.length-(s-1);r<a;r++)o+="../";for(r=s-1,a=l.length;r<a;r++)r!==s-1?o+="/"+l[r]:o+=l[r];return o}toAbsPath(t,n){let s=0;const o=/\/$/.test(n)?"/":"",r=t.split("/"),a=n.split("/"),i=[];Vv(r,f=>{f&&i.push(f)});const l=[];for(let f=a.length-1;f>=0;f--)if(!(a[f].length===0||a[f]===".")){if(a[f]===".."){s++;continue}if(s>0){s--;continue}l.push(a[f])}const c=i.length-s;let u;return c<=0?u=gr(l).join("/"):u=i.slice(0,c).join("/")+"/"+gr(l).join("/"),u.indexOf("/")!==0&&(u="/"+u),o&&u.lastIndexOf("/")!==u.length-1&&(u+=o),u}getURI(t=!1){let n;return(!this.source||t)&&(n="",t||(this.protocol?n+=this.protocol+"://":n+="//",this.userInfo&&(n+=this.userInfo+"@"),this.host&&(n+=this.host),this.port&&(n+=":"+this.port)),this.path&&(n+=this.path),this.query&&(n+="?"+this.query),this.anchor&&(n+="#"+this.anchor),this.source=n),this.source}}const H$=$.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),id="data-mce-type";let qv=0;const Kv=(e,t,n,s,o)=>{var r,a,i,l;const c=t.validate,u=n.getSpecialElements();e.nodeType===Bg&&!t.allow_conditional_comments&&/^\[if/i.test((r=e.nodeValue)!==null&&r!==void 0?r:"")&&(e.nodeValue=" "+e.nodeValue);const f=(a=o==null?void 0:o.tagName)!==null&&a!==void 0?a:e.nodeName.toLowerCase();if(s!=="html"&&n.isValid(s)){M(o)&&(o.allowedTags[f]=!0);return}if(e.nodeType!==yr||f==="body")return;const d=C.fromDom(e),p=vr(d,id),b=Ft(d,"data-mce-bogus");if(!p&&Q(b)){b==="all"?De(d):Yn(d);return}const g=n.getElementRule(f);if(c&&!g){re(u,f)?De(d):Yn(d);return}else M(o)&&(o.allowedTags[f]=!0);if(c&&g&&!p){if(P((i=g.attributesForced)!==null&&i!==void 0?i:[],h=>{st(d,h.name,h.value==="{$uid}"?`mce_${qv++}`:h.value)}),P((l=g.attributesDefault)!==null&&l!==void 0?l:[],h=>{vr(d,h.name)||st(d,h.name,h.value==="{$uid}"?`mce_${qv++}`:h.value)}),g.attributesRequired&&!Ue(g.attributesRequired,h=>vr(d,h))){Yn(d);return}if(g.removeEmptyAttrs&&f_(d)){Yn(d);return}g.outputName&&g.outputName!==f&&eT(d,g.outputName)}},W$=(e,t,n,s,o)=>{const r=e.tagName.toLowerCase(),{attrName:a,attrValue:i}=o;o.keepAttr=Gv(t,n,s,r,a,i),o.keepAttr?(o.allowedAttributes[a]=!0,Xv(a,n)&&(o.attrValue=a),t.allow_svg_data_urls&&ct(i,"data:image/svg+xml")&&(o.forceKeepAttr=!0)):Yv(e,a)&&(o.forceKeepAttr=!0)},Gv=(e,t,n,s,o,r)=>n!=="html"&&!Us(s)?!0:!(o in H$&&jv(e,r,s))&&(!e.validate||t.isValid(s,o)||ct(o,"data-")||ct(o,"aria-")),Yv=(e,t)=>e.hasAttribute(id)&&(t==="id"||t==="class"||t==="style"),Xv=(e,t)=>e in t.getBoolAttrs(),V$=(e,t,n,s)=>{const{attributes:o}=e;for(let r=o.length-1;r>=0;r--){const a=o[r],i=a.name,l=a.value;!Gv(t,n,s,e.tagName.toLowerCase(),i,l)&&!Yv(e,i)?e.removeAttribute(i):Xv(i,n)&&e.setAttribute(i,i)}},j$=(e,t,n)=>{const s=Wv();return s.addHook("uponSanitizeElement",(o,r)=>{Kv(o,e,t,n.track(o),r)}),s.addHook("uponSanitizeAttribute",(o,r)=>{W$(o,e,t,n.current(),r)}),s},q$=(e,t)=>{const s={...{IN_PLACE:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ALLOWED_TAGS:["#comment","#cdata-section","body"],ALLOWED_ATTR:[]}};return s.PARSER_MEDIA_TYPE=t,e.allow_script_urls?s.ALLOWED_URI_REGEXP=/.*/:e.allow_html_data_urls&&(s.ALLOWED_URI_REGEXP=/^(?!(\w+script|mhtml):)/i),s},K$=e=>{const t=["type","href","role","arcrole","title","show","actuate","label","from","to"].map(s=>`xlink:${s}`),n={IN_PLACE:!0,USE_PROFILES:{html:!0,svg:!0,svgFilters:!0},ALLOWED_ATTR:t};return Wv().sanitize(e,n),e.innerHTML},G$=(e,t)=>{const n=VN();if(e.sanitize){const s=j$(e,t,n);return{sanitizeHtmlElement:(r,a)=>{s.sanitize(r,q$(e,a)),s.removed=[],n.reset()},sanitizeNamespaceElement:K$}}else return{sanitizeHtmlElement:(r,a)=>{const i=document.createNodeIterator(r,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT);let l;for(;l=i.nextNode();){const c=n.track(l);Kv(l,e,t,c),G(l)&&V$(l,e,t,c)}n.reset()},sanitizeNamespaceElement:ce}},Zv=$.makeMap,Qv=$.extend,Jv=(e,t,n,s)=>{const o=e.name,r=o in n&&o!=="title"&&o!=="textarea",a=t.childNodes;for(let i=0,l=a.length;i<l;i++){const c=a[i],u=new vt(c.nodeName.toLowerCase(),c.nodeType);if(G(c)){const f=c.attributes;for(let d=0,p=f.length;d<p;d++){const b=f[d];u.attr(b.name,b.value)}Us(u.name)&&(s(c),u.value=c.innerHTML)}else B(c)?(u.value=c.data,r&&(u.raw=!0)):(is(c)||Q_(c)||J_(c))&&(u.value=c.data);Us(u.name)||Jv(u,c,n,s),e.append(u)}},Y$=(e,t,n)=>{const s=[];for(let o=e,r=o;o;r=o,o=o.walk()){const a=o;P(t,i=>i(a)),je(a.parent)&&a!==e?o=r:s.push(a)}for(let o=s.length-1;o>=0;o--){const r=s[o];P(n,a=>a(r))}},X$=(e,t,n,s)=>{const o=n.validate,r=t.getNonEmptyElements(),a=t.getWhitespaceElements(),i=Qv(Zv("script,style,head,html,body,title,meta,param"),t.getBlockElements()),l=zp(t),c=/[ \t\r\n]+/g,u=/^[ \t\r\n]+/,f=/[ \t\r\n]+$/,d=E=>{let v=E.parent;for(;M(v);){if(v.name in a)return!0;v=v.parent}return!1},p=E=>{let v=E;for(;M(v);){if(v.name in l)return ga(t,r,a,v);v=v.parent}return!1},b=E=>E.name in i||Yc(t,E)||Us(E.name)&&E.parent===e,g=(E,v)=>{const S=v?E.prev:E.next;return M(S)||je(E.parent)?!1:b(E.parent)&&(E.parent!==e||s.isRootContent===!0)};return[E=>{var v;if(E.type===3&&!d(E)){let S=(v=E.value)!==null&&v!==void 0?v:"";S=S.replace(c," "),(vI(E.prev,b)||g(E,!0))&&(S=S.replace(u,"")),S.length===0?E.remove():E.value=S}},E=>{var v;if(E.type===1){const S=t.getElementRule(E.name);if(o&&S){const R=ga(t,r,a,E);S.paddInEmptyBlock&&R&&p(E)?Df(n,s,b,E):S.removeEmpty&&R?b(E)?E.remove():E.unwrap():S.paddEmpty&&(R||CI(E))&&Df(n,s,b,E)}}else if(E.type===3&&!d(E)){let S=(v=E.value)!==null&&v!==void 0?v:"";(E.next&&b(E.next)||g(E,!1))&&(S=S.replace(f,"")),S.length===0?E.remove():E.value=S}}]},Z$=(e,t)=>{var n;const s=(n=t.forced_root_block)!==null&&n!==void 0?n:e.forced_root_block;return s===!1?"":s===!0?"p":s},Ko=(e={},t=ds())=>{const n=_v(),s=_v(),o={validate:!0,root_name:"body",sanitize:!0,...e},r=new DOMParser,a=G$(o,t),i=(v,S,R="html")=>{const O=R==="xhtml"?"application/xhtml+xml":"text/html",U=re(t.getSpecialElements(),S.toLowerCase()),A=U?`<${S}>${v}</${S}>`:v,x=R==="xhtml"?`<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>${A}</body></html>`:`<body>${A}</body>`,T=r.parseFromString(x,O).body;return a.sanitizeHtmlElement(T,O),U?T.firstChild:T},l=n.addFilter,c=n.getFilters,u=n.removeFilter,f=s.addFilter,d=s.getFilters,p=s.removeFilter,b=(v,S)=>{If(t,v)&&S.push(v)},g=(v,S)=>{const R=Q(S.attr(id)),O=S.type===1&&!re(v,S.name)&&!Yc(t,S)&&!Us(S.name);return S.type===3||O&&!R},h=(v,S)=>{const R=Qv(Zv("script,style,head,html,body,title,meta,param"),t.getBlockElements()),O=/^[ \t\r\n]+/,U=/[ \t\r\n]+$/;let A=v.firstChild,x=null;const T=V=>{var Z,ae;V&&(A=V.firstChild,A&&A.type===3&&(A.value=(Z=A.value)===null||Z===void 0?void 0:Z.replace(O,"")),A=V.lastChild,A&&A.type===3&&(A.value=(ae=A.value)===null||ae===void 0?void 0:ae.replace(U,"")))};if(t.isValidChild(v.name,S.toLowerCase())){for(;A;){const V=A.next;g(R,A)?(x||(x=new vt(S,1),x.attr(o.forced_root_block_attrs),v.insert(x,A)),x.append(A)):(T(x),x=null),A=V}T(x)}},E={schema:t,addAttributeFilter:f,getAttributeFilters:d,removeAttributeFilter:p,addNodeFilter:l,getNodeFilters:c,removeNodeFilter:u,parse:(v,S={})=>{var R;const O=o.validate,U=(R=S.context)!==null&&R!==void 0?R:o.root_name,A=i(v,U,S.format);jc(t,A);const x=new vt(U,11);Jv(x,A,t.getSpecialElements(),a.sanitizeNamespaceElement),A.innerHTML="";const[T,V]=X$(x,t,o,S),Z=[],ae=O?Ie=>b(Ie,Z):ce,ie={nodes:{},attributes:{}},Ce=Ie=>Iy(c(),d(),Ie,ie);if(Y$(x,[T,Ce],[V,ae]),Z.reverse(),O&&Z.length>0)if(S.context){const{pass:Ie,fail:nt}=Co(Z,ye=>ye.parent===x);Of(nt,t,x,Ce),S.invalid=Ie.length>0}else Of(Z,t,x,Ce);const xe=Z$(o,S);return xe&&(x.name==="body"||S.isRootContent)&&h(x,xe),S.invalid||Ly(ie,S),x}};return g$(E,o),n$(E,o,t),E},Q$=e=>Yi(e)?Cs({validate:!1}).serialize(e):e,eE=(e,t,n)=>{const s=Q$(e),o=t(s);if(o.isDefaultPrevented())return o;if(Yi(e))if(o.content!==s){const r=Ko({validate:!1,forced_root_block:!1,...n}).parse(o.content,{context:e.name});return{...o,content:r}}else return{...o,content:e};else return o},tE=(e,t)=>{if(t.no_events)return xt.value(t);{const n=BD(e,t);return n.isDefaultPrevented()?xt.error(Yb(e,{content:"",...n}).content):xt.value(n)}},nE=(e,t,n)=>n.no_events?t:eE(t,o=>Yb(e,{...n,content:o}),{sanitize:Su(e),sandbox_iframes:wu(e)}).content,ld=(e,t)=>{if(t.no_events)return xt.value(t);{const n=eE(t.content,s=>DD(e,{...t,content:s}),{sanitize:Su(e),sandbox_iframes:wu(e)});return n.isDefaultPrevented()?(Gb(e,n),xt.error(void 0)):xt.value(n)}},cd=(e,t,n)=>{n.no_events||Gb(e,{...n,content:t})},ud=(e,t,n)=>({element:e,width:t,rows:n}),sE=(e,t)=>({element:e,cells:t}),J$=(e,t)=>({x:e,y:t}),oE=(e,t)=>Vn(e,t).bind(Ya).getOr(1),eF=(e,t,n,s,o)=>{const r=oE(o,"rowspan"),a=oE(o,"colspan"),i=e.rows;for(let l=n;l<n+r;l++){i[l]||(i[l]=sE(oh(s),[]));for(let c=t;c<t+a;c++){const u=i[l].cells;u[c]=l===n&&c===t?o:js(o)}}},tF=(e,t,n)=>{const s=e.rows;return!!(s[n]?s[n].cells:[])[t]},nF=(e,t,n)=>{for(;tF(e,t,n);)t++;return t},rE=e=>Tt(e,(t,n)=>n.cells.length>t?n.cells.length:t,0),aE=(e,t)=>{const n=e.rows;for(let s=0;s<n.length;s++){const o=n[s].cells;for(let r=0;r<o.length;r++)if(ve(o[r],t))return m.some(J$(r,s))}return m.none()},iE=(e,t,n,s,o)=>{const r=[],a=e.rows;for(let i=n;i<=o;i++){const l=a[i].cells,c=t<s?l.slice(t,s+1):l.slice(s,t+1);r.push(sE(a[i].element,c))}return r},sF=(e,t,n)=>{const s=t.x,o=t.y,r=n.x,a=n.y,i=o<a?iE(e,s,o,r,a):iE(e,s,a,r,o);return ud(e.element,rE(i),i)},oF=(e,t)=>{const n=js(e.element),s=C.fromTag("tbody");return Ls(s,t),Ve(n,s),n},rF=e=>he(e.rows,t=>{const n=he(t.cells,o=>{const r=oh(o);return ot(r,"colspan"),ot(r,"rowspan"),r}),s=js(t.element);return Ls(s,n),s}),aF=e=>{const t=ud(js(e),0,[]);return P(gt(e,"tr"),(n,s)=>{P(gt(n,"td,th"),(o,r)=>{eF(t,nF(t,r,s),s,n,o)})}),ud(t.element,rE(t.rows),t.rows)},iF=e=>oF(e,rF(e)),lF=(e,t,n)=>aE(e,t).bind(s=>aE(e,n).map(o=>sF(e,s,o))),cF=e=>Ye(e,t=>pe(t)==="ul"||pe(t)==="ol"),uF=(e,t)=>Ye(e,n=>pe(n)==="li"&&Iu(n,t)).fold(z([]),n=>cF(e).map(s=>{const o=C.fromTag(pe(s)),r=pr(Ac(s),(a,i)=>ct(i,"list-style"));return ei(o,r),[C.fromTag("li"),o]}).getOr([])),fF=(e,t)=>{const n=Tt(t,(s,o)=>(Ve(o,s),o),e);return t.length>0?Yu([n]):n},dF=e=>Dr(e)?tn(e).filter(Fc).fold(z([]),t=>[e,t]):Fc(e)?[e]:[],mF=(e,t,n)=>{const s=C.fromDom(t.commonAncestorContainer),o=es(s,e),r=oe(o,l=>n.isWrapper(pe(l))),a=uF(o,t),i=r.concat(a.length?a:dF(s));return he(i,js)},lE=()=>Yu([]),gF=(e,t,n)=>fF(C.fromDom(t.cloneContents()),mF(e,t,n)),pF=(e,t)=>_r(t,"table",K(ve,e)),hF=(e,t)=>pF(e,t[0]).bind(n=>{const s=t[0],o=t[t.length-1],r=aF(n);return lF(r,s,o).map(a=>Yu([iF(a)]))}).getOrThunk(lE),bF=(e,t,n)=>t.length>0&&t[0].collapsed?lE():gF(e,t[0],n),CF=(e,t,n)=>{const s=kb(t,e);return s.length>0?hF(e,s):bF(e,t,n)},nl=(e,t)=>t>=0&&t<e.length&&Uo(e.charAt(t)),cE=e=>Mt(e.innerText),yF=e=>e.map(t=>t.nodeName).getOr("div").toLowerCase(),vF=e=>m.from(e.selection.getRng()).map(t=>{var n;const s=m.from(e.dom.getParent(t.commonAncestorContainer,e.dom.isBlock)),o=e.getBody(),r=yF(s),a=C.fromDom(t.cloneContents());MC(a),UC(a);const i=e.dom.add(o,r,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},a.dom),l=cE(i),c=Mt((n=i.textContent)!==null&&n!==void 0?n:"");if(e.dom.remove(i),nl(c,0)||nl(c,c.length-1)){const u=s.getOr(o),f=cE(u),d=f.indexOf(l);if(d===-1)return l;{const p=nl(f,d-1),b=nl(f,d+l.length);return(p?" ":"")+l+(b?" ":"")}}else return l}).getOr(""),EF=(e,t)=>{const n=e.selection.getRng(),s=e.dom.create("body"),o=e.selection.getSel(),r=cf(e,Bu(o)),a=t.contextual?CF(C.fromDom(e.getBody()),r,e.schema).dom:n.cloneContents();return a&&s.appendChild(a),e.selection.serializer.serialize(s,t)},SF=(e,t)=>{if(t.format==="text")return vF(e);{const n=EF(e,t);return t.format==="tree"?n:e.selection.isCollapsed()?"":n}},wF=(e,t)=>({...e,format:t,get:!0,selection:!0,getInner:!0}),kF=(e,t,n={})=>{const s=wF(n,t);return tE(e,s).fold(kt,o=>{const r=SF(e,o);return nE(e,r,o)})},fd=0,uE=1,fE=2,xF=(e,t)=>{const n=e.length+t.length+2,s=new Array(n),o=new Array(n),r=(u,f,d)=>({start:u,end:f,diag:d}),a=(u,f,d,p,b)=>{const g=l(u,f,d,p);if(g===null||g.start===f&&g.diag===f-p||g.end===u&&g.diag===u-d){let h=u,y=d;for(;h<f||y<p;)h<f&&y<p&&e[h]===t[y]?(b.push([fd,e[h]]),++h,++y):f-u>p-d?(b.push([fE,e[h]]),++h):(b.push([uE,t[y]]),++y)}else{a(u,g.start,d,g.start-g.diag,b);for(let h=g.start;h<g.end;++h)b.push([fd,e[h]]);a(g.end,f,g.end-g.diag,p,b)}},i=(u,f,d,p)=>{let b=u;for(;b-f<p&&b<d&&e[b]===t[b-f];)++b;return r(u,b,f)},l=(u,f,d,p)=>{const b=f-u,g=p-d;if(b===0||g===0)return null;const h=b-g,y=g+b,E=(y%2===0?y:y+1)/2;s[1+E]=u,o[1+E]=f+1;let v,S,R,O,U;for(v=0;v<=E;++v){for(S=-v;S<=v;S+=2){for(R=S+E,S===-v||S!==v&&s[R-1]<s[R+1]?s[R]=s[R+1]:s[R]=s[R-1]+1,O=s[R],U=O-u+d-S;O<f&&U<p&&e[O]===t[U];)s[R]=++O,++U;if(h%2!==0&&h-v<=S&&S<=h+v&&o[R-h]<=s[R])return i(o[R-h],S+u-d,f,p)}for(S=h-v;S<=h+v;S+=2){for(R=S+E-h,S===h-v||S!==h+v&&o[R+1]<=o[R-1]?o[R]=o[R+1]-1:o[R]=o[R-1],O=o[R]-1,U=O-u+d-S;O>=u&&U>=d&&e[O]===t[U];)o[R]=O--,U--;if(h%2===0&&-v<=S&&S<=v&&o[R]<=s[R+h])return i(o[R],S+u-d,f,p)}}return null},c=[];return a(0,e.length,0,t.length,c),c},dd=e=>G(e)?e.outerHTML:B(e)?fs.encodeRaw(e.data,!1):is(e)?"<!--"+e.data+"-->":"",_F=e=>{let t;const n=document.createElement("div"),s=document.createDocumentFragment();for(e&&(n.innerHTML=e);t=n.firstChild;)s.appendChild(t);return s},NF=(e,t,n)=>{const s=_F(t);if(e.hasChildNodes()&&n<e.childNodes.length){const o=e.childNodes[n];e.insertBefore(s,o)}else e.appendChild(s)},AF=(e,t)=>{if(e.hasChildNodes()&&t<e.childNodes.length){const n=e.childNodes[t];e.removeChild(n)}},TF=(e,t)=>{let n=0;P(e,s=>{s[0]===fd?n++:s[0]===uE?(NF(t,s[1],n),n++):s[0]===fE&&AF(t,n)})},RF=(e,t)=>oe(he(Lt(e.childNodes),t?kn(Mt,dd):dd),n=>n.length>0),PF=(e,t)=>{const n=he(Lt(t.childNodes),dd);return TF(xF(n,e),t),t},DF=Rs(()=>document.implementation.createHTMLDocument("undo")),BF=e=>e.querySelector("iframe")!==null,OF=e=>({type:"fragmented",fragments:e,content:"",bookmark:null,beforeBookmark:null}),IF=e=>({type:"complete",fragments:null,content:e,bookmark:null,beforeBookmark:null}),sl=e=>{const t=e.serializer.getTempAttrs(),n=FC(e.getBody(),t);return BF(n)?OF(RF(n,!0)):IF(Mt(n.innerHTML))},md=(e,t,n)=>{const s=n?t.beforeBookmark:t.bookmark;t.type==="fragmented"?PF(t.fragments,e.getBody()):e.setContent(t.content,{format:"raw",no_selection:M(s)&&yb(s)?!s.isFakeCaret:!0}),s&&(e.selection.moveToBookmark(s),e.selection.scrollIntoView())},gd=e=>e.type==="fragmented"?e.fragments.join(""):e.content,dE=e=>{const t=C.fromTag("body",DF());return ni(t,gd(e)),P(gt(t,"*[data-mce-bogus]"),Yn),rp(t)},LF=(e,t)=>gd(e)===gd(t),$F=(e,t)=>dE(e)===dE(t),pd=(e,t)=>!e||!t?!1:LF(e,t)?!0:$F(e,t),hd=e=>e.get()===0,ol=(e,t,n)=>{hd(n)&&(e.typing=t)},mE=(e,t)=>{e.typing&&(ol(e,!1,t),e.add())},FF=e=>{e.typing&&(e.typing=!1,e.add())},MF=(e,t,n)=>{hd(t)&&n.set(hu(e.selection))},UF=(e,t,n,s,o,r,a)=>{const i=sl(e),l=$.extend(r||{},i);if(!hd(s)||e.removed)return null;const c=t.data[n.get()];if(e.dispatch("BeforeAddUndo",{level:l,lastLevel:c,originalEvent:a}).isDefaultPrevented()||c&&pd(c,l))return null;t.data[n.get()]&&o.get().each(d=>{t.data[n.get()].beforeBookmark=d});const u=SR(e);if(u&&t.data.length>u){for(let d=0;d<t.data.length-1;d++)t.data[d]=t.data[d+1];t.data.length--,n.set(t.data.length)}l.bookmark=hu(e.selection),n.get()<t.data.length-1&&(t.data.length=n.get()+1),t.data.push(l),n.set(t.data.length-1);const f={level:l,lastLevel:c,originalEvent:a};return n.get()>0?(e.setDirty(!0),e.dispatch("AddUndo",f),e.dispatch("change",f)):e.dispatch("AddUndo",f),l},zF=(e,t,n)=>{t.data=[],n.set(0),t.typing=!1,e.dispatch("ClearUndos")},HF=(e,t,n,s,o)=>{if(t.transact(s)){const r=t.data[n.get()].bookmark,a=t.data[n.get()-1];md(e,a,!0),t.transact(o)&&(t.data[n.get()-1].beforeBookmark=r)}},WF=(e,t,n)=>{let s;return t.get()<n.length-1&&(t.set(t.get()+1),s=n[t.get()],md(e,s,!1),e.setDirty(!0),e.dispatch("Redo",{level:s})),s},VF=(e,t,n,s)=>{let o;return t.typing&&(t.add(),t.typing=!1,ol(t,!1,n)),s.get()>0&&(s.set(s.get()-1),o=t.data[s.get()],md(e,o,!0),e.setDirty(!0),e.dispatch("Undo",{level:o})),o},jF=e=>{e.clear(),e.add()},qF=(e,t,n)=>n.get()>0||t.typing&&t.data[0]&&!pd(sl(e),t.data[0]),KF=(e,t)=>t.get()<e.data.length-1&&!e.typing,GF=(e,t,n)=>(mE(e,t),e.beforeChange(),e.ignore(n),e.add()),YF=(e,t)=>{try{e.set(e.get()+1),t()}finally{e.set(e.get()-1)}},XF=(e,t)=>{const n=e.dom,s=M(t)?t:e.getBody();P(n.select("table,a",s),o=>{switch(o.nodeName){case"TABLE":const r=AR(e),a=n.getAttrib(o,"border");(!a||a==="0")&&e.hasVisual?n.addClass(o,r):n.removeClass(o,r);break;case"A":if(!n.getAttrib(o,"href")){const i=n.getAttrib(o,"name")||o.id,l=Gh(e);i&&e.hasVisual?n.addClass(o,l):n.removeClass(o,l)}break}}),e.dispatch("VisualAid",{element:t,hasVisual:e.hasVisual})},gE=e=>({init:{bindEvents:ce},undoManager:{beforeChange:(t,n)=>MF(e,t,n),add:(t,n,s,o,r,a)=>UF(e,t,n,s,o,r,a),undo:(t,n,s)=>VF(e,t,n,s),redo:(t,n)=>WF(e,t,n),clear:(t,n)=>zF(e,t,n),reset:t=>jF(t),hasUndo:(t,n)=>qF(e,t,n),hasRedo:(t,n)=>KF(t,n),transact:(t,n,s)=>GF(t,n,s),ignore:(t,n)=>YF(t,n),extra:(t,n,s,o)=>HF(e,t,n,s,o)},formatter:{match:(t,n,s,o)=>Wf(e,t,n,s,o),matchAll:(t,n)=>uL(e,t,n),matchNode:(t,n,s,o)=>Ln(e,t,n,s,o),canApply:t=>dL(e,t),closest:t=>fL(e,t),apply:(t,n,s)=>yv(e,t,n,s),remove:(t,n,s,o)=>hv(e,t,n,s,o),toggle:(t,n,s)=>ZL(e,t,n,s),formatChanged:(t,n,s,o,r)=>XL(e,t,n,s,o,r)},editor:{getContent:t=>LB(e,t),setContent:(t,n)=>lL(e,t,n),insertContent:(t,n)=>oL(e,t,n),addVisual:t=>XF(e,t)},selection:{getContent:(t,n)=>kF(e,t,n)},autocompleter:{addDecoration:t=>vB(e,t),removeDecoration:()=>SB(e,C.fromDom(e.getBody()))},raw:{getModel:()=>m.none()}}),ZF=e=>{const t=c=>Ct(c)?c:{},{init:n,undoManager:s,formatter:o,editor:r,selection:a,autocompleter:i,raw:l}=e;return{init:{bindEvents:n.bindEvents},undoManager:{beforeChange:s.beforeChange,add:s.add,undo:s.undo,redo:s.redo,clear:s.clear,reset:s.reset,hasUndo:s.hasUndo,hasRedo:s.hasRedo,transact:(c,u,f)=>s.transact(f),ignore:(c,u)=>s.ignore(u),extra:(c,u,f,d)=>s.extra(f,d)},formatter:{match:(c,u,f,d)=>o.match(c,t(u),d),matchAll:o.matchAll,matchNode:o.matchNode,canApply:c=>o.canApply(c),closest:c=>o.closest(c),apply:(c,u,f)=>o.apply(c,t(u)),remove:(c,u,f,d)=>o.remove(c,t(u)),toggle:(c,u,f)=>o.toggle(c,t(u)),formatChanged:(c,u,f,d,p)=>o.formatChanged(u,f,d,p)},editor:{getContent:c=>r.getContent(c),setContent:(c,u)=>({content:r.setContent(c,u),html:""}),insertContent:(c,u)=>(r.insertContent(c),""),addVisual:r.addVisual},selection:{getContent:(c,u)=>a.getContent(u)},autocompleter:{addDecoration:i.addDecoration,removeDecoration:i.removeDecoration},raw:{getModel:()=>m.some(l.getRawModel())}}},QF=()=>{const e=z(null),t=z("");return{init:{bindEvents:ce},undoManager:{beforeChange:ce,add:e,undo:e,redo:e,clear:ce,reset:ce,hasUndo:$e,hasRedo:$e,transact:e,ignore:ce,extra:ce},formatter:{match:$e,matchAll:z([]),matchNode:z(void 0),canApply:$e,closest:t,apply:ce,remove:ce,toggle:ce,formatChanged:z({unbind:ce})},editor:{getContent:t,setContent:z({content:"",html:""}),insertContent:z(""),addVisual:ce},selection:{getContent:t},autocompleter:{addDecoration:ce,removeDecoration:ce},raw:{getModel:z(m.none())}}},$n=e=>re(e.plugins,"rtc"),JF=e=>Pe(e.plugins,"rtc").bind(t=>m.from(t.setup)),eM=e=>{const t=e;return JF(e).fold(()=>(t.rtcInstance=gE(e),m.none()),n=>(t.rtcInstance=QF(),m.some(()=>n().then(s=>(t.rtcInstance=ZF(s),s.rtc.isRemote)))))},bd=e=>e.rtcInstance?e.rtcInstance:gE(e),He=e=>{const t=e.rtcInstance;if(t)return t;throw new Error("Failed to get RTC instance not yet initialized.")},tM=(e,t,n)=>{He(e).undoManager.beforeChange(t,n)},nM=(e,t,n,s,o,r,a)=>He(e).undoManager.add(t,n,s,o,r,a),sM=(e,t,n,s)=>He(e).undoManager.undo(t,n,s),oM=(e,t,n)=>He(e).undoManager.redo(t,n),rM=(e,t,n)=>{He(e).undoManager.clear(t,n)},aM=(e,t)=>{He(e).undoManager.reset(t)},iM=(e,t,n)=>He(e).undoManager.hasUndo(t,n),lM=(e,t,n)=>He(e).undoManager.hasRedo(t,n),cM=(e,t,n,s)=>He(e).undoManager.transact(t,n,s),uM=(e,t,n)=>{He(e).undoManager.ignore(t,n)},fM=(e,t,n,s,o)=>{He(e).undoManager.extra(t,n,s,o)},dM=(e,t,n,s,o)=>He(e).formatter.match(t,n,s,o),mM=(e,t,n)=>He(e).formatter.matchAll(t,n),gM=(e,t,n,s,o)=>He(e).formatter.matchNode(t,n,s,o),pM=(e,t)=>He(e).formatter.canApply(t),hM=(e,t)=>He(e).formatter.closest(t),bM=(e,t,n,s)=>{He(e).formatter.apply(t,n,s)},CM=(e,t,n,s,o)=>{He(e).formatter.remove(t,n,s,o)},yM=(e,t,n,s)=>{He(e).formatter.toggle(t,n,s)},vM=(e,t,n,s,o,r)=>He(e).formatter.formatChanged(t,n,s,o,r),EM=(e,t)=>bd(e).editor.getContent(t),SM=(e,t,n)=>bd(e).editor.setContent(t,n),wM=(e,t,n)=>bd(e).editor.insertContent(t,n),kM=(e,t,n)=>He(e).selection.getContent(t,n),xM=(e,t)=>He(e).editor.addVisual(t),pE=e=>He(e).init.bindEvents(),_M=(e,t)=>He(e).autocompleter.addDecoration(t),NM=e=>He(e).autocompleter.removeDecoration(),AM=(e,t={})=>{const n=t.format?t.format:"html";return kM(e,n,t)},hE=e=>e.dom.length===0?(De(e),m.none()):m.some(e),TM=(e,t)=>e.filter(n=>aa.isBookmarkNode(n.dom)).bind(t?xr:Ds),RM=(e,t,n,s,o)=>{const r=e.dom,a=t.dom,i=s?r.length:a.length;s?(vf(r,a,o,!1,!s),n.setStart(a,i)):(vf(a,r,o,!1,!s),n.setEnd(a,i))},PM=(e,t,n)=>{tn(e).each(s=>{const o=e.dom;t&&fa(s,N(o,0),n)?ji(o,0,n):!t&&da(s,N(o,o.length),n)&&yf(o,o.length,n)})},bE=(e,t,n,s,o)=>{e.bind(r=>((s?yf:ji)(r.dom,s?r.dom.length:0,o),t.filter(Ht).map(i=>RM(r,i,n,s,o)))).orThunk(()=>TM(t,s).or(t).filter(Ht).map(a=>PM(a,s,o)))},DM=(e,t,n)=>{const s=m.from(t.firstChild).map(C.fromDom),o=m.from(t.lastChild).map(C.fromDom);e.deleteContents(),e.insertNode(t);const r=s.bind(Ds).filter(Ht).bind(hE),a=o.bind(xr).filter(Ht).bind(hE);bE(r,s,e,!0,n),bE(a,o,e,!1,n),e.collapse(!1)},BM=(e,t)=>({format:"html",...e,set:!0,selection:!0,content:t}),OM=(e,t)=>{if(t.format!=="raw"){const n=e.selection.getRng(),s=e.dom.getParent(n.commonAncestorContainer,e.dom.isBlock),o=s?{context:s.nodeName.toLowerCase()}:{},r=e.parser.parse(t.content,{forced_root_block:!1,...o,...t});return Cs({validate:!1},e.schema).serialize(r)}else return t.content},IM=(e,t,n={})=>{const s=BM(n,t);ld(e,s).each(o=>{const r=OM(e,o),a=e.selection.getRng();DM(a,a.createContextualFragment(r),e.schema),e.selection.setRng(a),la(e,a),cd(e,r,o)})},CE=(e,t,n)=>{if(re(e,t)){const s=oe(e[t],o=>o!==n);s.length===0?delete e[t]:e[t]=s}};var LM=(e,t)=>{let n,s;const o=(i,l)=>Ye(l,c=>e.is(c,i)),r=i=>e.getParents(i,void 0,e.getRoot()),a=()=>{n={},s={},t.on("NodeChange",i=>{const l=i.element,c=r(l),u={};Te(n,(f,d)=>{o(d,c).each(p=>{s[d]||(P(f,b=>{b(!0,{node:p,selector:d,parents:c})}),s[d]=f),u[d]=f})}),Te(s,(f,d)=>{u[d]||(delete s[d],P(f,p=>{p(!1,{node:l,selector:d,parents:c})}))})})};return{selectorChangedWithUnbind:(i,l)=>(n||a(),n[i]||(n[i]=[]),n[i].push(l),o(i,r(t.selection.getStart())).each(()=>{s[i]=n[i]}),{unbind:()=>{CE(n,i,l),CE(s,i,l)}})}};const yE=e=>!!(e&&e.ownerDocument)&&jn(C.fromDom(e.ownerDocument),C.fromDom(e)),$M=e=>e?yE(e.startContainer)&&yE(e.endContainer):!1,vE=(e,t,n,s)=>{let o,r;const{selectorChangedWithUnbind:a}=LM(e,s),i=(F,Y)=>{const me=e.createRng();M(F)&&M(Y)?(me.setStart(F,Y),me.setEnd(F,Y),S(me),y(!1)):(Lu(e,me,s.getBody(),!0),S(me))},l=F=>AM(s,F),c=(F,Y)=>IM(s,F,Y),u=F=>_C(s.getBody(),v(),F),f=F=>NC(s.getBody(),v(),F),d=(F,Y)=>nt.getBookmark(F,Y),p=F=>nt.moveToBookmark(F),b=(F,Y)=>(dB(e,F,Y).each(S),F),g=()=>{const F=v(),Y=E();return!F||F.item?!1:F.compareEndPoints?F.compareEndPoints("StartToEnd",F)===0:!Y||F.collapsed},h=()=>{const F=v(),Y=s.getBody().querySelectorAll('[data-mce-selected="1"]');return Y.length>0?rs(Y,me=>e.isEditable(me.parentElement)):kC(e,F)},y=F=>{const Y=v();Y.collapse(!!F),S(Y)},E=()=>t.getSelection?t.getSelection():t.document.selection,v=()=>{let F;const Y=(ue,j,ee)=>{try{return j.compareBoundaryPoints(ue,ee)}catch{return-1}},me=t.document;if(M(s.bookmark)&&!to(s)){const ue=nf(s);if(ue.isSome())return ue.map(j=>cf(s,[j])[0]).getOr(me.createRange())}try{const ue=E();ue&&!oi(ue.anchorNode)&&(ue.rangeCount>0?F=ue.getRangeAt(0):F=me.createRange(),F=cf(s,[F])[0])}catch{}if(F||(F=me.createRange()),Rr(F.startContainer)&&F.collapsed){const ue=e.getRoot();F.setStart(ue,0),F.setEnd(ue,0)}return o&&r&&(Y(F.START_TO_START,F,o)===0&&Y(F.END_TO_END,F,o)===0?F=r:(o=null,r=null)),F},S=(F,Y)=>{if(!$M(F))return;const me=E();if(F=s.dispatch("SetSelectionRange",{range:F,forward:Y}).range,me){r=F;try{me.removeAllRanges(),me.addRange(F)}catch{}Y===!1&&me.extend&&(me.collapse(F.endContainer,F.endOffset),me.extend(F.startContainer,F.startOffset)),o=me.rangeCount>0?me.getRangeAt(0):null}if(!F.collapsed&&F.startContainer===F.endContainer&&(me!=null&&me.setBaseAndExtent)&&F.endOffset-F.startOffset<2&&F.startContainer.hasChildNodes()){const j=F.startContainer.childNodes[F.startOffset];j&&j.nodeName==="IMG"&&(me.setBaseAndExtent(F.startContainer,F.startOffset,F.endContainer,F.endOffset),(me.anchorNode!==F.startContainer||me.focusNode!==F.endContainer)&&me.setBaseAndExtent(j,0,j,1))}s.dispatch("AfterSetSelectionRange",{range:F,forward:Y})},R=F=>(c(e.getOuterHTML(F)),F),O=()=>uB(s.getBody(),v()),U=(F,Y)=>fB(e,v(),F,Y),A=()=>{const F=E(),Y=F==null?void 0:F.anchorNode,me=F==null?void 0:F.focusNode;if(!F||!Y||!me||oi(Y)||oi(me))return!0;const ue=e.createRng(),j=e.createRng();try{ue.setStart(Y,F.anchorOffset),ue.collapse(!0),j.setStart(me,F.focusOffset),j.collapse(!0)}catch{return!0}return ue.compareBoundaryPoints(ue.START_TO_START,j)<=0},Ie={dom:e,win:t,serializer:n,editor:s,expand:(F={type:"word"})=>S(eo(e).expand(v(),F)),collapse:y,setCursorLocation:i,getContent:l,setContent:c,getBookmark:d,moveToBookmark:p,select:b,isCollapsed:g,isEditable:h,isForward:A,setNode:R,getNode:O,getSel:E,setRng:S,getRng:v,getStart:u,getEnd:f,getSelectedBlocks:U,normalize:()=>{const F=v(),Y=E();if(!YP(Y)&&Di(s)){const me=Mi(e,F);return me.each(ue=>{S(ue,A())}),me.getOr(F)}return F},selectorChanged:(F,Y)=>(a(F,Y),Ie),selectorChangedWithUnbind:a,getScrollContainer:()=>{let F,Y=e.getRoot();for(;Y&&Y.nodeName!=="BODY";){if(Y.scrollHeight>Y.clientHeight){F=Y;break}Y=Y.parentNode}return F},scrollIntoView:(F,Y)=>{M(F)?O1(s,F,Y):la(s,v(),Y)},placeCaretAt:(F,Y)=>S(sC(F,Y,s.getDoc())),getBoundingClientRect:()=>{const F=v();return F.collapsed?N.fromRangeStart(F).getClientRects()[0]:F.getBoundingClientRect()},destroy:()=>{t=o=r=null,ye.destroy()}},nt=aa(Ie),ye=Qb(Ie,s);return Ie.bookmarkManager=nt,Ie.controlSelection=ye,Ie},FM=(e,t,n)=>{e.addAttributeFilter("data-mce-tabindex",(s,o)=>{let r=s.length;for(;r--;){const a=s[r];a.attr("tabindex",a.attr("data-mce-tabindex")),a.attr(o,null)}}),e.addAttributeFilter("src,href,style",(s,o)=>{const r="data-mce-"+o,a=t.url_converter,i=t.url_converter_scope;let l=s.length;for(;l--;){const c=s[l];let u=c.attr(r);u!==void 0?(c.attr(o,u.length>0?u:null),c.attr(r,null)):(u=c.attr(o),o==="style"?u=n.serializeStyle(n.parseStyle(u),c.name):a&&(u=a.call(i,u,o,c.name)),c.attr(o,u.length>0?u:null))}}),e.addAttributeFilter("class",s=>{let o=s.length;for(;o--;){const r=s[o];let a=r.attr("class");a&&(a=a.replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),r.attr("class",a.length>0?a:null))}}),e.addAttributeFilter("data-mce-type",(s,o,r)=>{let a=s.length;for(;a--;){const i=s[a];i.attr("data-mce-type")==="bookmark"&&!r.cleanup&&(m.from(i.firstChild).exists(c=>{var u;return!ci((u=c.value)!==null&&u!==void 0?u:"")})?i.unwrap():i.remove())}}),e.addNodeFilter("noscript",s=>{var o;let r=s.length;for(;r--;){const a=s[r].firstChild;a&&(a.value=fs.decode((o=a.value)!==null&&o!==void 0?o:""))}}),e.addNodeFilter("script,style",(s,o)=>{var r;const a=l=>l.replace(/(<!--\[CDATA\[|\]\]-->)/g,`
`).replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"");let i=s.length;for(;i--;){const l=s[i],c=l.firstChild,u=(r=c==null?void 0:c.value)!==null&&r!==void 0?r:"";if(o==="script"){const f=l.attr("type");f&&l.attr("type",f==="mce-no/type"?null:f.replace(/^mce\-/,"")),t.element_format==="xhtml"&&c&&u.length>0&&(c.value=`// <![CDATA[
`+a(u)+`
// ]]>`)}else t.element_format==="xhtml"&&c&&u.length>0&&(c.value=`<!--
`+a(u)+`
-->`)}}),e.addNodeFilter("#comment",s=>{let o=s.length;for(;o--;){const r=s[o],a=r.value;t.preserve_cdata&&(a==null?void 0:a.indexOf("[CDATA["))===0?(r.name="#cdata",r.type=4,r.value=n.decode(a.replace(/^\[CDATA\[|\]\]$/g,""))):(a==null?void 0:a.indexOf("mce:protected "))===0&&(r.name="#text",r.type=3,r.raw=!0,r.value=unescape(a).substr(14))}}),e.addNodeFilter("xml:namespace,input",(s,o)=>{let r=s.length;for(;r--;){const a=s[r];a.type===7?a.remove():a.type===1&&o==="input"&&!a.attr("type")&&a.attr("type","text")}}),e.addAttributeFilter("data-mce-type",s=>{P(s,o=>{o.attr("data-mce-type")==="format-caret"&&(o.isEmpty(e.schema.getNonEmptyElements())?o.remove():o.unwrap())})}),e.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-block,data-mce-type,data-mce-resize,data-mce-placeholder",(s,o)=>{let r=s.length;for(;r--;)s[r].attr(o,null)}),t.remove_trailing_brs&&Nv(t,e,e.schema)},MM=e=>{const t=s=>(s==null?void 0:s.name)==="br",n=e.lastChild;if(t(n)){const s=n.prev;t(s)&&(n.remove(),s.remove())}},UM=(e,t,n)=>{let s;const o=e.dom;let r=t.cloneNode(!0);const a=document.implementation;if(a.createHTMLDocument){const i=a.createHTMLDocument("");$.each(r.nodeName==="BODY"?r.childNodes:[r],l=>{i.body.appendChild(i.importNode(l,!0))}),r.nodeName!=="BODY"?r=i.body.firstChild:r=i.body,s=o.doc,o.doc=i}return ED(e,{...n,node:r}),s&&(o.doc=s),r},zM=(e,t)=>M(e)&&e.hasEventListeners("PreProcess")&&!t.no_events,HM=(e,t,n)=>zM(e,n)?UM(e,t,n):t,WM=(e,t,n)=>{$.inArray(t,n)===-1&&(e.addAttributeFilter(n,(s,o)=>{let r=s.length;for(;r--;)s[r].attr(o,null)}),t.push(n))},VM=(e,t,n)=>!t.no_events&&e?SD(e,{...t,content:n}).content:n,jM=(e,t,n)=>{const s=Mt(n.getInner?t.innerHTML:e.getOuterHTML(t));return n.selection||li(C.fromDom(t))?s:$.trim(s)},qM=(e,t,n)=>{const s=n.selection?{forced_root_block:!1,...n}:n,o=e.parse(t,s);return MM(o),o},KM=(e,t,n)=>Cs(e,t).serialize(n),GM=(e,t,n,s,o)=>{const r=KM(t,n,s);return VM(e,o,r)},YM=(e,t)=>{const n=["data-mce-selected"],s={entity_encoding:"named",remove_trailing_brs:!0,pad_empty_with_br:!1,...e},o=t&&t.dom?t.dom:Ae.DOM,r=t&&t.schema?t.schema:ds(s),a=Ko(s,r);FM(a,s,o);const i=(l,c={})=>{const u={format:"html",...c},f=HM(t,l,u),d=jM(o,f,u),p=qM(a,d,u);return u.format==="tree"?p:GM(t,s,r,p,u)};return{schema:r,addNodeFilter:a.addNodeFilter,addAttributeFilter:a.addAttributeFilter,serialize:i,addRules:r.addValidElements,setRules:r.setValidElements,addTempAttr:K(WM,a,n),getTempAttrs:z(n),getNodeFilters:a.getNodeFilters,getAttributeFilters:a.getAttributeFilters,removeNodeFilter:a.removeNodeFilter,removeAttributeFilter:a.removeAttributeFilter}},EE=(e,t)=>{const n=YM(e,t);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters,removeNodeFilter:n.removeNodeFilter,removeAttributeFilter:n.removeAttributeFilter}},XM="html",ZM=(e,t)=>({...e,format:t,get:!0,getInner:!0}),QM=(e,t={})=>{const n=t.format?t.format:XM,s=ZM(t,n);return tE(e,s).fold(kt,o=>{const r=EM(e,o);return nE(e,r,o)})},JM="html",eU=(e,t)=>({format:JM,...e,set:!0,content:t}),Cd=(e,t,n={})=>{const s=eU(n,t);return ld(e,s).map(o=>{const r=SM(e,o.content,o);return cd(e,r.html,o),r.content}).getOr(t)},tU="autoresize_on_init,content_editable_state,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,tabfocus_elements,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_enable_default_filters,paste_filter_drop,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists".split(","),nU="template_cdate_classes,template_mdate_classes,template_selected_content_classes,template_preview_replace_values,template_replace_values,templates,template_cdate_format,template_mdate_format".split(","),sU="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,textcolor".split(","),SE=[{name:"template",replacedWith:"Advanced Template"},{name:"rtc"}],wE=(e,t)=>{const n=oe(t,s=>re(e,s));return Ns(n)},oU=e=>{const t=wE(e,tU),n=e.forced_root_block;return(n===!1||n==="")&&t.push("forced_root_block (false only)"),Ns(t)},rU=e=>wE(e,nU),kE=(e,t)=>{const n=$.makeMap(e.plugins," "),o=oe(t,r=>re(n,r));return Ns(o)},aU=e=>kE(e,sU),iU=e=>kE(e,SE.map(t=>t.name)),lU=(e,t)=>{const n=oU(e),s=aU(t),o=s.length>0,r=n.length>0,a=t.theme==="mobile";if(o||r||a){const i=`
- `,l=a?`

Themes:${i}mobile`:"",c=o?`

Plugins:${i}${s.join(i)}`:"",u=r?`

Options:${i}${n.join(i)}`:"";console.warn("The following deprecated features are currently enabled and have been removed in TinyMCE 6.0. These features will no longer work and should be removed from the TinyMCE configuration. See https://www.tiny.cloud/docs/tinymce/6/migration-from-5x/ for more information."+l+c+u)}},cU=e=>Ye(SE,t=>t.name===e).fold(()=>e,t=>t.replacedWith?`${e}, replaced by ${t.replacedWith}`:e),uU=(e,t)=>{const n=rU(e),s=iU(t),o=s.length>0,r=n.length>0;if(o||r){const a=`
- `,i=o?`

Plugins:${a}${s.map(cU).join(a)}`:"",l=r?`

Options:${a}${n.join(a)}`:"";console.warn("The following deprecated features are currently enabled but will be removed soon."+i+l)}},fU=(e,t)=>{lU(e,t),uU(e,t)},rl=Ae.DOM,dU=e=>{rl.setStyle(e.id,"display",e.orgDisplay)},al=e=>m.from(e).each(t=>t.destroy()),mU=e=>{const t=e;t.contentAreaContainer=t.formElement=t.container=t.editorContainer=null,t.bodyElement=t.contentDocument=t.contentWindow=null,t.iframeElement=t.targetElm=null;const n=e.selection;if(n){const s=n.dom;t.selection=n.win=n.dom=s.doc=null}},gU=e=>{const t=e.formElement;t&&(t._mceOldSubmit&&(t.submit=t._mceOldSubmit,delete t._mceOldSubmit),rl.unbind(t,"submit reset",e.formEventDelegate))},pU=e=>{if(!e.removed){const{_selectionOverrides:t,editorUpload:n}=e,s=e.getBody(),o=e.getElement();s&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&M(o==null?void 0:o.nextSibling)&&rl.remove(o.nextSibling),wD(e),e.editorManager.remove(e),!e.inline&&s&&dU(e),kD(e),rl.remove(e.getContainer()),al(t),al(n),e.destroy()}},hU=(e,t)=>{const{selection:n,dom:s}=e;if(!e.destroyed){if(!t&&!e.removed){e.remove();return}t||(e.editorManager.off("beforeunload",e._beforeUnload),e.theme&&e.theme.destroy&&e.theme.destroy(),al(n),al(s)),gU(e),mU(e),e.destroyed=!0}},il=(()=>{const e={};return{add:(o,r)=>{e[o]=r},get:o=>e[o]?e[o]:{icons:{}},has:o=>re(e,o)}})(),Go=yt.ModelManager,xE=(e,t)=>t.dom[e],_E=(e,t)=>parseInt(Tn(t,e),10),bU=K(xE,"clientWidth"),CU=K(xE,"clientHeight"),yU=K(_E,"margin-top"),vU=K(_E,"margin-left"),EU=e=>e.dom.getBoundingClientRect(),SU=(e,t,n)=>{const s=bU(e),o=CU(e);return t>=0&&n>=0&&t<=s&&n<=o},wU=(e,t,n,s)=>{const o=EU(t),r=e?o.left+t.dom.clientLeft+vU(t):0,a=e?o.top+t.dom.clientTop+yU(t):0,i=n-r,l=s-a;return{x:i,y:l}},kU=(e,t,n)=>{const s=C.fromDom(e.getBody()),o=e.inline?s:E_(s),r=wU(e.inline,o,t,n);return SU(o,r.x,r.y)},xU=e=>m.from(e).map(C.fromDom),_U=e=>{const t=e.inline?e.getBody():e.getContentAreaContainer();return xU(t).map(_o).getOr(!1)};var NU=()=>{const e=()=>{throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:e,close:e,getArgs:e}};const NE=e=>{const t=[],n=()=>{const d=e.theme;return d&&d.getNotificationManagerImpl?d.getNotificationManagerImpl():NU()},s=()=>m.from(t[0]),o=(d,p)=>d.type===p.type&&d.text===p.text&&!d.progressBar&&!d.timeout&&!p.progressBar&&!p.timeout,r=()=>{P(t,d=>{d.reposition()})},a=d=>{t.push(d)},i=d=>{mr(t,p=>p===d).each(p=>{t.splice(p,1)})},l=(d,p=!0)=>e.removed||!_U(e)?{}:(p&&e.dispatch("BeforeOpenNotification",{notification:d}),Ye(t,b=>o(n().getArgs(b),d)).getOrThunk(()=>{e.editorManager.setActive(e);const b=n().open(d,()=>{i(b),r(),wC(e)&&s().fold(()=>e.focus(),g=>hC(C.fromDom(g.getEl())))});return a(b),r(),e.dispatch("OpenNotification",{notification:{...b}}),b})),c=()=>{s().each(d=>{n().close(d),i(d),r()})},u=z(t);return(d=>{d.on("SkinLoaded",()=>{const p=uR(d);p&&l({text:p,type:"warning",timeout:0},!1),r()}),d.on("show ResizeEditor ResizeWindow NodeChange",()=>{requestAnimationFrame(r)}),d.on("remove",()=>{P(t.slice(),p=>{n().close(p)})})})(e),{open:l,close:c,getNotifications:u}},Yo=yt.PluginManager,ao=yt.ThemeManager;var AU=()=>{const e=()=>{throw new Error("Theme did not provide a WindowManager implementation.")};return{open:e,openUrl:e,alert:e,confirm:e,close:e}};const AE=e=>{let t=[];const n=()=>{const g=e.theme;return g&&g.getWindowManagerImpl?g.getWindowManagerImpl():AU()},s=(g,h)=>(...y)=>h?h.apply(g,y):void 0,o=g=>{e.dispatch("OpenWindow",{dialog:g})},r=g=>{e.dispatch("CloseWindow",{dialog:g})},a=g=>{t.push(g),o(g)},i=g=>{r(g),t=oe(t,h=>h!==g),t.length===0&&e.focus()},l=()=>m.from(t[t.length-1]),c=g=>{e.editorManager.setActive(e),tf(e),e.ui.show();const h=g();return a(h),h},u=(g,h)=>c(()=>n().open(g,h,i)),f=g=>c(()=>n().openUrl(g,i)),d=(g,h,y)=>{const E=n();E.alert(g,s(y||E,h))},p=(g,h,y)=>{const E=n();E.confirm(g,s(y||E,h))},b=()=>{l().each(g=>{n().close(g),i(g)})};return e.on("remove",()=>{P(t,g=>{n().close(g)})}),{open:u,openUrl:f,alert:d,confirm:p,close:b}},TE=(e,t)=>{e.notificationManager.open({type:"error",text:t})},ll=(e,t)=>{e._skinLoaded?TE(e,t):e.on("SkinLoaded",()=>{TE(e,t)})},TU=(e,t)=>{ll(e,hn.translate(["Failed to upload image: {0}",t]))},va=(e,t,n)=>{jb(e,t,{message:n}),console.error(n)},Ea=(e,t,n)=>n?`Failed to load ${e}: ${n} from url ${t}`:`Failed to load ${e} url: ${t}`,RU=(e,t,n)=>{va(e,"PluginLoadError",Ea("plugin",t,n))},PU=(e,t,n)=>{va(e,"IconsLoadError",Ea("icons",t,n))},DU=(e,t,n)=>{va(e,"LanguageLoadError",Ea("language",t,n))},BU=(e,t,n)=>{va(e,"ThemeLoadError",Ea("theme",t,n))},OU=(e,t,n)=>{va(e,"ModelLoadError",Ea("model",t,n))},IU=(e,t,n)=>{const s=hn.translate(["Failed to initialize plugin: {0}",t]);jb(e,"PluginLoadError",{message:s}),cl(s,n),ll(e,s)},cl=(e,...t)=>{const n=window.console;n&&(n.error?n.error(e,...t):n.log(e,...t))},LU=e=>/^[a-z0-9\-]+$/i.test(e),yd=e=>"content/"+e+"/content.css",$U=e=>tinymce.Resource.has(yd(e)),FU=e=>RE(e,oR(e)),MU=e=>RE(e,Wh(e)),RE=(e,t)=>{const n=e.editorManager.baseURL+"/skins/content",o=`content${e.editorManager.suffix}.css`;return he(t,r=>$U(r)?r:LU(r)&&!e.inline?`${n}/${r}/${o}`:e.documentBaseURI.toAbsolute(r))},UU=e=>{e.contentCSS=e.contentCSS.concat(FU(e),MU(e))},zU=e=>e?Lt(e.getElementsByTagName("img")):[],HU=(e,t)=>{const n={};return{findAll:(o,r=We)=>{const a=oe(zU(o),l=>{const c=l.src;return l.hasAttribute("data-mce-bogus")||l.hasAttribute("data-mce-placeholder")||!c||c===be.transparentSrc?!1:ct(c,"blob:")?!e.isUploaded(c)&&r(l):ct(c,"data:")?r(l):!1}),i=he(a,l=>{const c=l.src;if(re(n,c))return n[c].then(u=>Q(u)?u:{image:l,blobInfo:u.blobInfo});{const u=c$(t,c).then(f=>(delete n[c],{image:l,blobInfo:f})).catch(f=>(delete n[c],f));return n[c]=u,u}});return Promise.all(i)}}},PE=()=>{let n={};const s=(d,p)=>({status:d,resultUri:p}),o=d=>d in n;return{hasBlobUri:o,getResultUri:d=>{const p=n[d];return p?p.resultUri:null},isPending:d=>o(d)?n[d].status===1:!1,isUploaded:d=>o(d)?n[d].status===2:!1,markPending:d=>{n[d]=s(1,null)},markUploaded:(d,p)=>{n[d]=s(2,p)},removeFailed:d=>{delete n[d]},destroy:()=>{n={}}}};let WU=0;const VU=()=>{const e=()=>Math.round(Math.random()*4294967295).toString(36);return"s"+new Date().getTime().toString(36)+e()+e()+e()},jU=e=>e+WU+++VU(),qU=()=>{let e=[];const t=f=>({"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"})[f.toLowerCase()]||"dat",n=(f,d,p,b,g)=>{if(Q(f))return s({id:f,name:b,filename:g,blob:d,base64:p});if(Ct(f))return s(f);throw new Error("Unknown input type")},s=f=>{if(!f.blob||!f.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");const d=f.id||jU("blobid"),p=f.name||d,b=f.blob;return{id:z(d),name:z(p),filename:z(f.filename||p+"."+t(b.type)),blob:z(b),base64:z(f.base64),blobUri:z(f.blobUri||URL.createObjectURL(b)),uri:z(f.uri)}},o=f=>{a(f.id())||e.push(f)},r=f=>Ye(e,f).getOrUndefined(),a=f=>r(d=>d.id()===f);return{create:n,add:o,get:a,getByUri:f=>r(d=>d.blobUri()===f),getByData:(f,d)=>r(p=>p.base64()===f&&p.blob().type===d),findFirst:r,removeByUri:f=>{e=oe(e,d=>d.blobUri()===f?(URL.revokeObjectURL(d.blobUri()),!1):!0)},destroy:()=>{P(e,f=>{URL.revokeObjectURL(f.blobUri())}),e=[]}}},KU=(e,t)=>{const n={},s=(g,h)=>g?g.replace(/\/$/,"")+"/"+h.replace(/^\//,""):h,o=(g,h)=>new Promise((y,E)=>{const v=new XMLHttpRequest;v.open("POST",t.url),v.withCredentials=t.credentials,v.upload.onprogress=R=>{h(R.loaded/R.total*100)},v.onerror=()=>{E("Image upload failed due to a XHR Transport error. Code: "+v.status)},v.onload=()=>{if(v.status<200||v.status>=300){E("HTTP Error: "+v.status);return}const R=JSON.parse(v.responseText);if(!R||!Q(R.location)){E("Invalid JSON: "+v.responseText);return}y(s(t.basePath,R.location))};const S=new FormData;S.append("file",g.blob(),g.filename()),v.send(S)}),r=ke(t.handler)?t.handler:o,a=()=>new Promise(g=>{g([])}),i=(g,h)=>({url:h,blobInfo:g,status:!0}),l=(g,h)=>({url:"",blobInfo:g,status:!1,error:h}),c=(g,h)=>{$.each(n[g],y=>{y(h)}),delete n[g]},u=(g,h,y)=>(e.markPending(g.blobUri()),new Promise(E=>{let v,S;try{const R=()=>{v&&(v.close(),S=ce)},O=A=>{R(),e.markUploaded(g.blobUri(),A),c(g.blobUri(),i(g,A)),E(i(g,A))},U=A=>{R(),e.removeFailed(g.blobUri()),c(g.blobUri(),l(g,A)),E(l(g,A))};S=A=>{A<0||A>100||m.from(v).orThunk(()=>m.from(y).map(cc)).each(x=>{v=x,x.progressBar.value(A)})},h(g,S).then(O,A=>{U(Q(A)?{message:A}:A)})}catch(R){E(l(g,R))}})),f=g=>g===o,d=g=>{const h=g.blobUri();return new Promise(y=>{n[h]=n[h]||[],n[h].push(y)})},p=(g,h)=>(g=$.grep(g,y=>!e.isUploaded(y.blobUri())),Promise.all($.map(g,y=>e.isPending(y.blobUri())?d(y):u(y,r,h))));return{upload:(g,h)=>!t.url&&f(r)?a():p(g,h)}},DE=e=>()=>e.notificationManager.open({text:e.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0}),BE=(e,t)=>KU(t,{url:ZT(e),basePath:QT(e),credentials:JT(e),handler:eR(e)}),GU=e=>{const t=PE(),n=BE(e,t);return{upload:(s,o=!0)=>n.upload(s,o?DE(e):void 0)}},YU=(e,t)=>e.dom.isEmpty(t.dom)&&M(e.schema.getTextBlockElements()[pe(t)]),XU=e=>t=>{YU(e,t)&&Ve(t,C.fromHtml('<br data-mce-bogus="1" />'))},ZU=e=>{const t=qU();let n,s;const o=PE(),r=[],a=v=>S=>e.selection?v(S):[],i=v=>v+(v.indexOf("?")===-1?"?":"&")+new Date().getTime(),l=(v,S,R)=>{let O=0;do O=v.indexOf(S,O),O!==-1&&(v=v.substring(0,O)+R+v.substr(O+S.length),O+=R.length-S.length+1);while(O!==-1);return v},c=(v,S,R)=>{const O=`src="${R}"${R===be.transparentSrc?' data-mce-placeholder="1"':""}`;return v=l(v,`src="${S}"`,O),v=l(v,'data-mce-src="'+S+'"','data-mce-src="'+R+'"'),v},u=(v,S)=>{P(e.undoManager.data,R=>{R.type==="fragmented"?R.fragments=he(R.fragments,O=>c(O,v,S)):R.content=c(R.content,v,S)})},f=(v,S)=>{const R=e.convertURL(S,"src");u(v.src,S),Wn(C.fromDom(v),{src:Mh(e)?i(S):S,"data-mce-src":R})},d=()=>(n||(n=BE(e,o)),h().then(a(v=>{const S=he(v,R=>R.blobInfo);return n.upload(S,DE(e)).then(a(R=>{const O=[];let U=!1;const A=he(R,(x,T)=>{const{blobInfo:V,image:Z}=v[T];let ae=!1;return x.status&&YT(e)?(x.url&&!dt(Z.src,x.url)&&(U=!0),t.removeByUri(Z.src),$n(e)||f(Z,x.url)):x.error&&(x.error.remove&&(u(Z.src,be.transparentSrc),O.push(Z),ae=!0),TU(e,x.error.message)),{element:Z,status:x.status,uploadUri:x.url,blobInfo:V,removed:ae}});return O.length>0&&!$n(e)?e.undoManager.transact(()=>{P(Rc(O),x=>{const T=tn(x);De(x),T.each(XU(e)),t.removeByUri(x.dom.src)})}):U&&e.undoManager.dispatchChange(),A}))}))),p=()=>Fh(e)?d():Promise.resolve([]),b=v=>rs(r,S=>S(v)),g=v=>{r.push(v)},h=()=>(s||(s=HU(o,t)),s.findAll(e.getBody(),b).then(a(v=>{const S=oe(v,R=>Q(R)?(ll(e,R),!1):R.uriType!=="blob");return $n(e)||P(S,R=>{u(R.image.src,R.blobInfo.blobUri()),R.image.src=R.blobInfo.blobUri(),R.image.removeAttribute("data-mce-src")}),S}))),y=()=>{t.destroy(),o.destroy(),s=n=null},E=v=>v.replace(/src="(blob:[^"]+)"/g,(S,R)=>{const O=o.getResultUri(R);if(O)return'src="'+O+'"';let U=t.getByUri(R);return U||(U=Tt(e.editorManager.get(),(A,x)=>A||x.editorUpload&&x.editorUpload.blobCache.getByUri(R),void 0)),U?'src="data:'+U.blob().type+";base64,"+U.base64()+'"':S});return e.on("SetContent",()=>{Fh(e)?p():h()}),e.on("RawSaveContent",v=>{v.content=E(v.content)}),e.on("GetContent",v=>{v.source_view||v.format==="raw"||v.format==="tree"||(v.content=E(v.content))}),e.on("PostRender",()=>{e.parser.addNodeFilter("img",v=>{P(v,S=>{const R=S.attr("src");if(!R||t.getByUri(R))return;const O=o.getResultUri(R);O&&S.attr("src",O)})})}),{blobCache:t,addFilter:g,uploadImages:d,uploadImagesAuto:p,scanForImages:h,destroy:y}},QU=e=>{const t=e.dom,n=e.schema.type,s={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"left"},inherit:!1,preview:!1},{selector:"img,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginLeft:"0px",marginRight:"auto"},onformat:o=>{t.setStyle(o,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"},{selector:".mce-preview-object",ceFalseOverride:!0,styles:{display:"table",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{marginLeft:"auto",marginRight:"auto"},preview:!1}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginRight:"0px",marginLeft:"auto"},onformat:o=>{t.setStyle(o,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"right"},preview:!1}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"justify"},inherit:!1,preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:(()=>{const o={inline:"span",styles:{textDecoration:"line-through"},exact:!0},r={inline:"strike",remove:"all",preserve_attributes:["class","style"]},a={inline:"s",remove:"all",preserve_attributes:["class","style"]};return n!=="html4"?[a,o,r]:[o,a,r]})(),forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:(o,r,a)=>G(o)&&o.hasAttribute("href"),onformat:(o,r,a)=>{$.each(a,(i,l)=>{t.setAttrib(o,l,i)})}},lang:{inline:"span",clear_child_styles:!0,remove_similar:!0,attributes:{lang:"%value","data-mce-lang":o=>{var r;return(r=o==null?void 0:o.customValue)!==null&&r!==void 0?r:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return $.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd samp".split(/\s/),o=>{s[o]={block:o,remove:"all"}}),s},OE={remove_similar:!0,inherit:!1},Xo={selector:"td,th",...OE},JU={tablecellbackgroundcolor:{styles:{backgroundColor:"%value"},...Xo},tablecellverticalalign:{styles:{"vertical-align":"%value"},...Xo},tablecellbordercolor:{styles:{borderColor:"%value"},...Xo},tablecellclass:{classes:["%value"],...Xo},tableclass:{selector:"table",classes:["%value"],...OE},tablecellborderstyle:{styles:{borderStyle:"%value"},...Xo},tablecellborderwidth:{styles:{borderWidth:"%value"},...Xo}},ez=z(JU),tz=e=>{const t={},n=a=>M(a)?t[a]:t,s=a=>re(t,a),o=(a,i)=>{a&&(Q(a)?(Ge(i)||(i=[i]),P(i,l=>{lt(l.deep)&&(l.deep=!Kt(l)),lt(l.split)&&(l.split=!Kt(l)||Qe(l)),lt(l.remove)&&Kt(l)&&!Qe(l)&&(l.remove="none"),Kt(l)&&Qe(l)&&(l.mixed=!0,l.block_expand=!0),Q(l.classes)&&(l.classes=l.classes.split(/\s+/))}),t[a]=i):Te(a,(l,c)=>{o(c,l)}))},r=a=>(a&&t[a]&&delete t[a],t);return o(QU(e)),o(ez()),o(mR(e)),{get:n,has:s,register:o,unregister:r}},ul=$.each,Zt=Ae.DOM,vd=e=>M(e)&&Ct(e),IE=(e,t)=>{const n=t&&t.schema||ds({}),s=(l,c)=>{c.classes.length>0&&Zt.addClass(l,c.classes.join(" ")),Zt.setAttribs(l,c.attrs)},o=l=>{const c=Q(l)?{name:l,classes:[],attrs:{}}:l,u=Zt.create(c.name);return s(u,c),u},r=(l,c)=>{const u=n.getElementRule(l.nodeName.toLowerCase()),f=u==null?void 0:u.parentsRequired;return f&&f.length?c&&Ne(f,c)?c:f[0]:!1},a=(l,c,u)=>{let f;const d=c[0],p=vd(d)?d.name:void 0,b=r(l,p);if(b)p===b?(f=d,c=c.slice(1)):f=b;else if(d)f=d,c=c.slice(1);else if(!u)return l;const g=f?o(f):Zt.create("div");g.appendChild(l),u&&$.each(u,y=>{const E=o(y);g.insertBefore(E,l)});const h=vd(f)?f.siblings:void 0;return a(g,c,h)},i=Zt.create("div");if(e.length>0){const l=e[0],c=o(l),u=vd(l)?l.siblings:void 0;i.appendChild(a(c,e.slice(1),u))}return i},nz=e=>{e=$.trim(e);let t="div";const n={name:t,classes:[],attrs:{},selector:e};return e!=="*"&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(s,o,r,a,i)=>{switch(o){case"#":n.attrs.id=r;break;case".":n.classes.push(r);break;case":":$.inArray("checked disabled enabled read-only required".split(" "),r)!==-1&&(n.attrs[r]=r);break}if(a==="["){const l=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/);l&&(n.attrs[l[1]]=l[2])}return""})),n.name=t||"div",n},sz=e=>Q(e)?(e=e.split(/\s*,\s*/)[0],e=e.replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),$.map(e.split(/(?:>|\s+(?![^\[\]]+\]))/),t=>{const n=$.map(t.split(/(?:~\+|~|\+)/),nz),s=n.pop();return n.length&&(s.siblings=n),s}).reverse()):[],oz=(e,t)=>{let n="",s=gR(e);if(s==="")return"";const o=d=>Q(d)?d.replace(/%(\w+)/g,""):"",r=(d,p)=>Zt.getStyle(p??e.getBody(),d,!0);if(Q(t)){const d=e.formatter.get(t);if(!d)return"";t=d[0]}if("preview"in t){const d=t.preview;if(d===!1)return"";s=d||s}let a=t.block||t.inline||"span",i;const l=sz(t.selector);l.length>0?(l[0].name||(l[0].name=a),a=t.selector,i=IE(l,e)):i=IE([a],e);const c=Zt.select(a,i)[0]||i.firstChild;ul(t.styles,(d,p)=>{const b=o(d);b&&Zt.setStyle(c,p,b)}),ul(t.attributes,(d,p)=>{const b=o(d);b&&Zt.setAttrib(c,p,b)}),ul(t.classes,d=>{const p=o(d);Zt.hasClass(c,p)||Zt.addClass(c,p)}),e.dispatch("PreviewFormats"),Zt.setStyles(i,{position:"absolute",left:-65535}),e.getBody().appendChild(i);const u=r("fontSize"),f=/px$/.test(u)?parseInt(u,10):0;return ul(s.split(" "),d=>{let p=r(d,c);if(!(d==="background-color"&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(p)&&(p=r(d),Lr(p).toLowerCase()==="#ffffff"))&&!(d==="color"&&Lr(p).toLowerCase()==="#000000")){if(d==="font-size"&&/em|%$/.test(p)){if(f===0)return;p=parseFloat(p)/(/%$/.test(p)?100:1)*f+"px"}d==="border"&&p&&(n+="padding:0 2px;"),n+=d+":"+p+";"}}),e.dispatch("AfterPreviewFormats"),Zt.remove(i),n},rz=e=>{e.addShortcut("meta+b","","Bold"),e.addShortcut("meta+i","","Italic"),e.addShortcut("meta+u","","Underline");for(let t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",!1,"h"+t]);e.addShortcut("access+7","",["FormatBlock",!1,"p"]),e.addShortcut("access+8","",["FormatBlock",!1,"div"]),e.addShortcut("access+9","",["FormatBlock",!1,"address"])},LE=e=>{const t=tz(e),n=et({});return rz(e),SL(e),$n(e)||KL(n,e),{get:t.get,has:t.has,register:t.register,unregister:t.unregister,apply:(s,o,r)=>{bM(e,s,o,r)},remove:(s,o,r,a)=>{CM(e,s,o,r,a)},toggle:(s,o,r)=>{yM(e,s,o,r)},match:(s,o,r,a)=>dM(e,s,o,r,a),closest:s=>hM(e,s),matchAll:(s,o)=>mM(e,s,o),matchNode:(s,o,r,a)=>gM(e,s,o,r,a),canApply:s=>pM(e,s),formatChanged:(s,o,r,a)=>vM(e,n,s,o,r,a),getCssText:K(oz,e)}},$E=e=>{switch(e.toLowerCase()){case"undo":case"redo":case"mcefocus":return!0;default:return!1}},az=(e,t,n)=>{const s=et(!1),o=l=>{ol(t,!1,n),t.add({},l)};e.on("init",()=>{t.add()}),e.on("BeforeExecCommand",l=>{const c=l.command;$E(c)||(mE(t,n),t.beforeChange())}),e.on("ExecCommand",l=>{const c=l.command;$E(c)||o(l)}),e.on("ObjectResizeStart cut",()=>{t.beforeChange()}),e.on("SaveContent ObjectResized blur",o),e.on("dragend",o),e.on("keyup",l=>{const c=l.keyCode;if(l.isDefaultPrevented())return;const u=be.os.isMacOS()&&l.key==="Meta";(c>=33&&c<=36||c>=37&&c<=40||c===45||l.ctrlKey||u)&&(o(),e.nodeChanged()),(c===46||c===8)&&e.nodeChanged(),s.get()&&t.typing&&!pd(sl(e),t.data[0])&&(e.isDirty()||e.setDirty(!0),e.dispatch("TypingUndo"),s.set(!1),e.nodeChanged())}),e.on("keydown",l=>{const c=l.keyCode;if(l.isDefaultPrevented())return;if(c>=33&&c<=36||c>=37&&c<=40||c===45){t.typing&&o(l);return}const u=l.ctrlKey&&!l.altKey||l.metaKey;if((c<16||c>20)&&c!==224&&c!==91&&!t.typing&&!u){t.beforeChange(),ol(t,!0,n),t.add({},l),s.set(!0);return}(be.os.isMacOS()?l.metaKey:l.ctrlKey&&!l.altKey)&&t.beforeChange()}),e.on("mousedown",l=>{t.typing&&o(l)});const r=l=>l.inputType==="insertReplacementText",a=l=>l.inputType==="insertText"&&l.data===null,i=l=>l.inputType==="insertFromPaste"||l.inputType==="insertFromDrop";e.on("input",l=>{l.inputType&&(r(l)||a(l)||i(l))&&o(l)}),e.on("AddUndo Undo Redo ClearUndos",l=>{l.isDefaultPrevented()||e.nodeChanged()})},iz=e=>{e.addShortcut("meta+z","","Undo"),e.addShortcut("meta+y,meta+shift+z","","Redo")},FE=e=>{const t=ms(),n=et(0),s=et(0),o={data:[],typing:!1,beforeChange:()=>{tM(e,n,t)},add:(r,a)=>nM(e,o,s,n,t,r,a),dispatchChange:()=>{e.setDirty(!0);const r=sl(e);r.bookmark=hu(e.selection),e.dispatch("change",{level:r,lastLevel:Va(o.data,s.get()).getOrUndefined()})},undo:()=>sM(e,o,n,s),redo:()=>oM(e,s,o.data),clear:()=>{rM(e,o,s)},reset:()=>{aM(e,o)},hasUndo:()=>iM(e,o,s),hasRedo:()=>lM(e,o,s),transact:r=>cM(e,o,n,r),ignore:r=>{uM(e,n,r)},extra:(r,a)=>{fM(e,o,s,r,a)}};return $n(e)||az(e,o,n),iz(e),o},lz=[9,27,H.HOME,H.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,H.DOWN,H.UP,H.LEFT,H.RIGHT].concat(be.browser.isFirefox()?[224]:[]),ME="data-mce-placeholder",UE=e=>e.type==="keydown"||e.type==="keyup",zE=e=>{const t=e.keyCode;return t===H.BACKSPACE||t===H.DELETE},cz=e=>{if(UE(e)){const t=e.keyCode;return!zE(e)&&(H.metaKeyPressed(e)||e.altKey||t>=112&&t<=123||Ne(lz,t))}else return!1},uz=e=>UE(e)&&!(zE(e)||e.type==="keyup"&&e.keyCode===229),fz=(e,t,n)=>{if(ze(C.fromDom(t),!1)){const s=t.firstElementChild;return s?e.getStyle(t.firstElementChild,"padding-left")||e.getStyle(t.firstElementChild,"padding-right")?!1:n===s.nodeName.toLowerCase():!0}else return!1},dz=e=>{var t;const n=e.dom,s=pt(e),o=(t=cR(e))!==null&&t!==void 0?t:"",r=(a,i)=>{if(cz(a))return;const l=e.getBody(),c=uz(a)?!1:fz(n,l,s);(n.getAttrib(l,ME)!==""!==c||i)&&(n.setAttrib(l,ME,c?o:null),n.setAttrib(l,"aria-placeholder",c?o:null),PD(e,c),e.on(c?"keydown":"keyup",r),e.off(c?"keyup":"keydown",r))};xn(o)&&e.on("init",a=>{r(a,!0),e.on("change SetContent ExecCommand",r),e.on("paste",i=>Gt.setEditorTimeout(e,()=>r(i)))})},mz=(e,t)=>({block:e,position:t}),gz=(e,t)=>({from:e,to:t}),Ed=(e,t)=>{const n=C.fromDom(e),s=C.fromDom(t.container());return qi(n,s).map(o=>mz(o,t))},pz=e=>!ve(e.from.block,e.to.block),HE=(e,t)=>Bs(t,o=>Br(o)||nn(o.dom),o=>ve(o,e)).filter($t).getOr(e),hz=(e,t)=>{const n=C.fromDom(e);return ve(HE(n,t.from.block),HE(n,t.to.block))},bz=e=>Be(e.from.block.dom)===!1&&Be(e.to.block.dom)===!1,Cz=e=>{const t=n=>bp(n)||qc(n.dom);return t(e.from.block)&&t(e.to.block)},yz=(e,t,n)=>Me(n.position.getNode())&&!ze(n.block)?Mo(!1,n.block.dom).bind(s=>s.isEqual(n.position)?Vt(t,e,s).bind(o=>Ed(e,o)):m.some(n)).getOr(n):n,vz=(e,t,n)=>{const s=Ed(e,N.fromRangeStart(n)),o=s.bind(r=>Vt(t,e,r.position).bind(a=>Ed(e,a).map(i=>yz(e,t,i))));return mt(s,o,gz).filter(r=>pz(r)&&hz(e,r)&&bz(r)&&Cz(r))},Ez=(e,t,n)=>n.collapsed?vz(e,t,n):m.none(),Sz=(e,t)=>{const n=rt(e);return mr(n,s=>t.isBlock(pe(s))).fold(z(n),s=>n.slice(0,s))},WE=(e,t)=>{const n=Sz(e,t);return P(n,De),n},VE=(e,t)=>{const n=es(t,e);return Ye(n.reverse(),s=>ze(s)).each(De)},wz=e=>oe(Gg(e),t=>!ze(t)).length===0,kz=(e,t,n,s,o)=>{if(ze(n))return ls(n),ht(n.dom);wz(o)&&ze(t)&&Dt(o,C.fromTag("br"));const r=Bt(n.dom,N.before(o.dom));return P(WE(t,s),a=>{Dt(o,a)}),VE(e,t),r},xz=(e,t)=>e.isInline(pe(t)),_z=(e,t,n,s)=>{if(ze(n)){if(ze(t)){const a=dr((i=>{const l=(c,u)=>wc(c).fold(()=>u,f=>xz(s,f)?l(f,u.concat(js(f))):u);return l(i,[])})(n),(i,l)=>(op(i,l),l),Or());No(t),Ve(t,a)}return De(n),ht(t.dom)}const o=on(n.dom);return P(WE(t,s),r=>{Ve(n,r)}),VE(e,t),o},Nz=(e,t)=>{const n=es(t,e);return m.from(n[n.length-1])},Az=(e,t)=>jn(t,e)?Nz(t,e):m.none(),jE=(e,t)=>{Mo(e,t.dom).bind(n=>m.from(n.getNode())).map(C.fromDom).filter(Ms).each(De)},qE=(e,t,n,s)=>(jE(!0,t),jE(!1,n),Az(t,n).fold(K(_z,e,t,n,s),K(kz,e,t,n,s))),KE=(e,t,n,s,o)=>t?qE(e,s,n,o):qE(e,n,s,o),Sd=(e,t)=>{const n=C.fromDom(e.getBody());return Ez(n.dom,t,e.selection.getRng()).map(o=>()=>{KE(n,t,o.from.block,o.to.block,e.schema).each(r=>{e.selection.setRng(r.toRange())})})},Tz=(e,t,n)=>{const s=t.getRng();return mt(qi(e,C.fromDom(s.startContainer)),qi(e,C.fromDom(s.endContainer)),(o,r)=>ve(o,r)?m.none():m.some(()=>{s.deleteContents(),KE(e,!0,o,r,n).each(a=>{t.setRng(a.toRange())})})).getOr(m.none())},GE=(e,t)=>{const n=C.fromDom(t),s=K(ve,e);return Kn(n,Br,s).isSome()},Rz=(e,t)=>GE(e,t.startContainer)||GE(e,t.endContainer),Pz=(e,t)=>{const n=Bt(e.dom,N.fromRangeStart(t)).isNone(),s=_t(e.dom,N.fromRangeEnd(t)).isNone();return!Rz(e,t)&&n&&s},Dz=e=>m.some(()=>{e.setContent(""),e.selection.setCursorLocation()}),Bz=e=>{const t=C.fromDom(e.getBody()),n=e.selection.getRng();return Pz(t,n)?Dz(e):Tz(t,e.selection,e.schema)},wd=(e,t)=>e.selection.isCollapsed()?m.none():Bz(e),ts=(e,t,n,s,o)=>m.from(t._selectionOverrides.showCaret(e,n,s,o)),Oz=e=>{const t=e.ownerDocument.createRange();return t.selectNode(e),t},Sa=(e,t)=>e.dispatch("BeforeObjectSelected",{target:t}).isDefaultPrevented()?m.none():m.some(Oz(t)),Iz=(e,t,n)=>{const s=_u(1,e.getBody(),t),o=N.fromRangeStart(s),r=o.getNode();if(Zr(r))return ts(1,e,r,!o.isAtEnd(),!1);const a=o.getNode(!0);if(Zr(a))return ts(1,e,a,!1,!1);const i=oo(e.dom.getRoot(),o.getNode());return Zr(i)?ts(1,e,i,!1,n):m.none()},kd=(e,t,n)=>t.collapsed?Iz(e,t,n).getOr(t):t,Lz=e=>vs(e)||ca(e),$z=e=>Es(e)||ua(e),Fz=(e,t)=>{B(t)&&t.data.length===0&&e.remove(t)},YE=(e,t,n,s,o,r)=>{ts(s,e,r.getNode(!o),o,!0).each(a=>{if(t.collapsed){const i=t.cloneRange();o?i.setEnd(a.startContainer,a.startOffset):i.setStart(a.endContainer,a.endOffset),i.deleteContents()}else t.deleteContents();e.selection.setRng(a)}),Fz(e.dom,n)},Mz=(e,t)=>{const n=e.selection.getRng();if(!B(n.commonAncestorContainer))return m.none();const s=t?tt.Forwards:tt.Backwards,o=On(e.getBody()),r=K(Nu,t?o.next:o.prev),a=t?Lz:$z,i=na(s,e.getBody(),n),l=r(i),c=l&&Yt(t,l);if(!c||!Ai(i,c))return m.none();if(a(c))return m.some(()=>YE(e,n,i.getNode(),s,t,c));const u=r(c);return u&&a(u)&&Ai(c,u)?m.some(()=>YE(e,n,i.getNode(),s,t,u)):m.none()},xd=(e,t)=>Mz(e,t),_d=(e,t)=>{const n=e.getBody();return t?ht(n).filter(vs):on(n).filter(Es)},Nd=e=>{const t=e.selection.getRng();return!t.collapsed&&(_d(e,!0).exists(n=>n.isEqual(N.fromRangeStart(t)))||_d(e,!1).exists(n=>n.isEqual(N.fromRangeEnd(t))))},Uz=e=>M(e)&&(Br(C.fromDom(e))||Dr(C.fromDom(e))),Ut=Pn.generate([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),zz=(e,t)=>{const n=t.getNode(!e),s=e?"after":"before";return G(n)&&n.getAttribute("data-mce-caret")===s},Hz=(e,t,n,s,o)=>{const r=a=>o.isInline(a.nodeName.toLowerCase())&&!Dn(n,s,e);return cb(!t,n).fold(()=>cb(t,s).fold($e,r),r)},XE=(e,t,n,s)=>{const o=s.getNode(!t);return qi(C.fromDom(e),C.fromDom(n.getNode())).map(r=>ze(r)?Ut.remove(r.dom):Ut.moveToElement(o)).orThunk(()=>m.some(Ut.moveToElement(o)))},ZE=(e,t,n,s)=>Vt(t,e,n).bind(o=>Uz(o.getNode())||Hz(e,t,n,o,s)?m.none():t&&Be(o.getNode())||!t&&Be(o.getNode(!0))?XE(e,t,n,o):t&&Es(n)||!t&&vs(n)?m.some(Ut.moveToPosition(o)):m.none()),Wz=(e,t)=>je(t)?m.none():e&&Be(t.nextSibling)?m.some(Ut.moveToElement(t.nextSibling)):!e&&Be(t.previousSibling)?m.some(Ut.moveToElement(t.previousSibling)):m.none(),Vz=(e,t,n)=>n.fold(s=>m.some(Ut.remove(s)),s=>m.some(Ut.moveToElement(s)),s=>Dn(t,s,e)?m.none():m.some(Ut.moveToPosition(s))),jz=(e,t,n,s)=>zz(t,n)?Wz(t,n.getNode(!t)).orThunk(()=>ZE(e,t,n,s)):ZE(e,t,n,s).bind(o=>Vz(e,n,o)),qz=(e,t,n,s)=>{const o=_u(t?1:-1,e,n),r=N.fromRangeStart(o),a=C.fromDom(e);return!t&&Es(r)?m.some(Ut.remove(r.getNode(!0))):t&&vs(r)?m.some(Ut.remove(r.getNode())):!t&&vs(r)&&hf(a,r,s)?XB(a,r,s).map(i=>Ut.remove(i.getNode())):t&&Es(r)&&pf(a,r,s)?ZB(a,r,s).map(i=>Ut.remove(i.getNode())):jz(e,t,r,s)},Kz=(e,t)=>n=>(e._selectionOverrides.hideFakeCaret(),no(e,t,C.fromDom(n)),!0),Gz=(e,t)=>n=>{const s=t?N.before(n):N.after(n);return e.selection.setRng(s.toRange()),!0},Yz=e=>t=>(e.selection.setRng(t.toRange()),!0),QE=(e,t)=>m.from(oo(e.getBody(),t)),Xz=(e,t)=>{const n=e.selection.getNode();return QE(e,n).filter(Be).fold(()=>qz(e.getBody(),t,e.selection.getRng(),e.schema).map(s=>()=>s.fold(Kz(e,t),Gz(e,t),Yz(e))),()=>m.some(ce))},Zz=e=>{P(gt(e,".mce-offscreen-selection"),De)},Qz=(e,t)=>{const n=e.selection.getNode();return Be(n)&&!ai(n)?QE(e,n.parentNode).filter(Be).fold(()=>m.some(()=>{Zz(C.fromDom(e.getBody())),no(e,t,C.fromDom(e.selection.getNode())),Sf(e)}),()=>m.some(ce)):Nd(e)?m.some(()=>{Ey(e,e.selection.getRng(),C.fromDom(e.getBody()))}):m.none()},JE=e=>{const t=e.dom,n=e.selection,s=oo(e.getBody(),n.getNode());if(nn(s)&&t.isBlock(s)&&t.isEmpty(s)){const o=t.create("br",{"data-mce-bogus":"1"});t.setHTML(s,""),s.appendChild(o),n.setRng(N.before(o).toRange())}return!0},Ad=(e,t)=>e.selection.isCollapsed()?Xz(e,t):Qz(e,t),Jz=(e,t)=>{const n=N.fromRangeStart(e.selection.getRng());return Vt(t,e.getBody(),n).filter(s=>t?HB(s):WB(s)).bind(s=>xu(t?0:-1,s)).map(s=>()=>e.selection.select(s))},Td=(e,t)=>e.selection.isCollapsed()?Jz(e,t):m.none(),Zo=B,eS=e=>Zo(e)&&e.data[0]===Ze,tS=e=>Zo(e)&&e.data[e.data.length-1]===Ze,nS=e=>{var t;return((t=e.ownerDocument)!==null&&t!==void 0?t:document).createTextNode(Ze)},eH=e=>{var t;if(Zo(e.previousSibling))return tS(e.previousSibling)||e.previousSibling.appendData(Ze),e.previousSibling;if(Zo(e))return eS(e)||e.insertData(0,Ze),e;{const n=nS(e);return(t=e.parentNode)===null||t===void 0||t.insertBefore(n,e),n}},tH=e=>{var t,n;if(Zo(e.nextSibling))return eS(e.nextSibling)||e.nextSibling.insertData(0,Ze),e.nextSibling;if(Zo(e))return tS(e)||e.appendData(Ze),e;{const s=nS(e);return e.nextSibling?(t=e.parentNode)===null||t===void 0||t.insertBefore(s,e.nextSibling):(n=e.parentNode)===null||n===void 0||n.appendChild(s),s}},fl=(e,t)=>e?eH(t):tH(t),nH=K(fl,!0),sH=K(fl,!1),sS=(e,t)=>B(e.container())?fl(t,e.container()):fl(t,e.getNode()),oS=(e,t)=>{const n=t.get();return n&&e.container()===n&&cs(n)},Rd=(e,t)=>t.fold(n=>{Ys(e.get());const s=nH(n);return e.set(s),m.some(N(s,s.length-1))},n=>ht(n).map(s=>{if(oS(s,e)){const o=e.get();return N(o,1)}else{Ys(e.get());const o=sS(s,!0);return e.set(o),N(o,1)}}),n=>on(n).map(s=>{if(oS(s,e)){const o=e.get();return N(o,o.length-1)}else{Ys(e.get());const o=sS(s,!1);return e.set(o),N(o,o.length-1)}}),n=>{Ys(e.get());const s=sH(n);return e.set(s),m.some(N(s,1))}),rS=(e,t)=>{for(let n=0;n<e.length;n++){const s=e[n].apply(null,t);if(s.isSome())return s}return m.none()},Et=Pn.generate([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),aS=(e,t)=>{const n=hs(t,e);return n||e},oH=(e,t,n)=>{const s=hy(n),o=aS(t,s.container());return Ss(e,o,s).fold(()=>_t(o,s).bind(K(Ss,e,o)).map(r=>Et.before(r)),m.none)},rH=(e,t)=>Zs(e,t)===null,iS=(e,t,n)=>Ss(e,t,n).filter(K(rH,t)),aH=(e,t,n)=>{const s=by(n);return iS(e,t,s).bind(o=>Bt(o,s).isNone()?m.some(Et.start(o)):m.none())},iH=(e,t,n)=>{const s=hy(n);return iS(e,t,s).bind(o=>_t(o,s).isNone()?m.some(Et.end(o)):m.none())},lH=(e,t,n)=>{const s=by(n),o=aS(t,s.container());return Ss(e,o,s).fold(()=>Bt(o,s).bind(K(Ss,e,o)).map(r=>Et.after(r)),m.none)},lS=e=>!py(Pd(e)),Fn=(e,t,n)=>rS([oH,aH,iH,lH],[e,t,n]).filter(lS),Pd=e=>e.fold(kt,kt,kt,kt),cS=e=>e.fold(z("before"),z("start"),z("end"),z("after")),dl=e=>e.fold(Et.before,Et.before,Et.after,Et.after),Dd=e=>e.fold(Et.start,Et.start,Et.end,Et.end),cH=(e,t)=>cS(e)===cS(t)&&Pd(e)===Pd(t),uH=(e,t,n,s,o,r)=>mt(Ss(t,n,s),Ss(t,n,o),(a,i)=>a!==i&&TO(n,a,i)?Et.after(e?a:i):r).getOr(r),fH=(e,t)=>e.fold(We,n=>!cH(n,t)),dH=(e,t,n,s,o)=>{const r=Yt(e,o);return Vt(e,n,r).map(K(Yt,e)).fold(()=>s.map(dl),l=>Fn(t,n,l).map(K(uH,e,t,n,r,l)).filter(K(fH,s))).filter(lS)},mH=(e,t)=>e?t.fold(kn(m.some,Et.start),m.none,kn(m.some,Et.after),m.none):t.fold(m.none,kn(m.some,Et.before),m.none,kn(m.some,Et.end)),gH=(e,t,n,s)=>{const o=Yt(e,s),r=Fn(t,n,o);return Fn(t,n,o).bind(K(mH,e)).orThunk(()=>dH(e,t,n,r,s))},pH=e=>ke(e.selection.getSel().modify),uS=(e,t,n)=>{const s=e?1:-1;return t.setRng(N(n.container(),n.offset()+s).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0},hH=(e,t)=>{const n=t.selection.getRng(),s=e?N.fromRangeEnd(n):N.fromRangeStart(n);return pH(t)?e&&Mc(s)?uS(!0,t.selection,s):!e&&Uc(s)?uS(!1,t.selection,s):!1:!1};var Mn;(function(e){e[e.Br=0]="Br",e[e.Block=1]="Block",e[e.Wrap=2]="Wrap",e[e.Eol=3]="Eol"})(Mn||(Mn={}));const ml=(e,t)=>e===tt.Backwards?gr(t):t,bH=(e,t,n)=>e===tt.Forwards?t.next(n):t.prev(n),CH=(e,t,n,s)=>Me(s.getNode(t===tt.Forwards))?Mn.Br:Dn(n,s)===!1?Mn.Block:Mn.Wrap,fS=(e,t,n,s)=>{const o=On(n);let r=s;const a=[];for(;r;){const i=bH(t,o,r);if(!i)break;if(Me(i.getNode(!1)))return t===tt.Forwards?{positions:ml(t,a).concat([i]),breakType:Mn.Br,breakAt:m.some(i)}:{positions:ml(t,a),breakType:Mn.Br,breakAt:m.some(i)};if(!i.isVisible()){r=i;continue}if(e(r,i)){const l=CH(n,t,r,i);return{positions:ml(t,a),breakType:l,breakAt:m.some(i)}}a.push(i),r=i}return{positions:ml(t,a),breakType:Mn.Eol,breakAt:m.none()}},dS=(e,t,n,s)=>t(n,s).breakAt.map(o=>{const r=t(n,o).positions;return e===tt.Backwards?r.concat(o):[o].concat(r)}).getOr([]),Bd=(e,t)=>Tt(e,(n,s)=>n.fold(()=>m.some(s),o=>mt(Rt(o.getClientRects()),Rt(s.getClientRects()),(r,a)=>{const i=Math.abs(t-r.left);return Math.abs(t-a.left)<=i?s:o}).or(n)),m.none()),gl=(e,t)=>Rt(t.getClientRects()).bind(n=>Bd(e,n.left)),wa=K(fS,N.isAbove,-1),ka=K(fS,N.isBelow,1),mS=K(dS,-1,wa),gS=K(dS,1,ka),pS=(e,t)=>wa(e,t).breakAt.isNone(),hS=(e,t)=>ka(e,t).breakAt.isNone(),yH=e=>ht(e).map(t=>[t].concat(ka(e,t).positions)).getOr([]),vH=e=>on(e).map(t=>wa(e,t).positions.concat(t)).getOr([]),EH=(e,t)=>gl(mS(e,t),t),SH=(e,t)=>gl(gS(e,t),t),wH=Be,bS=(e,t)=>Math.abs(e.left-t),CS=(e,t)=>Math.abs(e.right-t),kH=e=>vo(e,"node"),yS=(e,t)=>Ga(e,(n,s)=>{const o=Math.min(bS(n,t),CS(n,t)),r=Math.min(bS(s,t),CS(s,t));return r===o&&kH(s)&&wH(s.node)||r<o?s:n}),xH=e=>{const t=n=>he(n,s=>{const o=Ks(s);return o.node=e,o});if(G(e))return t(e.getClientRects());if(B(e)){const n=e.ownerDocument.createRange();return n.setStart(e,0),n.setEnd(e,e.data.length),t(n.getClientRects())}else return[]},vS=e=>en(e,xH);var xa;(function(e){e[e.Up=-1]="Up",e[e.Down=1]="Down"})(xa||(xa={}));const _H=(e,t,n,s)=>{let o=s;for(;o=Jr(o,e,Sp,t);)if(n(o))return},ES=(e,t,n,s,o,r)=>{let a=0;const i=[],l=f=>{let d=vS([f]);e===-1&&(d=d.reverse());for(let p=0;p<d.length;p++){const b=d[p];if(!n(b,c)){if(i.length>0&&t(b,Ts(i))&&a++,b.line=a,o(b))return!0;i.push(b)}}return!1},c=Ts(r.getClientRects());if(!c)return i;const u=r.getNode();return u&&(l(u),_H(e,s,l,u)),i},NH=(e,t)=>t.line>e,AH=(e,t)=>t.line===e,TH=K(ES,xa.Up,jr,qr),RH=K(ES,xa.Down,qr,jr),SS=e=>Ts(e.getClientRects()),PH=(e,t,n,s)=>{const o=On(t);let r,a,i,l;const c=[];let u=0;e===1?(r=o.next,a=qr,i=jr,l=N.after(s)):(r=o.prev,a=jr,i=qr,l=N.before(s));const f=SS(l);do{if(!l.isVisible())continue;const d=SS(l);if(i(d,f))continue;c.length>0&&a(d,Ts(c))&&u++;const p=Ks(d);if(p.position=l,p.line=u,n(p))return c;c.push(p)}while(l=r(l));return c},wS=e=>t=>NH(e,t),Od=e=>t=>AH(e,t),ns=(e,t)=>{e.selection.setRng(t),la(e,e.selection.getRng())},Id=(e,t,n)=>m.some(kd(e,t,n)),kS=(e,t,n,s,o,r)=>{const a=t===tt.Forwards,i=On(e.getBody()),l=K(Nu,a?i.next:i.prev),c=a?s:o;if(!n.collapsed){const b=vi(n);if(r(b))return ts(t,e,b,t===tt.Backwards,!1);if(Nd(e)){const g=n.cloneRange();return g.collapse(t===tt.Backwards),m.from(g)}}const u=na(t,e.getBody(),n);if(c(u))return Sa(e,u.getNode(!a));let f=l(u);const d=yp(n);if(f)f=Yt(a,f);else return d?m.some(n):m.none();if(c(f))return ts(t,e,f.getNode(!a),a,!1);const p=l(f);return p&&c(p)&&Ai(f,p)?ts(t,e,p.getNode(!a),a,!1):d?Id(e,f.toRange(),!1):m.none()},xS=(e,t,n,s,o,r)=>{const a=na(t,e.getBody(),n),i=Ts(a.getClientRects()),l=t===xa.Down,c=e.getBody();if(!i)return m.none();if(Nd(e)){const h=l?N.fromRangeEnd(n):N.fromRangeStart(n);return(l?SH:EH)(c,h).orThunk(()=>m.from(h)).map(E=>E.toRange())}const f=(l?RH:TH)(c,wS(1),a),d=oe(f,Od(1)),p=i.left,b=yS(d,p);if(b&&r(b.node)){const h=Math.abs(p-b.left),y=Math.abs(p-b.right);return ts(t,e,b.node,h<y,!1)}let g;if(s(a)?g=a.getNode():o(a)?g=a.getNode(!0):g=vi(n),g){const h=PH(t,c,wS(1),g);let y=yS(oe(h,Od(1)),p);if(y||(y=Ts(oe(h,Od(0))),y))return Id(e,y.position.toRange(),!1)}return d.length===0?Ld(e,l).filter(l?o:s).map(h=>kd(e,h.toRange(),!1)):m.none()},Ld=(e,t)=>{const n=e.selection.getRng(),s=t?N.fromRangeEnd(n):N.fromRangeStart(n),o=xP(s.container(),e.getBody());if(t){const r=ka(o,s);return As(r.positions)}else{const r=wa(o,s);return Rt(r.positions)}},_S=(e,t,n)=>Ld(e,t).filter(n).exists(s=>(e.selection.setRng(s.toRange()),!0)),pl=(e,t)=>{const n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)},NS=(e,t)=>{e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")},AS=(e,t,n)=>Rd(t,n).map(s=>(pl(e,s),n)),DH=(e,t,n)=>{const s=N.fromRangeStart(e);if(e.collapsed)return s;{const o=N.fromRangeEnd(e);return n?Bt(t,o).getOr(o):_t(t,s).getOr(s)}},BH=(e,t,n)=>{const s=e.getBody(),o=DH(e.selection.getRng(),s,n),r=K(so,e);return gH(n,r,s,o).bind(i=>AS(e,t,i))},OH=(e,t,n)=>{const s=he(gt(C.fromDom(t.getRoot()),'*[data-mce-selected="inline-boundary"]'),a=>a.dom),o=oe(s,e),r=oe(n,e);P(Wa(o,r),K(NS,!1)),P(Wa(r,o),K(NS,!0))},IH=(e,t)=>{const n=t.get();if(e.selection.isCollapsed()&&!e.composing&&n){const s=N.fromRangeStart(e.selection.getRng());N.isTextPosition(s)&&!RO(s)&&(pl(e,mP(n,s)),t.set(null))}},LH=(e,t,n,s)=>{if(t.selection.isCollapsed()){const o=oe(s,e);P(o,r=>{const a=N.fromRangeStart(t.selection.getRng());Fn(e,t.getBody(),a).bind(i=>AS(t,n,i))})}},TS=(e,t,n)=>Xr(e)?BH(e,t,n).isSome():!1,RS=(e,t,n)=>Xr(t)?hH(e,t):!1,$H=e=>{const t=et(null),n=K(so,e);return e.on("NodeChange",s=>{Xr(e)&&(OH(n,e.dom,s.parents),IH(e,t),LH(n,e,t,s.parents))}),t},FH=K(RS,!0),MH=K(RS,!1),hl=(e,t,n)=>{if(Xr(e)){const s=Ld(e,t).getOrThunk(()=>{const o=e.selection.getRng();return t?N.fromRangeEnd(o):N.fromRangeStart(o)});return Fn(K(so,e),e.getBody(),s).exists(o=>{const r=dl(o);return Rd(n,r).exists(a=>(pl(e,a),!0))})}else return!1},UH=(e,t)=>{const n=document.createRange();return n.setStart(e.container(),e.offset()),n.setEnd(t.container(),t.offset()),n},zH=e=>mt(ht(e),on(e),(t,n)=>{const s=Yt(!0,t),o=Yt(!1,n);return _t(e,s).forall(r=>r.isEqual(o))}).getOr(!0),PS=(e,t)=>n=>Rd(t,n).map(s=>()=>pl(e,s)),DS=(e,t,n,s)=>{const o=e.getBody(),r=K(so,e);e.undoManager.ignore(()=>{e.selection.setRng(UH(n,s)),Ef(e),Fn(r,o,N.fromRangeStart(e.selection.getRng())).map(Dd).bind(PS(e,t)).each(fr)}),e.nodeChanged()},HH=(e,t)=>{const n=hs(t,e);return n||e},WH=(e,t,n,s)=>{const o=HH(e.getBody(),s.container()),r=K(so,e),a=Fn(r,o,s);return a.bind(l=>n?l.fold(z(m.some(Dd(l))),m.none,z(m.some(dl(l))),m.none):l.fold(m.none,z(m.some(dl(l))),m.none,z(m.some(Dd(l))))).map(PS(e,t)).getOrThunk(()=>{const l=Fo(n,o,s),c=l.bind(u=>Fn(r,o,u));return mt(a,c,()=>Ss(r,o,s).bind(u=>zH(u)?m.some(()=>{no(e,n,C.fromDom(u))}):m.none())).getOrThunk(()=>c.bind(()=>l.map(u=>()=>{n?DS(e,t,s,u):DS(e,t,u,s)})))})},$d=(e,t,n)=>{if(e.selection.isCollapsed()&&Xr(e)){const s=N.fromRangeStart(e.selection.getRng());return WH(e,t,n,s)}return m.none()},VH=e=>xc(e)>1,BS=(e,t)=>{const n=C.fromDom(e.getBody()),s=C.fromDom(e.selection.getStart()),o=es(s,n);return mr(o,t).fold(z(o),r=>o.slice(0,r))},jH=e=>xc(e)===1,qH=e=>BS(e,t=>e.schema.isBlock(pe(t))||VH(t)),KH=e=>BS(e,t=>e.schema.isBlock(pe(t))),OS=(e,t)=>{const n=K(Gy,e);return en(t,s=>n(s)?[s.dom]:[])},IS=e=>{const t=KH(e);return OS(e,t)},GH=(e,t,n,s)=>{const o=OS(t,s);if(o.length===0)no(t,e,n);else{const r=Ky(n.dom,o);t.selection.setRng(r.toRange())}},YH=(e,t)=>{const n=oe(qH(e),jH);return As(n).bind(s=>{const o=N.fromRangeStart(e.selection.getRng());return yy(t,o,s.dom)&&!ju(s)?m.some(()=>GH(t,e,s,n)):m.none()})},XH=(e,t)=>{const n=t.parentElement;return Me(t)&&!wt(n)&&e.dom.isEmpty(n)},ZH=e=>ju(C.fromDom(e)),LS=(e,t)=>{const n=e.selection.getStart(),s=XH(e,n)||ZH(n)?Ky(n,t):wL(e.selection.getRng(),t);e.selection.setRng(s.toRange())},QH=(e,t)=>{const n=Wa(t,IS(e));n.length>0&&LS(e,n)},$S=e=>B(e.startContainer),JH=e=>e.startOffset===0&&$S(e),e2=(e,t)=>{const n=t.startContainer.parentElement;return!wt(n)&&Gy(e,C.fromDom(n))},t2=e=>{const t=e.startContainer.parentNode,n=e.endContainer.parentNode;return!wt(t)&&!wt(n)&&t.isEqualNode(n)},n2=e=>{const t=e.endContainer;return e.endOffset===(B(t)?t.length:t.childNodes.length)},s2=e=>t2(e)&&n2(e),o2=e=>!e.endContainer.isEqualNode(e.commonAncestorContainer),r2=e=>s2(e)||o2(e),a2=e=>{const t=e.selection.getRng();return JH(t)&&e2(e,t)&&r2(t)},i2=e=>{if(a2(e)){const t=IS(e);return m.some(()=>{Ef(e),QH(e,t)})}else return m.none()},Fd=(e,t)=>e.selection.isCollapsed()?YH(e,t):i2(e),l2=(e,t)=>IO(e,n=>jt(n.dom),n=>t.isBlock(pe(n))),c2=e=>l2(C.fromDom(e.selection.getStart()),e.schema),u2=e=>{const t=e.selection.getRng();return t.collapsed&&($S(t)||e.dom.isEmpty(t.startContainer))&&!c2(e)},_a=e=>(u2(e)&&LS(e,[]),!0),Md=(e,t,n)=>M(n)?m.some(()=>{e._selectionOverrides.hideFakeCaret(),no(e,t,C.fromDom(n))}):m.none(),f2=(e,t)=>{const n=t?ca:ua,s=t?tt.Forwards:tt.Backwards,o=na(s,e.getBody(),e.selection.getRng());return n(o)?Md(e,t,o.getNode(!t)):m.from(Yt(t,o)).filter(r=>n(r)&&Ai(o,r)).bind(r=>Md(e,t,r.getNode(!t)))},d2=(e,t)=>{const n=e.selection.getNode();return Rn(n)?Md(e,t,n):m.none()},Ud=(e,t)=>e.selection.isCollapsed()?f2(e,t):d2(e,t),m2=e=>Bs(e,t=>nn(t.dom)||Be(t.dom)).exists(t=>nn(t.dom)),zd=e=>Ya(e??"").getOr(0),FS=(e,t)=>{const n=e||fN(t)?"margin":"padding",s=Tn(t,"direction")==="rtl"?"-right":"-left";return n+s},g2=(e,t,n,s,o,r)=>{const a=FS(n,C.fromDom(r)),i=zd(e.getStyle(r,a));if(t==="outdent"){const l=Math.max(0,i-s);e.setStyle(r,a,l?l+o:"")}else{const l=i+s+o;e.setStyle(r,a,l)}},p2=(e,t)=>rs(t,n=>{const s=FS(Hh(e),n),o=ti(n,s).map(zd).getOr(0);return e.dom.getContentEditable(n.dom)!=="false"&&o>0}),MS=e=>{const t=zS(e);return!e.mode.isReadOnly()&&(t.length>1||p2(e,t))},US=e=>Fc(e)||Dr(e),h2=e=>tn(e).exists(US),zS=e=>oe(Rc(e.selection.getSelectedBlocks()),t=>!US(t)&&!h2(t)&&m2(t)),HS=(e,t)=>{var n,s;const{dom:o}=e,r=sR(e),a=(s=(n=/[a-z%]+$/i.exec(r))===null||n===void 0?void 0:n[0])!==null&&s!==void 0?s:"px",i=zd(r),l=Hh(e);P(zS(e),c=>{g2(o,t,l,i,a,c.dom)})},b2=e=>HS(e,"indent"),WS=e=>HS(e,"outdent"),VS=e=>{if(e.selection.isCollapsed()&&MS(e)){const t=e.dom,n=e.selection.getRng(),s=N.fromRangeStart(n),o=t.getParent(n.startContainer,t.isBlock);if(o!==null&&gf(C.fromDom(o),s,e.schema))return m.some(()=>WS(e))}return m.none()},jS=(e,t,n)=>yo([VS,Ad,xd,(s,o)=>$d(s,t,o),Sd,Rf,Td,Ud,wd,Fd],s=>s(e,n)).filter(s=>e.selection.isEditable()),C2=(e,t)=>{jS(e,t,!1).fold(()=>{e.selection.isEditable()&&(Ef(e),Sf(e))},fr)},y2=(e,t)=>{jS(e,t,!0).fold(()=>{e.selection.isEditable()&&DO(e)},fr)},v2=(e,t)=>{e.addCommand("delete",()=>{C2(e,t)}),e.addCommand("forwardDelete",()=>{y2(e,t)})},qS=5,E2=400,KS=e=>e.touches===void 0||e.touches.length!==1?m.none():m.some(e.touches[0]),S2=(e,t)=>{const n=Math.abs(e.clientX-t.x),s=Math.abs(e.clientY-t.y);return n>qS||s>qS},w2=e=>{const t=ms(),n=et(!1),s=lu(o=>{e.dispatch("longpress",{...o,type:"longpress"}),n.set(!0)},E2);e.on("touchstart",o=>{KS(o).each(r=>{s.cancel();const a={x:r.clientX,y:r.clientY,target:o.target};s.throttle(o),n.set(!1),t.set(a)})},!0),e.on("touchmove",o=>{s.cancel(),KS(o).each(r=>{t.on(a=>{S2(r,a)&&(t.clear(),n.set(!1),e.dispatch("longpresscancel"))})})},!0),e.on("touchend touchcancel",o=>{s.cancel(),o.type!=="touchcancel"&&t.get().filter(r=>r.target.isEqualNode(o.target)).each(()=>{n.get()?o.preventDefault():e.dispatch("tap",{...o,type:"tap"})})},!0)},Hd=(e,t)=>re(e,t.nodeName),k2=(e,t)=>B(t)?!0:G(t)?!Hd(e.getBlockElements(),t)&&!qt(t)&&!zs(e,t)&&!Wc(t):!1,x2=(e,t,n)=>Ue(XC(C.fromDom(n),C.fromDom(t)),s=>Hd(e,s.dom)),_2=(e,t)=>{if(B(t)){if(t.data.length===0)return!0;if(/^\s+$/.test(t.data))return!t.nextSibling||Hd(e,t.nextSibling)||Wc(t.nextSibling)}return!1},GS=e=>e.dom.create(pt(e),Yr(e)),N2=e=>{const t=e.dom,n=e.selection,s=e.schema,o=s.getBlockElements(),r=n.getStart(),a=e.getBody();let i,l,c=!1;const u=pt(e);if(!r||!G(r))return;const f=a.nodeName.toLowerCase();if(!s.isValidChild(f,u.toLowerCase())||x2(o,a,r))return;const d=n.getRng(),{startContainer:p,startOffset:b,endContainer:g,endOffset:h}=d,y=to(e);let E=a.firstChild;for(;E;)if(G(E)&&YN(s,E),k2(s,E)){if(_2(o,E)){l=E,E=E.nextSibling,t.remove(l);continue}i||(i=GS(e),a.insertBefore(i,E),c=!0),l=E,E=E.nextSibling,i.appendChild(l)}else i=null,E=E.nextSibling;c&&y&&(d.setStart(p,b),d.setEnd(g,h),n.setRng(d),e.nodeChanged())},YS=(e,t,n)=>{const s=C.fromDom(GS(e)),o=Or();Ve(s,o),n(t,s);const r=document.createRange();return r.setStartBefore(o.dom),r.setEndBefore(o.dom),r},A2=e=>{e.on("NodeChange",K(N2,e))},XS=e=>t=>(" "+t.attr("class")+" ").indexOf(e)!==-1,T2=(e,t,n)=>function(s){const o=arguments,r=o[o.length-2],a=r>0?t.charAt(r-1):"";if(a==='"')return s;if(a===">"){const i=t.lastIndexOf("<",r);if(i!==-1&&t.substring(i,r).indexOf('contenteditable="false"')!==-1)return s}return'<span class="'+n+'" data-mce-content="'+e.dom.encode(o[0])+'">'+e.dom.encode(typeof o[1]=="string"?o[1]:o[0])+"</span>"},R2=(e,t,n)=>{let s=t.length,o=n.content;if(n.format!=="raw"){for(;s--;)o=o.replace(t[s],T2(e,o,Yh(e)));n.content=o}},P2=e=>{const t="contenteditable",n=" "+$.trim(YR(e))+" ",s=" "+$.trim(Yh(e))+" ",o=XS(n),r=XS(s),a=XR(e);a.length>0&&e.on("BeforeSetContent",i=>{R2(e,a,i)}),e.parser.addAttributeFilter("class",i=>{let l=i.length;for(;l--;){const c=i[l];o(c)?c.attr(t,"true"):r(c)&&c.attr(t,"false")}}),e.serializer.addAttributeFilter(t,i=>{let l=i.length;for(;l--;){const c=i[l];!o(c)&&!r(c)||(a.length>0&&c.attr("data-mce-content")?(c.name="#text",c.type=3,c.raw=!0,c.value=c.attr("data-mce-content")):c.attr(t,null))}})},D2=e=>Nr(C.fromDom(e.getBody()),"*[data-mce-caret]").map(t=>t.dom).getOrNull(),ZS=(e,t)=>{t.hasAttribute("data-mce-caret")&&(zc(t),e.selection.setRng(e.selection.getRng()),e.selection.scrollIntoView(t))},B2=(e,t)=>{const n=D2(e);if(n){if(t.type==="compositionstart"){t.preventDefault(),t.stopPropagation(),ZS(e,n);return}Cp(n)&&(ZS(e,n),e.undoManager.add())}},O2=e=>{e.on("keyup compositionstart",K(B2,e))},QS=Be,I2=(e,t,n)=>kS(t,e,n,vs,Es,QS),L2=(e,t,n)=>xS(t,e,n,r=>vs(r)||GC(r),r=>Es(r)||YC(r),QS),$2=e=>{const t=e.dom.create(pt(e));return t.innerHTML='<br data-mce-bogus="1">',t},JS=(e,t,n)=>{const s=On(e.getBody()),o=K(Nu,t===1?s.next:s.prev);if(n.collapsed){const r=e.dom.getParent(n.startContainer,"PRE");if(!r)return;if(!o(N.fromRangeStart(n))){const i=C.fromDom($2(e));t===1?Gn(C.fromDom(r),i):Dt(C.fromDom(r),i),e.selection.select(i.dom,!0),e.selection.collapse()}}},F2=(e,t)=>{const n=t?tt.Forwards:tt.Backwards,s=e.selection.getRng();return I2(n,e,s).orThunk(()=>(JS(e,n,s),m.none()))},M2=(e,t)=>{const n=t?1:-1,s=e.selection.getRng();return L2(n,e,s).orThunk(()=>(JS(e,n,s),m.none()))},U2=(e,t)=>{const n=t?e.getEnd(!0):e.getStart(!0);return py(n)?!t:t},e0=(e,t)=>F2(e,U2(e.selection,t)).exists(n=>(ns(e,n),!0)),t0=(e,t)=>M2(e,t).exists(n=>(ns(e,n),!0)),n0=(e,t)=>_S(e,t,t?Es:vs),bl=(e,t)=>_d(e,!t).map(n=>{const s=n.toRange(),o=e.selection.getRng();return t?s.setStart(o.startContainer,o.startOffset):s.setEnd(o.endContainer,o.endOffset),s}).exists(n=>(ns(e,n),!0)),z2=e=>Ne(["figcaption"],pe(e)),H2=(e,t,n)=>{const s=K(ve,t);return Bs(C.fromDom(e.container()),o=>n.isBlock(pe(o)),s).filter(z2)},W2=(e,t,n)=>t?hS(e.dom,n):pS(e.dom,n),V2=(e,t)=>{const n=C.fromDom(e.getBody()),s=N.fromRangeStart(e.selection.getRng());return H2(s,n,e.schema).exists(()=>{if(W2(n,t,s)){const r=YS(e,n,t?Ve:Tc);return e.selection.setRng(r),!0}else return!1})},s0=(e,t)=>e.selection.isCollapsed()?V2(e,t):!1,j2=(e,t,n)=>{const s=e.selection.getRng(),o=N.fromRangeStart(s);return e.getBody().firstChild===t&&pS(n,o)?(e.execCommand("InsertNewBlockBefore"),!0):!1},q2=(e,t)=>{const n=e.selection.getRng(),s=N.fromRangeStart(n);return e.getBody().lastChild===t&&hS(t,s)?(e.execCommand("InsertNewBlockAfter"),!0):!1},K2=(e,t)=>t?m.from(e.dom.getParent(e.selection.getNode(),"details")).map(n=>q2(e,n)).getOr(!1):m.from(e.dom.getParent(e.selection.getNode(),"summary")).bind(n=>m.from(e.dom.getParent(n,"details")).map(s=>j2(e,s,n))).getOr(!1),o0=(e,t)=>K2(e,t),r0={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0},G2=e=>he(e,t=>({...r0,...t})),Y2=e=>he(e,t=>({...r0,...t})),a0=(e,t)=>t.keyCode===e.keyCode&&t.shiftKey===e.shiftKey&&t.altKey===e.altKey&&t.ctrlKey===e.ctrlKey&&t.metaKey===e.metaKey,X2=(e,t)=>en(G2(e),n=>a0(n,t)?[n]:[]),Z2=(e,t)=>en(Y2(e),n=>a0(n,t)?[n]:[]),ne=(e,...t)=>()=>e.apply(null,t),Na=(e,t)=>Ye(X2(e,t),n=>n.action()),i0=(e,t)=>yo(Z2(e,t),n=>n.action()),l0=(e,t)=>{const n=t?tt.Forwards:tt.Backwards,s=e.selection.getRng();return kS(e,n,s,ca,ua,Rn).exists(o=>(ns(e,o),!0))},c0=(e,t)=>{const n=t?1:-1,s=e.selection.getRng();return xS(e,n,s,ca,ua,Rn).exists(o=>(ns(e,o),!0))},u0=(e,t)=>_S(e,t,t?ua:ca),f0=Pn.generate([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Aa={...f0,none:e=>f0.none(e)},Q2=(e,t)=>d0(e,t,We),d0=(e,t,n)=>en(rt(e),s=>mn(s,t)?n(s)?[s]:[]:d0(s,t,n)),J2=(e,t,n=$e)=>{if(n(t))return m.none();if(Ne(e,pe(t)))return m.some(t);const s=o=>mn(o,"table")||n(o);return _r(t,e.join(","),s)},eW=(e,t)=>J2(["td","th"],e,t),tW=e=>Q2(e,"th,td"),m0=(e,t)=>Os(e,"table",t),Wd=(e,t,n,s,o=We)=>{const r=s===1;if(!r&&n<=0)return Aa.first(e[0]);if(r&&n>=e.length-1)return Aa.last(e[e.length-1]);{const a=n+s,i=e[a];return o(i)?Aa.middle(t,i):Wd(e,t,a,s,o)}},g0=(e,t)=>m0(e,t).bind(n=>{const s=tW(n);return mr(s,r=>ve(e,r)).map(r=>({index:r,all:s}))}),nW=(e,t,n)=>g0(e,n).fold(()=>Aa.none(e),o=>Wd(o.all,e,o.index,1,t)),sW=(e,t,n)=>g0(e,n).fold(()=>Aa.none(),o=>Wd(o.all,e,o.index,-1,t)),oW=(e,t)=>({left:e.left-t,top:e.top-t,right:e.right+t*2,bottom:e.bottom+t*2,width:e.width+t,height:e.height+t}),rW=(e,t)=>en(t,n=>{const s=oW(Ks(n.getBoundingClientRect()),-1);return[{x:s.left,y:e(s),cell:n},{x:s.right,y:e(s),cell:n}]}),aW=(e,t,n)=>Tt(e,(s,o)=>s.fold(()=>m.some(o),r=>{const a=Math.sqrt(Math.abs(r.x-t)+Math.abs(r.y-n)),i=Math.sqrt(Math.abs(o.x-t)+Math.abs(o.y-n));return m.some(i<a?o:r)}),m.none()),p0=(e,t,n,s,o)=>{const r=gt(C.fromDom(n),"td,th,caption").map(i=>i.dom),a=oe(rW(e,r),i=>t(i,o));return aW(a,s,o).map(i=>i.cell)},iW=e=>e.bottom,lW=e=>e.top,cW=(e,t)=>e.y<t,uW=(e,t)=>e.y>t,fW=K(p0,iW,cW),dW=K(p0,lW,uW),mW=(e,t)=>Rt(t.getClientRects()).bind(n=>fW(e,n.left,n.top)).bind(n=>gl(vH(n),t)),gW=(e,t)=>As(t.getClientRects()).bind(n=>dW(e,n.left,n.top)).bind(n=>gl(yH(n),t)),pW=(e,t,n)=>n.breakAt.exists(s=>e(t,s).breakAt.isSome()),hW=e=>e.breakType===Mn.Wrap&&e.positions.length===0,bW=e=>e.breakType===Mn.Br&&e.positions.length===1,h0=(e,t,n)=>{const s=e(t,n);return hW(s)||!Me(n.getNode())&&bW(s)?!pW(e,t,s):s.breakAt.isNone()},CW=K(h0,wa),yW=K(h0,ka),vW=(e,t,n)=>{const s=N.fromRangeStart(t);return Mo(!e,n).exists(o=>o.isEqual(s))},EW=(e,t,n,s)=>{const o=e.selection.getRng(),r=t?1:-1;return sb()&&vW(t,o,n)?(ts(r,e,n,!t,!1).each(a=>{ns(e,a)}),!0):!1},SW=(e,t,n)=>mW(t,n).orThunk(()=>Rt(n.getClientRects()).bind(s=>Bd(mS(e,N.before(t)),s.left))).getOr(N.before(t)),wW=(e,t,n)=>gW(t,n).orThunk(()=>Rt(n.getClientRects()).bind(s=>Bd(gS(e,N.after(t)),s.left))).getOr(N.after(t)),b0=(e,t)=>{const n=t.getNode(e);return Zn(n)?m.some(n):m.none()},kW=(e,t,n)=>{t.undoManager.transact(()=>{const s=e?Gn:Dt,o=YS(t,C.fromDom(n),s);ns(t,o)})},C0=(e,t,n)=>{const s=b0(!!t,n),o=t===!1;s.fold(()=>ns(e,n.toRange()),r=>Mo(o,e.getBody()).filter(a=>a.isEqual(n)).fold(()=>ns(e,n.toRange()),a=>kW(t,e,r)))},xW=(e,t,n,s)=>{const o=e.selection.getRng(),r=N.fromRangeStart(o),a=e.getBody();if(!t&&CW(s,r)){const i=SW(a,n,r);return C0(e,t,i),!0}else if(t&&yW(s,r)){const i=wW(a,n,r);return C0(e,t,i),!0}else return!1},y0=(e,t,n)=>m.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind(s=>m.from(e.dom.getParent(s,"table")).map(o=>n(e,t,o,s))).getOr(!1),v0=(e,t)=>y0(e,t,EW),Vd=(e,t)=>y0(e,t,xW),_W=e=>{const t=Vo.exact(e,0,e,0);return f1(t)},E0=(e,t,n)=>n.fold(m.none,m.none,(s,o)=>bB(o).map(r=>_W(r)),s=>(e.execCommand("mceTableInsertRowAfter"),S0(e,t,s))),S0=(e,t,n)=>E0(e,t,nW(n,Is)),NW=(e,t,n)=>E0(e,t,sW(n,Is)),w0=(e,t)=>{const n=["table","li","dl"],s=C.fromDom(e.getBody()),o=i=>{const l=pe(i);return ve(i,s)||Ne(n,l)},r=e.selection.getRng(),a=C.fromDom(t?r.endContainer:r.startContainer);return eW(a,o).map(i=>(m0(i,o).each(u=>{e.model.table.clearSelectedCells(u.dom)}),e.selection.collapse(!t),(t?S0:NW)(e,o,i).each(u=>{e.selection.setRng(u)}),!0)).getOr(!1)},AW=(e,t,n)=>{const s=be.os.isMacOS()||be.os.isiOS();Na([{keyCode:H.RIGHT,action:ne(e0,e,!0)},{keyCode:H.LEFT,action:ne(e0,e,!1)},{keyCode:H.UP,action:ne(t0,e,!1)},{keyCode:H.DOWN,action:ne(t0,e,!0)},...s?[{keyCode:H.UP,action:ne(bl,e,!1),metaKey:!0,shiftKey:!0},{keyCode:H.DOWN,action:ne(bl,e,!0),metaKey:!0,shiftKey:!0}]:[],{keyCode:H.RIGHT,action:ne(v0,e,!0)},{keyCode:H.LEFT,action:ne(v0,e,!1)},{keyCode:H.UP,action:ne(Vd,e,!1)},{keyCode:H.DOWN,action:ne(Vd,e,!0)},{keyCode:H.UP,action:ne(Vd,e,!1)},{keyCode:H.UP,action:ne(o0,e,!1)},{keyCode:H.DOWN,action:ne(o0,e,!0)},{keyCode:H.RIGHT,action:ne(l0,e,!0)},{keyCode:H.LEFT,action:ne(l0,e,!1)},{keyCode:H.UP,action:ne(c0,e,!1)},{keyCode:H.DOWN,action:ne(c0,e,!0)},{keyCode:H.RIGHT,action:ne(TS,e,t,!0)},{keyCode:H.LEFT,action:ne(TS,e,t,!1)},{keyCode:H.RIGHT,ctrlKey:!s,altKey:s,action:ne(FH,e,t)},{keyCode:H.LEFT,ctrlKey:!s,altKey:s,action:ne(MH,e,t)},{keyCode:H.UP,action:ne(s0,e,!1)},{keyCode:H.DOWN,action:ne(s0,e,!0)}],n).each(o=>{n.preventDefault()})},TW=(e,t)=>{e.on("keydown",n=>{n.isDefaultPrevented()||AW(e,t,n)})},vn=(e,t)=>({container:e,offset:t}),Cl=Ae.DOM,yl=e=>t=>e===t?-1:0,RW=e=>t=>e.isBlock(t)||Ne(["BR","IMG","HR","INPUT"],t.nodeName)||e.getContentEditable(t)==="false",jd=(e,t,n)=>{if(B(e)&&t>=0)return m.some(vn(e,t));{const s=qs(Cl);return m.from(s.backwards(e,t,yl(e),n)).map(o=>vn(o.container,o.container.data.length))}},PW=(e,t,n)=>{if(B(e)&&t>=e.length)return m.some(vn(e,t));{const s=qs(Cl);return m.from(s.forwards(e,t,yl(e),n)).map(o=>vn(o.container,0))}},qd=(e,t,n)=>{if(!B(e))return m.none();const s=e.data;if(t>=0&&t<=s.length)return m.some(vn(e,t));{const o=qs(Cl);return m.from(o.backwards(e,t,yl(e),n)).bind(r=>{const a=r.container.data;return qd(r.container,t+a.length,n)})}},k0=(e,t,n)=>{if(!B(e))return m.none();const s=e.data;if(t<=s.length)return m.some(vn(e,t));{const o=qs(Cl);return m.from(o.forwards(e,t,yl(e),n)).bind(r=>k0(r.container,t-s.length,n))}},Kd=(e,t,n,s,o)=>{const r=qs(e,RW(e));return m.from(r.backwards(t,n,s,o))},DW=e=>e.collapsed&&B(e.startContainer),x0=e=>Mt(e.toString().replace(/\u00A0/g," ")),_0=e=>e!==""&&`  \f
\r	\v`.indexOf(e)!==-1,Gd=(e,t)=>e.substring(t.length),BW=(e,t,n)=>{let s;const o=n.charAt(0);for(s=t-1;s>=0;s--){const r=e.charAt(s);if(_0(r))return m.none();if(o===r&&dt(e,n,s,t))break}return m.some(s)},OW=(e,t,n,s=0)=>{if(!DW(t))return m.none();const o={text:"",offset:0},r=(i,l,c)=>(o.text=c+o.text,o.offset+=l,BW(o.text,o.offset,n).getOr(l)),a=e.getParent(t.startContainer,e.isBlock)||e.getRoot();return Kd(e,t.startContainer,t.startOffset,r,a).bind(i=>{const l=t.cloneRange();if(l.setStart(i.container,i.offset),l.setEnd(t.endContainer,t.endOffset),l.collapsed)return m.none();const c=x0(l);return c.lastIndexOf(n)!==0||Gd(c,n).length<s?m.none():m.some({text:Gd(c,n),range:l,trigger:n})})},N0=(e,t,n,s=0)=>EB(C.fromDom(t.startContainer)).fold(()=>OW(e,t,n,s),o=>{const r=e.createRng();r.selectNode(o.dom);const a=x0(r);return m.some({range:r,text:Gd(a,n),trigger:n})}),IW=e=>e.nodeType===Lg,LW=e=>e.nodeType===yr,A0=e=>{if(IW(e))return vn(e,e.data.length);{const t=e.childNodes;return t.length>0?A0(t[t.length-1]):vn(e,t.length)}},T0=(e,t)=>{const n=e.childNodes;return n.length>0&&t<n.length?T0(n[t],0):n.length>0&&LW(e)&&n.length===t?A0(n[n.length-1]):vn(e,t)},$W=(e,t)=>{var n;const s=(n=e.getParent(t.container,e.isBlock))!==null&&n!==void 0?n:e.getRoot();return Kd(e,t.container,t.offset,(o,r)=>r===0?-1:r,s).filter(o=>{const r=o.container.data.charAt(o.offset-1);return!_0(r)}).isSome()},FW=e=>t=>{const n=T0(t.startContainer,t.startOffset);return!$W(e,n)},MW=(e,t,n)=>yo(n.triggers,s=>N0(e,t,s)),UW=(e,t)=>{const n=t(),s=e.selection.getRng();return MW(e.dom,s,n).bind(o=>R0(e,t,o))},R0=(e,t,n,s={})=>{var o;const r=t(),i=(o=e.selection.getRng().startContainer.nodeValue)!==null&&o!==void 0?o:"",l=oe(r.lookupByTrigger(n.trigger),u=>n.text.length>=u.minChars&&u.matches.getOrThunk(()=>FW(e.dom))(n.range,i,n.text));if(l.length===0)return m.none();const c=Promise.all(he(l,u=>u.fetch(n.text,u.maxResults,s).then(d=>({matchText:n.text,items:d,columns:u.columns,onAction:u.onAction,highlightOn:u.highlightOn}))));return m.some({lookupData:c,context:n})};var En;(function(e){e[e.Error=0]="Error",e[e.Value=1]="Value"})(En||(En={}));const Yd=(e,t,n)=>e.stype===En.Error?t(e.serror):n(e.svalue),zW=e=>{const t=[],n=[];return P(e,s=>{Yd(s,o=>n.push(o),o=>t.push(o))}),{values:t,errors:n}},HW=(e,t)=>e.stype===En.Error?{stype:En.Error,serror:t(e.serror)}:e,WW=(e,t)=>e.stype===En.Value?{stype:En.Value,svalue:t(e.svalue)}:e,VW=(e,t)=>e.stype===En.Value?t(e.svalue):e,jW=(e,t)=>e.stype===En.Error?t(e.serror):e,P0=e=>({stype:En.Value,svalue:e}),D0=e=>({stype:En.Error,serror:e}),at={fromResult:e=>e.fold(D0,P0),toResult:e=>Yd(e,xt.error,xt.value),svalue:P0,partition:zW,serror:D0,bind:VW,bindError:jW,map:WW,mapError:HW,fold:Yd},Xd=e=>Ct(e)&&Pt(e).length>100?" removed due to size":JSON.stringify(e,null,2),qW=e=>{const t=e.length>10?e.slice(0,10).concat([{path:[],getErrorInfo:z("... (only showing first ten failures)")}]):e;return he(t,n=>"Failed path: ("+n.path.join(" > ")+`)
`+n.getErrorInfo())},vl=(e,t)=>at.serror([{path:e,getErrorInfo:t}]),KW=(e,t,n)=>vl(e,()=>'Could not find valid *required* value for "'+t+'" in '+Xd(n)),GW=(e,t)=>vl(e,()=>'Choice schema did not contain choice key: "'+t+'"'),YW=(e,t,n)=>vl(e,()=>'The chosen schema: "'+n+'" did not exist in branches: '+Xd(t)),XW=(e,t)=>vl(e,z(t)),ZW=(e,t,n,s)=>Pe(n,s).fold(()=>YW(e,n,s),r=>r.extract(e.concat(["branch: "+s]),t)),QW=(e,t)=>({extract:(o,r)=>Pe(r,e).fold(()=>GW(o,e),i=>ZW(o,r,t,i)),toString:()=>"chooseOn("+e+"). Possible values: "+Pt(t)}),JW=(e,t)=>t,e3=(e,t)=>Km(e)&&Km(t)?El(e,t):t,B0=e=>(...t)=>{if(t.length===0)throw new Error("Can't merge zero objects");const n={};for(let s=0;s<t.length;s++){const o=t[s];for(const r in o)re(o,r)&&(n[r]=e(n[r],o[r]))}return n},El=B0(e3),t3=B0(JW),O0=()=>({tag:"required",process:{}}),n3=e=>({tag:"defaultedThunk",process:e}),I0=e=>n3(z(e)),s3=()=>({tag:"option",process:{}}),o3=(e,t)=>e.length>0?at.svalue(El(t,t3.apply(void 0,e))):at.svalue(t),L0=e=>kn(at.serror,eg)(e),r3={consolidateObj:(e,t)=>{const n=at.partition(e);return n.errors.length>0?L0(n.errors):o3(n.values,t)},consolidateArr:e=>{const t=at.partition(e);return t.errors.length>0?L0(t.errors):at.svalue(t.values)}},a3=(e,t,n,s)=>({tag:"field",key:e,newKey:t,presence:n,prop:s}),i3=(e,t)=>({tag:"custom",newKey:e,instantiator:t}),$0=(e,t,n)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return n(e.newKey,e.instantiator)}},Zd=e=>{const t=(s,o)=>at.bindError(e(o),r=>XW(s,r)),n=z("val");return{extract:t,toString:n}},l3=Zd(at.svalue),c3=(e,t,n,s)=>Pe(t,n).fold(()=>KW(e,n,t),s),F0=(e,t,n,s)=>{const o=Pe(e,t).getOrThunk(()=>n(e));return s(o)},u3=(e,t,n)=>n(Pe(e,t)),f3=(e,t,n,s)=>{const o=Pe(e,t).map(r=>r===!0?n(e):r);return s(o)},d3=(e,t,n,s,o)=>{const r=i=>o.extract(t.concat([s]),i),a=i=>i.fold(()=>at.svalue(m.none()),l=>{const c=o.extract(t.concat([s]),l);return at.map(c,m.some)});switch(e.tag){case"required":return c3(t,n,s,r);case"defaultedThunk":return F0(n,s,e.process,r);case"option":return u3(n,s,a);case"defaultedOptionThunk":return f3(n,s,e.process,a);case"mergeWithThunk":return F0(n,s,z({}),i=>{const l=El(e.process(n),i);return r(l)})}},m3=(e,t,n)=>{const s={},o=[];for(const r of n)$0(r,(a,i,l,c)=>{const u=d3(l,e,t,a,c);at.fold(u,f=>{o.push(...f)},f=>{s[i]=f})},(a,i)=>{s[a]=i(t)});return o.length>0?at.serror(o):at.svalue(s)},Qd=e=>({extract:(s,o)=>m3(s,o,e),toString:()=>`obj{
`+he(e,o=>$0(o,(r,a,i,l)=>r+" -> "+l.toString(),(r,a)=>"state("+r+")")).join(`
`)+"}"}),M0=e=>({extract:(s,o)=>{const r=he(o,(a,i)=>e.extract(s.concat(["["+i+"]"]),a));return r3.consolidateArr(r)},toString:()=>"array("+e.toString()+")"}),g3=e=>Zd(t=>e(t).fold(at.serror,at.svalue)),p3=(e,t,n)=>{const s=t.extract([e],n);return at.mapError(s,o=>({input:n,errors:o}))},h3=(e,t,n)=>at.toResult(p3(e,t,n)),b3=e=>`Errors: 
`+qW(e.errors).join(`
`)+`

Input object: `+Xd(e.input),U0=(e,t)=>QW(e,ja(t,Qd)),C3=z(l3),Sl=(e,t)=>Zd(n=>{const s=typeof n;return e(n)?at.svalue(n):at.serror(`Expected type: ${t} but got: ${s}`)}),y3=Sl(dn,"number"),wl=Sl(Q,"string"),v3=Sl(_s,"boolean"),Jd=Sl(ke,"function"),Ta=a3,z0=i3,E3=e=>g3(t=>Ne(e,t)?xt.value(t):xt.error(`Unsupported value: "${t}", choose one of "${e.join(", ")}".`)),H0=(e,t)=>Ta(e,e,O0(),t),W0=e=>H0(e,wl),V0=e=>H0(e,Jd),S3=(e,t)=>Ta(e,e,O0(),M0(t)),em=(e,t)=>Ta(e,e,s3(),t),kl=e=>em(e,wl),w3=e=>em(e,Jd),k3=(e,t)=>Ta(e,e,I0(t),C3()),Qo=(e,t,n)=>Ta(e,e,I0(t),n),j0=(e,t)=>Qo(e,t,y3),x3=(e,t)=>Qo(e,t,wl),q0=(e,t,n)=>Qo(e,t,E3(n)),tm=(e,t)=>Qo(e,t,v3),nm=(e,t)=>Qo(e,t,Jd),_3=(e,t,n)=>Qo(e,t,M0(n)),N3=W0("type"),A3=V0("fetch"),sm=V0("onAction"),T3=nm("onSetup",()=>ce),R3=kl("text"),P3=kl("icon"),D3=kl("tooltip"),B3=kl("label"),O3=tm("active",!1),I3=tm("enabled",!0),K0=tm("primary",!1),L3=e=>k3("columns",e),Ra=e=>x3("type",e),$3=Qd([N3,W0("trigger"),j0("minChars",1),L3(1),j0("maxResults",10),w3("matches"),A3,sm,_3("highlightOn",[],wl)]),F3=e=>h3("Autocompleter",$3,{trigger:e.ch,...e}),om=[I3,D3,P3,R3,T3],G0=[O3].concat(om),M3=[nm("predicate",$e),q0("scope","node",["node","editor"]),q0("position","selection",["node","selection","line"])],U3=om.concat([Ra("contextformbutton"),K0,sm,z0("original",kt)]),z3=G0.concat([Ra("contextformbutton"),K0,sm,z0("original",kt)]),H3=om.concat([Ra("contextformbutton")]),W3=G0.concat([Ra("contextformtogglebutton")]),V3=U0("type",{contextformbutton:U3,contextformtogglebutton:z3});Qd([Ra("contextform"),nm("initValue",z("")),B3,S3("commands",V3),em("launch",U0("type",{contextformbutton:H3,contextformtogglebutton:W3}))].concat(M3));const j3=e=>{const t=e.ui.registry.getAll().popups,n=ja(t,a=>F3(a).fold(i=>{throw new Error(b3(i))},kt)),s=ng(qa(n,a=>a.trigger)),o=mc(n);return{dataset:n,triggers:s,lookupByTrigger:a=>oe(o,i=>i.trigger===a)}},q3=(e,t)=>{const n=lu(t.load,50);e.on("keypress compositionend",s=>{s.which!==27&&n.throttle()}),e.on("keydown",s=>{const o=s.which;o===8?n.throttle():o===27&&t.cancelIfNecessary()}),e.on("remove",n.cancel)},K3=e=>{const t=ms(),n=et(!1),s=t.isSet,o=()=>{s()&&(NM(e),LD(e),n.set(!1),t.clear())},r=c=>{s()||(_M(e,c.range),t.set({trigger:c.trigger,matchLength:c.text.length}))},a=Rs(()=>j3(e)),i=c=>t.get().map(u=>N0(e.dom,e.selection.getRng(),u.trigger).bind(f=>R0(e,a,f,c))).getOrThunk(()=>UW(e,a)),l=c=>{i(c).fold(o,u=>{r(u.context),u.lookupData.then(f=>{t.get().map(d=>{const p=u.context;d.trigger===p.trigger&&(p.text.length-d.matchLength>=10?o():(t.set({...d,matchLength:p.text.length}),n.get()?ID(e,{lookupData:f}):(n.set(!0),OD(e,{lookupData:f}))))})})})};e.addCommand("mceAutocompleterReload",(c,u)=>{const f=Ct(u)?u.fetchOptions:{};l(f)}),e.addCommand("mceAutocompleterClose",o),q3(e,{cancelIfNecessary:o,load:l})},G3=_n().browser.isSafari(),Y0=e=>ls(C.fromDom(e)),X0=(e,t)=>{var n;return e.startOffset===0&&e.endOffset===((n=t.textContent)===null||n===void 0?void 0:n.length)},xl=(e,t)=>m.from(e.getParent(t.container(),"details")),Z0=(e,t)=>xl(e,t).isSome(),Y3=(e,t)=>{const n=m.from(e.getParent(t.startContainer,"details")),s=m.from(e.getParent(t.endContainer,"details"));if(n.isSome()||s.isSome()){const o=n.bind(r=>m.from(e.select("summary",r)[0]));return m.some({startSummary:o,startDetails:n,endDetails:s})}else return m.none()},X3=(e,t)=>ht(t).exists(n=>n.isEqual(e)),Z3=(e,t)=>on(t).exists(n=>Me(n.getNode())&&Bt(t,n).exists(s=>s.isEqual(e))||n.isEqual(e)),Q3=(e,t)=>t.startSummary.exists(n=>X3(e,n)),J3=(e,t)=>t.startSummary.exists(n=>Z3(e,n)),eV=(e,t)=>t.startDetails.exists(n=>Bt(n,e).forall(s=>t.startSummary.exists(o=>!o.contains(e.container())&&o.contains(s.container())))),tV=(e,t,n)=>n.startDetails.exists(s=>_t(e,t).forall(o=>!s.contains(o.container()))),Q0=(e,t)=>{const n=t.getNode();lt(n)||e.selection.setCursorLocation(n,t.offset())},J0=(e,t,n)=>{const s=e.dom.getParent(t.container(),"details");if(s&&!s.open){const o=e.dom.select("summary",s)[0];o&&(n?ht(o):on(o)).each(a=>Q0(e,a))}else Q0(e,t)},nV=(e,t)=>{const n=l=>l.contains(e.startContainer),s=l=>l.contains(e.endContainer),o=t.startSummary.exists(n),r=t.startSummary.exists(s),a=t.startDetails.forall(l=>t.endDetails.forall(c=>l!==c));return(o||r)&&!(o&&r)||a},ew=(e,t,n)=>{const{dom:s,selection:o}=e,r=e.getBody();if(n==="character"){const a=N.fromRangeStart(o.getRng()),i=s.getParent(a.container(),s.isBlock),l=xl(s,a),c=i&&s.isEmpty(i),u=wt(i==null?void 0:i.previousSibling),f=wt(i==null?void 0:i.nextSibling);return c&&(t?f:u)&&Fo(!t,r,a).exists(b=>Z0(s,b)&&!Pg(l,xl(s,b)))?!0:Fo(t,r,a).fold($e,d=>{const p=xl(s,d);if(Z0(s,d)&&!Pg(l,p)){if(t||J0(e,d,!1),i&&c){if(t&&u)return!0;if(!t&&f)return!0;J0(e,d,t),e.dom.remove(i)}return!0}else return!1})}else return!1},sV=(e,t,n,s)=>{const r=e.selection.getRng(),a=N.fromRangeStart(r),i=e.getBody();return s==="selection"?nV(r,t):n?J3(a,t)||tV(i,a,t):Q3(a,t)||eV(a,t)},oV=(e,t,n)=>Y3(e.dom,e.selection.getRng()).fold(()=>ew(e,t,n),s=>sV(e,s,t,n)||ew(e,t,n)),rV=(e,t,n)=>{const s=e.selection,o=s.getNode(),r=s.getRng(),a=N.fromRangeStart(r);return nN(o)?(n==="selection"&&X0(r,o)||yy(t,a,o)?Y0(o):e.undoManager.transact(()=>{const i=s.getSel();let{anchorNode:l,anchorOffset:c,focusNode:u,focusOffset:f}=i??{};const d=()=>{M(l)&&M(c)&&M(u)&&M(f)&&(i==null||i.setBaseAndExtent(l,c,u,f))},p=()=>{l=i==null?void 0:i.anchorNode,c=i==null?void 0:i.anchorOffset,u=i==null?void 0:i.focusNode,f=i==null?void 0:i.focusOffset},b=(h,y)=>{P(h.childNodes,E=>{oa(E)&&y.appendChild(E)})},g=e.dom.create("span",{"data-mce-bogus":"1"});b(o,g),o.appendChild(g),d(),(n==="word"||n==="line")&&(i==null||i.modify("extend",t?"right":"left",n)),!s.isCollapsed()&&X0(s.getRng(),g)?Y0(o):(e.execCommand(t?"ForwardDelete":"Delete"),p(),b(g,o),d()),e.dom.remove(g)}),!0):!1},io=(e,t,n)=>oV(e,t,n)||G3&&rV(e,t,n)?m.some(ce):m.none(),tw=e=>(t,n,s={})=>{const o=t.getBody(),r={bubbles:!0,composed:!0,data:null,isComposing:!1,detail:0,view:null,target:o,currentTarget:o,eventPhase:Event.AT_TARGET,originalTarget:o,explicitOriginalTarget:o,isTrusted:!1,srcElement:o,cancelable:!1,preventDefault:ce,inputType:n},a=jp(new InputEvent(e));return t.dispatch(e,{...a,...r,...s})},Pa=tw("input"),_l=tw("beforeinput"),nw=_n(),sw=nw.os,ow=sw.isMacOS()||sw.isiOS(),aV=nw.browser.isFirefox(),iV=(e,t,n)=>{const s=n.keyCode===H.BACKSPACE?"deleteContentBackward":"deleteContentForward",o=e.selection.isCollapsed(),r=o?"character":"selection",a=i=>o?i?"word":"line":"selection";i0([{keyCode:H.BACKSPACE,action:ne(VS,e)},{keyCode:H.BACKSPACE,action:ne(Ad,e,!1)},{keyCode:H.DELETE,action:ne(Ad,e,!0)},{keyCode:H.BACKSPACE,action:ne(xd,e,!1)},{keyCode:H.DELETE,action:ne(xd,e,!0)},{keyCode:H.BACKSPACE,action:ne($d,e,t,!1)},{keyCode:H.DELETE,action:ne($d,e,t,!0)},{keyCode:H.BACKSPACE,action:ne(Rf,e,!1)},{keyCode:H.DELETE,action:ne(Rf,e,!0)},{keyCode:H.BACKSPACE,action:ne(io,e,!1,r)},{keyCode:H.DELETE,action:ne(io,e,!0,r)},...ow?[{keyCode:H.BACKSPACE,altKey:!0,action:ne(io,e,!1,a(!0))},{keyCode:H.DELETE,altKey:!0,action:ne(io,e,!0,a(!0))},{keyCode:H.BACKSPACE,metaKey:!0,action:ne(io,e,!1,a(!1))}]:[{keyCode:H.BACKSPACE,ctrlKey:!0,action:ne(io,e,!1,a(!0))},{keyCode:H.DELETE,ctrlKey:!0,action:ne(io,e,!0,a(!0))}],{keyCode:H.BACKSPACE,action:ne(Td,e,!1)},{keyCode:H.DELETE,action:ne(Td,e,!0)},{keyCode:H.BACKSPACE,action:ne(Ud,e,!1)},{keyCode:H.DELETE,action:ne(Ud,e,!0)},{keyCode:H.BACKSPACE,action:ne(wd,e,!1)},{keyCode:H.DELETE,action:ne(wd,e,!0)},{keyCode:H.BACKSPACE,action:ne(Sd,e,!1)},{keyCode:H.DELETE,action:ne(Sd,e,!0)},{keyCode:H.BACKSPACE,action:ne(Fd,e,!1)},{keyCode:H.DELETE,action:ne(Fd,e,!0)}],n).filter(i=>e.selection.isEditable()).each(i=>{n.preventDefault(),_l(e,s).isDefaultPrevented()||(i(),Pa(e,s))})},lV=(e,t,n)=>Na([{keyCode:H.BACKSPACE,action:ne(JE,e)},{keyCode:H.DELETE,action:ne(JE,e)},...ow?[{keyCode:H.BACKSPACE,altKey:!0,action:ne(_a,e)},{keyCode:H.DELETE,altKey:!0,action:ne(_a,e)},...n?[{keyCode:aV?224:91,action:ne(_a,e)}]:[]]:[{keyCode:H.BACKSPACE,ctrlKey:!0,action:ne(_a,e)},{keyCode:H.DELETE,ctrlKey:!0,action:ne(_a,e)}]],t),cV=(e,t)=>{let n=!1;e.on("keydown",s=>{n=s.keyCode===H.BACKSPACE,s.isDefaultPrevented()||iV(e,t,s)}),e.on("keyup",s=>{s.isDefaultPrevented()||lV(e,s,n),n=!1})},uV=e=>{for(;e;){if(G(e)||B(e)&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}return null},Jo=(e,t)=>{const n=e.dom,s=e.schema.getMoveCaretBeforeOnEnterElements();if(!t)return;if(/^(LI|DT|DD)$/.test(t.nodeName)){const r=uV(t.firstChild);r&&/^(UL|OL|DL)$/.test(r.nodeName)&&t.insertBefore(n.doc.createTextNode(Je),t.firstChild)}const o=n.createRng();if(t.normalize(),t.hasChildNodes()){const r=new Xe(t,t);let a=t,i;for(;i=r.current();){if(B(i)){o.setStart(i,0),o.setEnd(i,0);break}if(s[i.nodeName.toLowerCase()]){o.setStartBefore(i),o.setEndBefore(i);break}a=i,i=r.next()}i||(o.setStart(a,0),o.setEnd(a,0))}else Me(t)?t.nextSibling&&n.isBlock(t.nextSibling)?(o.setStartBefore(t),o.setEndBefore(t)):(o.setStartAfter(t),o.setEndAfter(t)):(o.setStart(t,0),o.setEnd(t,0));e.selection.setRng(o),la(e,o)},Da=(e,t)=>{const n=e.getRoot();let s,o=t;for(;o!==n&&o&&e.getContentEditable(o)!=="false";){if(e.getContentEditable(o)==="true"){s=o;break}o=o.parentNode}return o!==n?s:n},rm=e=>m.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock)),fV=e=>rm(e).fold(z(""),t=>t.nodeName.toUpperCase()),dV=e=>rm(e).filter(t=>Dr(C.fromDom(t))).isSome(),am=e=>{e.innerHTML='<br data-mce-bogus="1">'},mV=(e,t,n)=>{const s=e.dom;m.from(n.style).map(s.parseStyle).each(l=>{const u={...Ac(C.fromDom(t)),...l};s.setStyles(t,u)});const o=m.from(n.class).map(l=>l.split(/\s+/)),r=m.from(t.className).map(l=>oe(l.split(/\s+/),c=>c!==""));mt(o,r,(l,c)=>{const u=oe(c,d=>!Ne(l,d)),f=[...l,...u];s.setAttrib(t,"class",f.join(" "))});const a=["style","class"],i=pr(n,(l,c)=>!Ne(a,c));s.setAttribs(t,i)},Ba=(e,t)=>{if(pt(e).toLowerCase()===t.tagName.toLowerCase()){const s=Yr(e);mV(e,t,s)}},rw=(e,t,n,s,o=!0,r,a)=>{const i=e.dom,l=e.schema,c=pt(e),u=n?n.nodeName.toUpperCase():"";let f=t;const d=l.getTextInlineElements();let p;r||u==="TABLE"||u==="HR"?p=i.create(r||c,a||{}):p=n.cloneNode(!1);let b=p;if(!o)i.setAttrib(p,"style",null),i.setAttrib(p,"class",null);else do if(d[f.nodeName]){if(jt(f)||qt(f))continue;const g=f.cloneNode(!1);i.setAttrib(g,"id",""),p.hasChildNodes()?(g.appendChild(p.firstChild),p.appendChild(g)):(b=g,p.appendChild(g))}while((f=f.parentNode)&&f!==s);return Ba(e,p),am(b),p},gV=(e,t)=>e.dom.getParent(t,Ic),pV=(e,t,n)=>{let s=t;for(;s&&s!==e&&wt(s.nextSibling);){const o=s.parentElement;if(!o||!n(o))return Ic(o);s=o}return!1},hV=(e,t,n)=>!t&&n.nodeName.toLowerCase()===pt(e)&&e.dom.isEmpty(n)&&pV(e.getBody(),n,s=>re(e.schema.getTextBlockElements(),s.nodeName.toLowerCase())),bV=(e,t,n)=>{var s,o,r;const a=t(pt(e)),i=gV(e,n);i&&(e.dom.insertAfter(a,i),Jo(e,a),((r=(o=(s=n.parentElement)===null||s===void 0?void 0:s.childNodes)===null||o===void 0?void 0:o.length)!==null&&r!==void 0?r:0)>1&&e.dom.remove(n))},CV=(e,t)=>e.firstChild&&e.firstChild.nodeName===t,yV=e=>{var t;return((t=e.parentNode)===null||t===void 0?void 0:t.firstChild)===e},aw=(e,t)=>{const n=e==null?void 0:e.parentNode;return M(n)&&n.nodeName===t},iw=e=>M(e)&&/^(OL|UL|LI)$/.test(e.nodeName),im=e=>M(e)&&/^(LI|DT|DD)$/.test(e.nodeName),vV=e=>iw(e)&&iw(e.parentNode),Nl=e=>{const t=e.parentNode;return im(t)?t:e},Al=(e,t,n)=>{let s=e[n?"firstChild":"lastChild"];for(;s&&!G(s);)s=s[n?"nextSibling":"previousSibling"];return s===t},lw=e=>Tt(qa(Ac(C.fromDom(e)),(t,n)=>`${n}: ${t};`),(t,n)=>t+n,""),EV=(e,t,n,s,o)=>{const r=e.dom,a=e.selection.getRng(),i=n.parentNode;if(n===e.getBody()||!i)return;vV(n)&&(o="LI");const l=im(s)?lw(s):void 0;let c=im(s)&&l?t(o,{style:lw(s)}):t(o);if(Al(n,s,!0)&&Al(n,s,!1))if(aw(n,"LI")){const u=Nl(n);r.insertAfter(c,u),yV(n)?r.remove(u):r.remove(n)}else r.replace(c,n);else if(Al(n,s,!0))aw(n,"LI")?(r.insertAfter(c,Nl(n)),c.appendChild(r.doc.createTextNode(" ")),c.appendChild(n)):i.insertBefore(c,n),r.remove(s);else if(Al(n,s,!1))r.insertAfter(c,Nl(n)),r.remove(s);else{n=Nl(n);const u=a.cloneRange();u.setStartAfter(s),u.setEndAfter(n);const f=u.extractContents();if(o==="LI"&&CV(f,"LI")){const d=oe(he(c.children,C.fromDom),ur(Qa("br")));c=f.firstChild,r.insertAfter(f,n),P(d,p=>Tc(C.fromDom(c),p)),l&&c.setAttribute("style",l)}else r.insertAfter(f,n),r.insertAfter(c,n);r.remove(s)}Jo(e,c)},SV=e=>{P(fp(C.fromDom(e),Ht),t=>{const n=t.dom;n.nodeValue=Mt(n.data)})},wV=(e,t)=>{const n=e.dom.getParent(t,"ol,ul,dl");return n!==null&&e.dom.getContentEditableParent(n)==="false"},kV=(e,t)=>t&&t.nodeName==="A"&&e.isEmpty(t),lm=(e,t)=>e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t,cm=(e,t)=>M(t)&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&e.isEditable(t.parentNode)&&e.getContentEditable(t)!=="false",xV=(e,t,n)=>{var s;const o=[];if(!n)return;let r=n;for(;r=r.firstChild;){if(e.isBlock(r))return;G(r)&&!t[r.nodeName.toLowerCase()]&&o.push(r)}let a=o.length;for(;a--;)r=o[a],(!r.hasChildNodes()||r.firstChild===r.lastChild&&((s=r.firstChild)===null||s===void 0?void 0:s.nodeValue)===""||kV(e,r))&&e.remove(r)},um=(e,t,n)=>B(t)?e?n===1&&t.data.charAt(n-1)===Ze?0:n:n===t.data.length-1&&t.data.charAt(n)===Ze?t.data.length:n:n,_V=e=>{const t=e.cloneRange();return t.setStart(e.startContainer,um(!0,e.startContainer,e.startOffset)),t.setEnd(e.endContainer,um(!1,e.endContainer,e.endOffset)),t},NV=e=>{let t=e;do B(t)&&(t.data=t.data.replace(/^[\r\n]+/,"")),t=t.firstChild;while(t)},AV=(e,t,n,s,o)=>{var r,a;const i=e.dom,l=(r=Da(i,s))!==null&&r!==void 0?r:i.getRoot();let c=i.getParent(s,i.isBlock);if(!c||!cm(i,c)){if(c=c||l,!c.hasChildNodes()){const p=i.create(t);return Ba(e,p),c.appendChild(p),n.setStart(p,0),n.setEnd(p,0),p}let u=s;for(;u&&u.parentNode!==c;)u=u.parentNode;let f;for(;u&&!i.isBlock(u);)f=u,u=u.previousSibling;const d=(a=f==null?void 0:f.parentElement)===null||a===void 0?void 0:a.nodeName;if(f&&d&&e.schema.isValidChild(d,t.toLowerCase())){const p=f.parentNode,b=i.create(t);for(Ba(e,b),p.insertBefore(b,f),u=f;u&&!i.isBlock(u);){const g=u.nextSibling;b.appendChild(u),u=g}n.setStart(s,o),n.setEnd(s,o)}}return s},TV=(e,t)=>{t.normalize();const n=t.lastChild;(!n||G(n)&&/^(left|right)$/gi.test(e.getStyle(n,"float",!0)))&&e.add(t,"br")},RV=(e,t)=>{const n=GT(e);return je(t)?!1:Q(n)?Ne($.explode(n),t.nodeName.toLowerCase()):n},cw={insert:(e,t)=>{let n,s,o,r,a=!1;const i=e.dom,l=e.schema,c=l.getNonEmptyElements(),u=e.selection.getRng(),f=pt(e),d=C.fromDom(u.startContainer),p=xo(d,u.startOffset),b=p.exists(T=>Za(T)&&!Is(T)),g=u.collapsed&&b,h=(T,V)=>rw(e,n,O,R,KT(e),T,V),y=T=>{const V=um(T,n,s);if(B(n)&&(T?V>0:V<n.data.length))return!1;if(n.parentNode===O&&a&&!T||T&&G(n)&&n===O.firstChild)return!0;if(lm(n,"TABLE")||lm(n,"HR"))return a&&!T||!a&&T;const Z=new Xe(n,O);B(n)&&(T&&V===0?Z.prev():!T&&V===n.data.length&&Z.next());let ae;for(;ae=Z.current();){if(G(ae)){if(!ae.getAttribute("data-mce-bogus")){const ie=ae.nodeName.toLowerCase();if(c[ie]&&ie!=="br")return!1}}else if(B(ae)&&!us(ae.data))return!1;T?Z.prev():Z.next()}return!0},E=()=>{let T;return/^(H[1-6]|PRE|FIGURE)$/.test(o)&&U!=="HGROUP"?T=h(f):T=h(),RV(e,r)&&cm(i,r)&&i.isEmpty(O,void 0,{includeZwsp:!0})?T=i.split(r,O):i.insertAfter(T,O),Jo(e,T),T};Mi(i,u).each(T=>{u.setStart(T.startContainer,T.startOffset),u.setEnd(T.endContainer,T.endOffset)}),n=u.startContainer,s=u.startOffset;const v=!!(t&&t.shiftKey),S=!!(t&&t.ctrlKey);G(n)&&n.hasChildNodes()&&!g&&(a=s>n.childNodes.length-1,n=n.childNodes[Math.min(s,n.childNodes.length-1)]||n,a&&B(n)?s=n.data.length:s=0);const R=Da(i,n);if(!R||wV(e,n))return;v||(n=AV(e,f,u,n,s));let O=i.getParent(n,i.isBlock)||i.getRoot();r=M(O==null?void 0:O.parentNode)?i.getParent(O.parentNode,i.isBlock):null,o=O?O.nodeName.toUpperCase():"";const U=r?r.nodeName.toUpperCase():"";if(U==="LI"&&!S){const T=r;O=T,r=T.parentNode,o=U}if(G(r)&&hV(e,v,O))return bV(e,h,O);if(/^(LI|DT|DD)$/.test(o)&&G(r)&&i.isEmpty(O)){EV(e,h,r,O,f);return}if(!g&&(O===e.getBody()||!cm(i,O)))return;const A=O.parentNode;let x;if(g)x=h(f),p.fold(()=>{Ve(d,C.fromDom(x))},T=>{Dt(T,C.fromDom(x))}),e.selection.setCursorLocation(x,0);else if(Po(O))x=zc(O),i.isEmpty(O)&&am(O),Ba(e,x),Jo(e,x);else if(y(!1))x=E();else if(y(!0)&&A){x=A.insertBefore(h(),O);const T=w_(C.fromDom(u.startContainer))&&u.collapsed;Jo(e,lm(O,"HR")||T?x:O)}else{const T=_V(u).cloneRange();T.setEndAfter(O);const V=T.extractContents();SV(V),NV(V),x=V.firstChild,i.insertAfter(V,O),xV(i,c,x),TV(i,O),i.isEmpty(O)&&am(O),x.normalize(),i.isEmpty(x)?(i.remove(x),E()):(Ba(e,x),Jo(e,x))}i.setAttrib(x,"id",""),e.dispatch("NewBlock",{newBlock:x})},fakeEventName:"insertParagraph"},PV=(e,t,n)=>{const s=new Xe(t,n);let o;const r=e.getNonEmptyElements();for(;o=s.next();)if(r[o.nodeName.toLowerCase()]||B(o)&&o.length>0)return!0;return!1},uw=(e,t,n)=>{const s=e.dom.createRng();n?(s.setStartBefore(t),s.setEndBefore(t)):(s.setStartAfter(t),s.setEndAfter(t)),e.selection.setRng(s),la(e,s)},DV=(e,t)=>{const n=e.selection,s=e.dom,o=n.getRng();let r,a=!1;Mi(s,o).each(p=>{o.setStart(p.startContainer,p.startOffset),o.setEnd(p.endContainer,p.endOffset)});let i=o.startOffset,l=o.startContainer;if(G(l)&&l.hasChildNodes()){const p=i>l.childNodes.length-1;l=l.childNodes[Math.min(i,l.childNodes.length-1)]||l,p&&B(l)?i=l.data.length:i=0}let c=s.getParent(l,s.isBlock);const u=c&&c.parentNode?s.getParent(c.parentNode,s.isBlock):null,f=u?u.nodeName.toUpperCase():"",d=!!(t&&t.ctrlKey);f==="LI"&&!d&&(c=u),B(l)&&i>=l.data.length&&(PV(e.schema,l,c||s.getRoot())||(r=s.create("br"),o.insertNode(r),o.setStartAfter(r),o.setEndAfter(r),a=!0)),r=s.create("br"),mu(s,o,r),uw(e,r,a),e.undoManager.add()},BV=(e,t)=>{const n=C.fromTag("br");Dt(C.fromDom(t),n),e.undoManager.add()},OV=(e,t)=>{LV(e.getBody(),t)||Gn(C.fromDom(t),C.fromTag("br"));const n=C.fromTag("br");Gn(C.fromDom(t),n),uw(e,n.dom,!1),e.undoManager.add()},IV=e=>Me(e.getNode()),LV=(e,t)=>IV(N.after(t))?!0:_t(e,N.after(t)).map(n=>Me(n.getNode())).getOr(!1),fw=e=>e&&e.nodeName==="A"&&"href"in e,$V=e=>e.fold($e,fw,fw,$e),FV=e=>{const t=K(so,e),n=N.fromRangeStart(e.selection.getRng());return Fn(t,e.getBody(),n).filter($V)},MV=(e,t)=>{t.fold(ce,K(BV,e),K(OV,e),ce)},dw={insert:(e,t)=>{const n=FV(e);n.isSome()?n.each(K(MV,e)):DV(e,t)},fakeEventName:"insertLineBreak"},mw=(e,t)=>rm(e).filter(n=>t.length>0&&mn(C.fromDom(n),t)).isSome(),UV=e=>mw(e,jT(e)),zV=e=>mw(e,qT(e)),zt=Pn.generate([{br:[]},{block:[]},{none:[]}]),HV=(e,t)=>zV(e),gw=e=>(t,n)=>dV(t)===e,pw=(e,t)=>(n,s)=>fV(n)===e.toUpperCase()===t,WV=e=>{const t=Da(e.dom,e.selection.getStart());return je(t)},Oa=e=>pw("pre",e),VV=()=>pw("summary",!0),Tl=e=>(t,n)=>WT(t)===e,jV=(e,t)=>UV(e),Rl=(e,t)=>t,qV=e=>{const t=pt(e),n=Da(e.dom,e.selection.getStart());return M(n)&&e.schema.isValidChild(n.nodeName,t)},KV=e=>{const t=e.selection.getRng(),n=C.fromDom(t.startContainer),o=xo(n,t.startOffset).map(r=>Za(r)&&!Is(r));return t.collapsed&&o.getOr(!0)},Qt=(e,t)=>(n,s)=>Tt(e,(r,a)=>r&&a(n,s),!0)?m.some(t):m.none(),GV=(e,t)=>rS([Qt([HV],zt.none()),Qt([Oa(!0),WV],zt.none()),Qt([VV()],zt.br()),Qt([Oa(!0),Tl(!1),Rl],zt.br()),Qt([Oa(!0),Tl(!1)],zt.block()),Qt([Oa(!0),Tl(!0),Rl],zt.block()),Qt([Oa(!0),Tl(!0)],zt.br()),Qt([gw(!0),Rl],zt.br()),Qt([gw(!0)],zt.block()),Qt([jV],zt.br()),Qt([Rl],zt.br()),Qt([qV],zt.block()),Qt([KV],zt.block())],[e,!!(t&&t.shiftKey)]).getOr(zt.none()),Pl=(e,t,n)=>{t.selection.isCollapsed()||PO(t),!(M(n)&&_l(t,e.fakeEventName).isDefaultPrevented())&&(e.insert(t,n),M(n)&&Pa(t,e.fakeEventName))},hw=(e,t)=>{const n=()=>Pl(dw,e,t),s=()=>Pl(cw,e,t),o=GV(e,t);switch(VT(e)){case"linebreak":o.fold(n,n,ce);break;case"block":o.fold(s,s,ce);break;case"invert":o.fold(s,n,ce);break;default:o.fold(n,s,ce);break}},bw=_n(),YV=bw.os.isiOS()&&bw.browser.isSafari(),Cw=(e,t)=>{t.isDefaultPrevented()||(t.preventDefault(),FF(e.undoManager),e.undoManager.transact(()=>{hw(e,t)}))},XV=e=>{if(!e.collapsed)return!1;const t=e.startContainer;if(B(t)){const n=/^[\uAC00-\uD7AF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uD7B0-\uD7FF]$/,s=t.data.charAt(e.startOffset-1);return n.test(s)}else return!1},ZV=e=>{let t=m.none();const n=o=>{t=m.some(o.selection.getBookmark()),o.undoManager.add()},s=(o,r)=>{o.undoManager.undo(),t.fold(ce,a=>o.selection.moveToBookmark(a)),Cw(o,r),t=m.none()};e.on("keydown",o=>{o.keyCode===H.ENTER&&(YV&&XV(e.selection.getRng())?n(e):Cw(e,o))}),e.on("keyup",o=>{o.keyCode===H.ENTER&&t.each(()=>s(e,o))})},QV=(e,t,n)=>{const s=be.os.isMacOS()||be.os.isiOS();Na([{keyCode:H.END,action:ne(n0,e,!0)},{keyCode:H.HOME,action:ne(n0,e,!1)},...s?[]:[{keyCode:H.HOME,action:ne(bl,e,!1),ctrlKey:!0,shiftKey:!0},{keyCode:H.END,action:ne(bl,e,!0),ctrlKey:!0,shiftKey:!0}],{keyCode:H.END,action:ne(u0,e,!0)},{keyCode:H.HOME,action:ne(u0,e,!1)},{keyCode:H.END,action:ne(hl,e,!0,t)},{keyCode:H.HOME,action:ne(hl,e,!1,t)}],n).each(o=>{n.preventDefault()})},JV=(e,t)=>{e.on("keydown",n=>{n.isDefaultPrevented()||QV(e,t,n)})},e8=e=>{e.on("input",t=>{t.isComposing||uO(e)})},t8=_n(),n8=(e,t,n)=>{Na([{keyCode:H.PAGE_UP,action:ne(hl,e,!1,t)},{keyCode:H.PAGE_DOWN,action:ne(hl,e,!0,t)}],n)},yw=e=>e.stopImmediatePropagation(),vw=e=>e.keyCode===H.PAGE_UP||e.keyCode===H.PAGE_DOWN,Ew=(e,t,n)=>{n&&!e.get()?t.on("NodeChange",yw,!0):!n&&e.get()&&t.off("NodeChange",yw),e.set(n)},s8=(e,t)=>{if(t8.os.isMacOS())return;const n=et(!1);e.on("keydown",s=>{vw(s)&&Ew(n,e,!0)}),e.on("keyup",s=>{s.isDefaultPrevented()||n8(e,t,s),vw(s)&&n.get()&&(Ew(n,e,!1),e.nodeChanged())})},o8=e=>{e.on("beforeinput",t=>{(!e.selection.isEditable()||Ue(t.getTargetRanges(),n=>!kC(e.dom,n)))&&t.preventDefault()})},Sw=(e,t)=>{const n=t.container(),s=t.offset();return B(n)?(n.insertData(s,e),m.some(N(n,s+e.length))):Ni(t).map(o=>{const r=C.fromText(e);return t.isAtEnd()?Gn(o,r):Dt(o,r),N(r.dom,e.length)})},ww=K(Sw,Je),kw=K(Sw," "),r8=(e,t,n)=>ay(e,t,n)?ww(t):kw(t),a8=e=>t=>t.fold(n=>Bt(e.dom,N.before(n)),n=>ht(n),n=>on(n),n=>_t(e.dom,N.after(n))),i8=(e,t,n)=>s=>ay(e,s,n)?ww(t):kw(t),xw=e=>t=>{e.selection.setRng(t.toRange()),e.nodeChanged()},l8=(e,t)=>e.isEditable(e.getParent(t,"summary")),c8=e=>{const t=N.fromRangeStart(e.selection.getRng()),n=C.fromDom(e.getBody());if(e.selection.isCollapsed()){const s=K(so,e),o=N.fromRangeStart(e.selection.getRng());return Fn(s,e.getBody(),o).bind(a8(n)).map(r=>()=>i8(n,t,e.schema)(r).each(xw(e)))}else return m.none()},u8=e=>{const t=()=>{const n=C.fromDom(e.getBody());e.selection.isCollapsed()||e.getDoc().execCommand("Delete");const s=N.fromRangeStart(e.selection.getRng());r8(n,s,e.schema).each(xw(e))};return wo(be.browser.isFirefox()&&e.selection.isEditable()&&l8(e.dom,e.selection.getRng().startContainer),t)},f8=(e,t)=>{i0([{keyCode:H.SPACEBAR,action:ne(c8,e)},{keyCode:H.SPACEBAR,action:ne(u8,e)}],t).each(n=>{t.preventDefault(),_l(e,"insertText",{data:" "}).isDefaultPrevented()||(n(),Pa(e,"insertText",{data:" "}))})},d8=e=>{e.on("keydown",t=>{t.isDefaultPrevented()||f8(e,t)})},m8=e=>oP(e)?[{keyCode:H.TAB,action:ne(w0,e,!0)},{keyCode:H.TAB,shiftKey:!0,action:ne(w0,e,!1)}]:[],g8=(e,t)=>{Na([...m8(e)],t).each(n=>{t.preventDefault()})},p8=e=>{e.on("keydown",t=>{t.isDefaultPrevented()||g8(e,t)})},h8=e=>{if(e.addShortcut("Meta+P","","mcePrint"),K3(e),$n(e))return et(null);{const t=$H(e);return o8(e),O2(e),TW(e,t),cV(e,t),ZV(e),d8(e),e8(e),p8(e),JV(e,t),s8(e,t),t}};class b8{constructor(t){this.lastPath=[],this.editor=t;let n;const s=this;"onselectionchange"in t.getDoc()||t.on("NodeChange click mouseup keyup focus",o=>{const r=t.selection.getRng(),a={startContainer:r.startContainer,startOffset:r.startOffset,endContainer:r.endContainer,endOffset:r.endOffset};(o.type==="nodechange"||!Xu(a,n))&&t.dispatch("SelectionChange"),n=a}),t.on("contextmenu",()=>{t.dispatch("SelectionChange")}),t.on("SelectionChange",()=>{const o=t.selection.getStart(!0);o&&Di(t)&&!s.isSameElementPath(o)&&t.dom.isChildOf(o,t.getBody())&&t.nodeChanged({selectionChange:!0})}),t.on("mouseup",o=>{!o.isDefaultPrevented()&&Di(t)&&(t.selection.getNode().nodeName==="IMG"?Gt.setEditorTimeout(t,()=>{t.nodeChanged()}):t.nodeChanged())})}nodeChanged(t={}){const n=this.editor.selection;let s;if(this.editor.initialized&&n&&!wR(this.editor)&&!this.editor.mode.isReadOnly()){const o=this.editor.getBody();s=n.getStart(!0)||o,(s.ownerDocument!==this.editor.getDoc()||!this.editor.dom.isChildOf(s,o))&&(s=o);const r=[];this.editor.dom.getParent(s,a=>a===o?!0:(r.push(a),!1)),this.editor.dispatch("NodeChange",{...t,element:s,parents:r})}}isSameElementPath(t){let n;const s=this.editor,o=gr(s.dom.getParents(t,We,s.getBody()));if(o.length===this.lastPath.length){for(n=o.length;n>=0&&o[n]===this.lastPath[n];n--);if(n===-1)return this.lastPath=o,!0}return this.lastPath=o,!1}}const _w=Vr("image"),C8=e=>{const t=e;return m.from(t[_w])},y8=(e,t)=>{const n=e;n[_w]=t},fm=Vr("event"),v8=e=>{const t=e;return m.from(t[fm])},Dl=e=>t=>{const n=t;n[fm]=e},E8=(e,t)=>Dl(t)(e),Nw=Dl(0),S8=Dl(2),w8=Dl(1),k8=(e=>t=>{const n=t;return m.from(n[fm]).exists(s=>s===e)})(0),x8=()=>Object.freeze({length:0,item:e=>null}),dm=Vr("mode"),_8=e=>{const t=e;return m.from(t[dm])},Bl=e=>t=>{const n=t;n[dm]=e},Aw=(e,t)=>Bl(t)(e),Tw=Bl(0),mm=Bl(2),N8=Bl(1),Rw=e=>t=>{const n=t;return m.from(n[dm]).exists(s=>s===e)},er=Rw(0),Pw=Rw(1),A8=(e,t)=>({...t,get length(){return t.length},add:(n,s)=>{if(er(e))if(Q(n)){if(!lt(s))return t.add(n,s)}else return t.add(n);return null},remove:n=>{er(e)&&t.remove(n)},clear:()=>{er(e)&&t.clear()}}),T8=["none","copy","link","move"],R8=["none","copy","copyLink","copyMove","link","linkMove","move","all","uninitialized"],gm=()=>{const e=new window.DataTransfer;let t="move",n="all";const s={get dropEffect(){return t},set dropEffect(o){Ne(T8,o)&&(t=o)},get effectAllowed(){return n},set effectAllowed(o){k8(s)&&Ne(R8,o)&&(n=o)},get items(){return A8(s,e.items)},get files(){return Pw(s)?x8():e.files},get types(){return e.types},setDragImage:(o,r,a)=>{er(s)&&(y8(s,{image:o,x:r,y:a}),e.setDragImage(o,r,a))},getData:o=>Pw(s)?"":e.getData(o),setData:(o,r)=>{er(s)&&e.setData(o,r)},clearData:o=>{er(s)&&e.clearData(o)}};return Tw(s),s},P8=e=>{const t=gm(),n=_8(e);return mm(e),Nw(t),t.dropEffect=e.dropEffect,t.effectAllowed=e.effectAllowed,C8(e).each(s=>t.setDragImage(s.image,s.x,s.y)),P(e.types,s=>{s!=="Files"&&t.setData(s,e.getData(s))}),P(e.files,s=>t.items.add(s)),v8(e).each(s=>{E8(t,s)}),n.each(s=>{Aw(e,s),Aw(t,s)}),t},D8=e=>{const t=e.getData("text/html");return t===""?m.none():m.some(t)},Dw=(e,t)=>e.setData("text/html",t),Bw="x-tinymce/html",Ol=z(Bw),pm="<!-- "+Bw+" -->",B8=e=>pm+e,O8=e=>e.replace(pm,""),Ow=e=>e.indexOf(pm)!==-1,I8=e=>!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(e),L8=(e,t)=>{let n="<"+e;const s=qa(t,(o,r)=>r+'="'+fs.encodeAllRaw(o)+'"');return s.length&&(n+=" "+s.join(" ")),n+">"},$8=(e,t,n)=>{const s=e.split(/\n\n/),o=L8(t,n),r="</"+t+">",a=he(s,l=>l.split(/\n/).join("<br />")),i=l=>o+l+r;return a.length===1?a[0]:he(a,i).join("")},Iw="%MCEPASTEBIN%",F8=(e,t)=>{const{dom:n,selection:s}=e,o=e.getBody();t.set(s.getRng());const r=n.add(e.getBody(),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},Iw);be.browser.isFirefox()&&n.setStyle(r,"left",n.getStyle(o,"direction",!0)==="rtl"?65535:-65535),n.bind(r,"beforedeactivate focusin focusout",a=>{a.stopPropagation()}),r.focus(),s.select(r,!0)},M8=(e,t)=>{const n=e.dom;if(hm(e)){let s;const o=t.get();for(;s=hm(e);)n.remove(s),n.unbind(s);o&&e.selection.setRng(o)}t.set(null)},hm=e=>e.dom.get("mcepastebin"),U8=e=>M(e)&&e.id==="mcepastebin",z8=e=>{const t=e.dom,n=(a,i)=>{a.appendChild(i),t.remove(i,!0)},[s,...o]=oe(e.getBody().childNodes,U8);P(o,a=>{n(s,a)});const r=t.select("div[id=mcepastebin]",s);for(let a=r.length-1;a>=0;a--){const i=t.create("div");s.insertBefore(i,r[a]),n(i,r[a])}return s?s.innerHTML:""},Lw=e=>e===Iw,H8=e=>{const t=et(null);return{create:()=>F8(e,t),remove:()=>M8(e,t),getEl:()=>hm(e),getHtml:()=>z8(e),getLastRng:t.get}},$w=(e,t)=>($.each(t,n=>{Ha(n,RegExp)?e=e.replace(n,""):e=e.replace(n[0],n[1])}),e),W8=e=>{const t=ds(),n=Ko({},t);let s="";const o=t.getVoidElements(),r=$.makeMap("script noscript style textarea video audio iframe object"," "),a=t.getBlockElements(),i=l=>{const c=l.name,u=l;if(c==="br"){s+=`
`;return}if(c!=="wbr"){if(o[c]&&(s+=" "),r[c]){s+=" ";return}if(l.type===3&&(s+=l.value),!(l.name in t.getVoidElements())){let f=l.firstChild;if(f)do i(f);while(f=f.next)}a[c]&&u.next&&(s+=`
`,c==="p"&&(s+=`
`))}};return e=$w(e,[/<!\[[^\]]+\]>/g]),i(n.parse(e)),s},Fw=e=>(e=$w(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/ig,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,(n,s,o)=>!s&&!o?" ":Je],/<br class="Apple-interchange-newline">/g,/<br>$/i]),e),V8=e=>{let t=0;return()=>e+t++},j8=e=>{const t=e.toLowerCase(),n={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"};return $.hasOwn(n,t)?"image/"+n[t]:"image/"+t},q8=(e,t)=>{const n=Ko({sanitize:Su(e),sandbox_iframes:wu(e)},e.schema);n.addNodeFilter("meta",o=>{$.each(o,r=>{r.remove()})});const s=n.parse(t,{forced_root_block:!1,isRootContent:!0});return Cs({validate:!0},e.schema).serialize(s)},Mw=(e,t)=>({content:e,cancelled:t}),K8=(e,t,n)=>{const s=e.dom.create("div",{style:"display:none"},t),o=FD(e,s,n);return Mw(o.node.innerHTML,o.isDefaultPrevented())},G8=(e,t,n)=>{const s=$D(e,t,n),o=q8(e,s.content);return e.hasEventListeners("PastePostProcess")&&!s.isDefaultPrevented()?K8(e,o,n):Mw(o,s.isDefaultPrevented())},Y8=(e,t,n)=>G8(e,t,n),bm=(e,t)=>(e.insertContent(t,{merge:HR(e),paste:!0}),!0),Cm=e=>/^https?:\/\/[\w\-\/+=.,!;:&%@^~(){}?#]+$/i.test(e),X8=(e,t)=>Cm(t)&&Ue(Xh(e),n=>bc(t.toLowerCase(),`.${n.toLowerCase()}`)),Z8=(e,t,n)=>(e.undoManager.extra(()=>{n(e,t)},()=>{e.insertContent('<img src="'+t+'">')}),!0),Q8=(e,t,n)=>(e.undoManager.extra(()=>{n(e,t)},()=>{e.execCommand("mceInsertLink",!1,t)}),!0),J8=(e,t,n)=>!e.selection.isCollapsed()&&Cm(t)?Q8(e,t,n):!1,ej=(e,t,n)=>X8(e,t)?Z8(e,t,n):!1,tj=(e,t)=>{$.each([J8,ej,bm],n=>!n(e,t,bm))},nj=(e,t,n)=>{n||!WR(e)?bm(e,t):tj(e,t)},sj=V8("mceclip"),oj=e=>{const t=gm();return Dw(t,e),mm(t),t},Uw=(e,t,n,s,o)=>{const r=Y8(e,t,n);if(!r.cancelled){const a=r.content,i=()=>nj(e,a,s);o?_l(e,"insertFromPaste",{dataTransfer:oj(a)}).isDefaultPrevented()||(i(),Pa(e,"insertFromPaste")):i()}},Il=(e,t,n,s)=>{const o=n||Ow(t);Uw(e,O8(t),o,!1,s)},ym=(e,t,n)=>{const s=e.dom.encode(t).replace(/\r\n/g,`
`),o=kp(s,jR(e)),r=$8(o,pt(e),Yr(e));Uw(e,r,!1,!0,n)},zw=e=>{const t={};if(e&&e.types)for(let n=0;n<e.types.length;n++){const s=e.types[n];try{t[s]=e.getData(s)}catch{t[s]=""}}return t},ws=(e,t)=>t in e&&e[t].length>0,Hw=e=>ws(e,"text/html")||ws(e,"text/plain"),rj=(e,t)=>{const n=t.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return M(n)?e.dom.encode(n[1]):void 0},aj=(e,t,n,s)=>{const o=sj(),r=Mh(e)&&M(n.name),a=r?rj(e,n.name):o,i=r?n.name:void 0,l=t.create(o,n,s,a,i);return t.add(l),l},ij=(e,t)=>{Qf(t.uri).each(({data:n,type:s,base64Encoded:o})=>{const r=o?n:btoa(n),a=t.file,i=e.editorUpload.blobCache,l=i.getByData(r,s),c=l??aj(e,i,a,r);Il(e,`<img src="${c.blobUri()}">`,!1,!0)})},lj=e=>e.type==="paste",cj=e=>Promise.all(he(e,t=>Tv(t).then(n=>({file:t,uri:n})))),uj=e=>{const t=Xh(e);return n=>ct(n.type,"image/")&&Ue(t,s=>j8(s)===n.type)},fj=(e,t)=>{const n=t.items?en(Lt(t.items),o=>o.kind==="file"?[o.getAsFile()]:[]):[],s=t.files?Lt(t.files):[];return oe(n.length>0?n:s,uj(e))},Ww=(e,t,n)=>{const s=lj(t)?t.clipboardData:t.dataTransfer;if(xi(e)&&s){const o=fj(e,s);if(o.length>0)return t.preventDefault(),cj(o).then(r=>{n&&e.selection.setRng(n),P(r,a=>{ij(e,a)})}),!0}return!1},dj=e=>{var t,n;return be.os.isAndroid()&&((n=(t=e.clipboardData)===null||t===void 0?void 0:t.items)===null||n===void 0?void 0:n.length)===0},mj=e=>H.metaKeyPressed(e)&&e.keyCode===86||e.shiftKey&&e.keyCode===45,vm=(e,t,n,s,o)=>{let r=Fw(n);const a=ws(t,Ol())||Ow(n),i=!a&&I8(r),l=Cm(r);(Lw(r)||!r.length||i&&!l)&&(s=!0),(s||l)&&(ws(t,"text/plain")&&i?r=t["text/plain"]:r=W8(r)),!Lw(r)&&(s?ym(e,r,o):Il(e,r,a,o))},gj=(e,t,n)=>{let s;const o=()=>t.getLastRng()||e.selection.getRng();e.on("keydown",r=>{mj(r)&&!r.isDefaultPrevented()&&(s=r.shiftKey&&r.keyCode===86)}),e.on("paste",r=>{if(r.isDefaultPrevented()||dj(r))return;const a=n.get()==="text"||s;s=!1;const i=zw(r.clipboardData);!Hw(i)&&Ww(e,r,o())||(ws(i,"text/html")?(r.preventDefault(),vm(e,i,i["text/html"],a,!0)):ws(i,"text/plain")&&ws(i,"text/uri-list")?(r.preventDefault(),vm(e,i,i["text/plain"],a,!0)):(t.create(),Gt.setEditorTimeout(e,()=>{const l=t.getHtml();t.remove(),vm(e,i,l,a,!1)},0)))})},pj=e=>{const t=o=>ct(o,"webkit-fake-url"),n=o=>ct(o,"data:"),s=o=>{var r;return((r=o.data)===null||r===void 0?void 0:r.paste)===!0};e.parser.addNodeFilter("img",(o,r,a)=>{if(!xi(e)&&s(a))for(const i of o){const l=i.attr("src");Q(l)&&!i.attr("data-mce-object")&&l!==be.transparentSrc&&(t(l)||!qR(e)&&n(l))&&i.remove()}})},hj=(e,t,n)=>{gj(e,t,n),pj(e)},bj=(e,t)=>{t.get()==="text"?(t.set("html"),Xb(e,!1)):(t.set("text"),Xb(e,!0)),e.focus()},Cj=(e,t)=>{e.addCommand("mceTogglePlainTextPaste",()=>{bj(e,t)}),e.addCommand("mceInsertClipboardContent",(n,s)=>{s.html&&Il(e,s.html,s.internal,!1),s.text&&ym(e,s.text,!1)})},yj=(e,t,n)=>{if(e)try{return e.clearData(),e.setData("text/html",t),e.setData("text/plain",n),e.setData(Ol(),t),!0}catch{return!1}else return!1},Vw=(e,t,n,s)=>{yj(e.clipboardData,t.html,t.text)?(e.preventDefault(),s()):n(t.html,s)},jw=e=>(t,n)=>{const{dom:s,selection:o}=e,r=s.create("div",{contenteditable:"false","data-mce-bogus":"all"}),a=s.create("div",{contenteditable:"true"},t);s.setStyles(r,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),r.appendChild(a),s.add(e.getBody(),r);const i=o.getRng();a.focus();const l=s.createRng();l.selectNodeContents(a),o.setRng(l),Gt.setEditorTimeout(e,()=>{o.setRng(i),s.remove(r),n()},0)},qw=e=>({html:B8(e.selection.getContent({contextual:!0})),text:e.selection.getContent({format:"text"})}),vj=e=>!!e.dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody()),Kw=e=>!e.selection.isCollapsed()||vj(e),Ej=e=>t=>{!t.isDefaultPrevented()&&Kw(e)&&e.selection.isEditable()&&Vw(t,qw(e),jw(e),()=>{if(be.browser.isChromium()||be.browser.isFirefox()){const n=e.selection.getRng();Gt.setEditorTimeout(e,()=>{e.selection.setRng(n),e.execCommand("Delete")},0)}else e.execCommand("Delete")})},Sj=e=>t=>{!t.isDefaultPrevented()&&Kw(e)&&Vw(t,qw(e),jw(e),ce)},wj=e=>{e.on("cut",Ej(e)),e.on("copy",Sj(e))},Gw=(e,t)=>{var n,s;return eo.getCaretRangeFromPoint((n=t.clientX)!==null&&n!==void 0?n:0,(s=t.clientY)!==null&&s!==void 0?s:0,e.getDoc())},kj=e=>{const t=e["text/plain"];return t?t.indexOf("file://")===0:!1},Yw=(e,t)=>{e.focus(),t&&e.selection.setRng(t)},xj=e=>Ue(e.files,t=>/^image\//.test(t.type)),_j=(e,t,n,s)=>{const o=e.getParent(n,a=>zs(t,a));if(!wt(e.getParent(n,"summary")))return!0;if(o&&re(s,"text/html")){const a=new DOMParser().parseFromString(s["text/html"],"text/html").body;return!wt(a.querySelector(o.nodeName.toLowerCase()))}else return!1},Nj=e=>{e.on("input",t=>{const n=s=>wt(s.querySelector("summary"));if(t.inputType==="deleteByDrag"){const s=oe(e.dom.select("details"),n);P(s,o=>{Me(o.firstChild)&&o.firstChild.remove();const r=e.dom.create("summary");r.appendChild(Or().dom),o.prepend(r)})}})},Aj=(e,t)=>{LR(e)&&e.on("dragend dragover draggesture dragdrop drop drag",n=>{n.preventDefault(),n.stopPropagation()}),xi(e)||e.on("drop",n=>{const s=n.dataTransfer;s&&xj(s)&&n.preventDefault()}),e.on("drop",n=>{if(n.isDefaultPrevented())return;const s=Gw(e,n);if(je(s))return;const o=zw(n.dataTransfer),r=ws(o,Ol());if((!Hw(o)||kj(o))&&Ww(e,n,s))return;const a=o[Ol()],i=a||o["text/html"]||o["text/plain"],l=_j(e.dom,e.schema,s.startContainer,o),c=t.get();c&&!l||i&&(n.preventDefault(),Gt.setEditorTimeout(e,()=>{e.undoManager.transact(()=>{(a||c&&l)&&e.execCommand("Delete"),Yw(e,s);const u=Fw(i);o["text/html"]?Il(e,u,r,!0):ym(e,u,!0)})}))}),e.on("dragstart",n=>{t.set(!0)}),e.on("dragover dragend",n=>{xi(e)&&!t.get()&&(n.preventDefault(),Yw(e,Gw(e,n))),n.type==="dragend"&&t.set(!1)}),Nj(e)},Tj=e=>{const t=o=>r=>{o(e,r)},n=$R(e);ke(n)&&e.on("PastePreProcess",t(n));const s=FR(e);ke(s)&&e.on("PastePostProcess",t(s))},Rj=(e,t)=>{e.on("PastePreProcess",n=>{n.content=t(e,n.content,n.internal)})},Pj=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,Xw=e=>$.trim(e).replace(Pj,Lr).toLowerCase(),Dj=(e,t,n)=>{const s=UR(e);if(n||s==="all"||!zR(e))return t;const o=s?s.split(/[, ]/):[];if(o&&s!=="none"){const r=e.dom,a=e.selection.getNode();t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(i,l,c,u)=>{const f=r.parseStyle(r.decode(c)),d={};for(let b=0;b<o.length;b++){const g=f[o[b]];let h=g,y=r.getStyle(a,o[b],!0);/color/.test(o[b])&&(h=Xw(h),y=Xw(y)),y!==h&&(d[o[b]]=g)}const p=r.serializeStyle(d,"span");return p?l+' style="'+p+'"'+u:l+u})}else t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return t=t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(r,a,i,l)=>a+' style="'+i+'"'+l),t},Bj=e=>{(be.browser.isChromium()||be.browser.isSafari())&&Rj(e,Dj)},Oj=e=>{const t=et(!1),n=et(VR(e)?"text":"html"),s=H8(e);Bj(e),Cj(e,n),Tj(e),e.on("PreInit",()=>{wj(e),Aj(e,t),hj(e,s,n)})},Ij=e=>{e.on("click",t=>{e.dom.getParent(t.target,"details")&&t.preventDefault()})},Lj=e=>{e.parser.addNodeFilter("details",t=>{const n=rP(e);P(t,s=>{n==="expanded"?s.attr("open","open"):n==="collapsed"&&s.attr("open",null)})}),e.serializer.addNodeFilter("details",t=>{const n=aP(e);P(t,s=>{n==="expanded"?s.attr("open","open"):n==="collapsed"&&s.attr("open",null)})})},$j=e=>{Ij(e),Lj(e)},Fj=Me,Zw=B,Mj=e=>Be(e.dom),Uj=e=>nn(e.dom),Qw=e=>t=>ve(C.fromDom(e),t),zj=(e,t,n)=>Bs(C.fromDom(e),s=>Uj(s)||n.isBlock(pe(s)),Qw(t)).getOr(C.fromDom(t)).dom,Jw=(e,t)=>Bs(C.fromDom(e),Mj,Qw(t)),ek=(e,t,n)=>{const s=new Xe(e,t),o=n?s.next.bind(s):s.prev.bind(s);let r=e;for(let a=n?e:o();a&&!Fj(a);a=o())sn(a)&&(r=a);return r},Hj=(e,t,n)=>{const o=N.fromRangeStart(e).getNode(),r=zj(o,t,n),a=ek(o,r,!1),i=ek(o,r,!0),l=document.createRange();return Jw(a,r).fold(()=>{Zw(a)?l.setStart(a,0):l.setStartBefore(a)},c=>l.setStartBefore(c.dom)),Jw(i,r).fold(()=>{Zw(i)?l.setEnd(i,i.data.length):l.setEndAfter(i)},c=>l.setEndAfter(c.dom)),l},Wj=e=>{const t=Hj(e.selection.getRng(),e.getBody(),e.schema);e.selection.setRng(Lf(t))},Vj=e=>{e.on("mousedown",t=>{t.detail>=3&&(t.preventDefault(),Wj(e))})};var tr;(function(e){e.Before="before",e.After="after"})(tr||(tr={}));const jj=(e,t)=>Math.abs(e.left-t),qj=(e,t)=>Math.abs(e.right-t),Kj=(e,t)=>e>=t.top&&e<=t.bottom,Gj=(e,t)=>e.top<t.bottom&&e.bottom>t.top,Yj=(e,t)=>{const n=oT(e,t)/Math.min(e.height,t.height);return Gj(e,t)&&n>.5},Xj=(e,t)=>{const n=oe(e,s=>Kj(t,s));return sT(n).fold(()=>[[],e],s=>{const{pass:o,fail:r}=Co(e,a=>Yj(a,s));return[o,r]})},Zj=(e,t)=>({node:e.node,position:jj(e,t)<qj(e,t)?tr.Before:tr.After}),Qj=(e,t,n)=>t>e.left&&t<e.right?0:Math.min(Math.abs(e.left-t),Math.abs(e.right-t)),Em=(e,t,n)=>{const s=u=>sn(u.node)?m.some(u):G(u.node)?Em(Lt(u.node.childNodes),t,n):m.none(),o=(u,f)=>{if(u.length>=2){const d=s(u[0]).getOr(u[0]),p=s(u[1]).getOr(u[1]);if(Math.abs(f(d,t,n)-f(p,t,n))<2){if(B(d.node))return m.some(d);if(B(p.node))return m.some(p)}}return m.none()},r=(u,f)=>{const d=Ns(u,(p,b)=>f(p,t,n)-f(b,t,n));return o(d,f).orThunk(()=>yo(d,s))},[a,i]=Xj(vS(e),n),{pass:l,fail:c}=Co(i,u=>u.top<n);return r(a,Qj).orThunk(()=>r(c,lh)).orThunk(()=>r(l,lh))},Jj=(e,t,n,s)=>{const o=(r,a)=>{const i=c=>G(c)&&c.classList.contains("mce-drag-container"),l=oe(r.dom.childNodes,ur(i));return a.fold(()=>Em(l,n,s),c=>{const u=oe(l,f=>f!==c.dom);return Em(u,n,s)}).orThunk(()=>(ve(r,e)?m.none():Ja(r)).bind(u=>o(u,m.some(r))))};return o(t,m.none())},eq=(e,t,n)=>{const s=C.fromDom(e),o=qn(s),a=C.fromPoint(o,t,n).filter(i=>jn(s,i)).getOr(s);return Jj(s,a,t,n)},tk=(e,t,n)=>eq(e,t,n).filter(s=>Qr(s.node)).map(s=>Zj(s,t)),nk=e=>{var t,n;const s=e.getBoundingClientRect(),o=e.ownerDocument,r=o.documentElement,a=o.defaultView;return{top:s.top+((t=a==null?void 0:a.scrollY)!==null&&t!==void 0?t:0)-r.clientTop,left:s.left+((n=a==null?void 0:a.scrollX)!==null&&n!==void 0?n:0)-r.clientLeft}},tq=e=>e.inline?nk(e.getBody()):{left:0,top:0},nq=e=>{const t=e.getBody();return e.inline?{left:t.scrollLeft,top:t.scrollTop}:{left:0,top:0}},sq=e=>{const t=e.getBody(),n=e.getDoc().documentElement,s={left:t.scrollLeft,top:t.scrollTop},o={left:t.scrollLeft||n.scrollLeft,top:t.scrollTop||n.scrollTop};return e.inline?s:o},oq=(e,t)=>{if(t.target.ownerDocument!==e.getDoc()){const n=nk(e.getContentAreaContainer()),s=sq(e);return{left:t.pageX-n.left+s.left,top:t.pageY-n.top+s.top}}return{left:t.pageX,top:t.pageY}},rq=(e,t,n)=>({pageX:n.left-e.left+t.left,pageY:n.top-e.top+t.top}),aq=(e,t)=>rq(tq(e),nq(e),oq(e,t)),sk=e=>({target:e,srcElement:e}),iq=(e,t,n,s)=>({...t,dataTransfer:s,type:e,...sk(n)}),lq=(e,t,n)=>{const s=Xm("Function not supported on simulated event.");return{bubbles:!0,cancelBubble:!1,cancelable:!0,composed:!1,currentTarget:null,defaultPrevented:!1,eventPhase:0,isTrusted:!0,returnValue:!1,timeStamp:0,type:e,composedPath:s,initEvent:s,preventDefault:ce,stopImmediatePropagation:ce,stopPropagation:ce,AT_TARGET:window.Event.AT_TARGET,BUBBLING_PHASE:window.Event.BUBBLING_PHASE,CAPTURING_PHASE:window.Event.CAPTURING_PHASE,NONE:window.Event.NONE,altKey:!1,button:0,buttons:0,clientX:0,clientY:0,ctrlKey:!1,metaKey:!1,movementX:0,movementY:0,offsetX:0,offsetY:0,pageX:0,pageY:0,relatedTarget:null,screenX:0,screenY:0,shiftKey:!1,x:0,y:0,detail:0,view:null,which:0,initUIEvent:s,initMouseEvent:s,getModifierState:s,dataTransfer:n,...sk(t)}},cq=(e,t)=>{const n=P8(e);return t==="dragstart"?(Nw(n),Tw(n)):t==="drop"?(S8(n),mm(n)):(w8(n),N8(n)),n},uq=(e,t,n,s)=>{const o=cq(n,e);return lt(s)?lq(e,t,o):iq(e,s,t,o)},Ll=32,fq=100,$l=8,Fl=16,ok=Be,dq=lT(ok,nn),mq=(e,t,n)=>ok(n)&&n!==t&&e.isEditable(n.parentElement),gq=(e,t,n)=>je(t)||t===n||e.dom.isChildOf(t,n)?!1:e.dom.isEditable(t),pq=(e,t,n,s)=>{const o=e.dom,r=t.cloneNode(!0);o.setStyles(r,{width:n,height:s}),o.setAttrib(r,"data-mce-selected",null);const a=o.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return o.setStyles(a,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:s}),o.setStyles(r,{margin:0,boxSizing:"border-box"}),a.appendChild(r),a},hq=(e,t)=>{e.parentNode!==t&&t.appendChild(e)},Ml=(e,t)=>n=>()=>{const s=e==="left"?n.scrollX:n.scrollY;n.scroll({[e]:s+t,behavior:"smooth"})},rk=Ml("left",-Ll),ak=Ml("left",Ll),ik=Ml("top",-Ll),lk=Ml("top",Ll),bq=(e,t,n,s,o,r,a,i,l,c,u,f)=>{let d=0,p=0;e.style.left=t.pageX+"px",e.style.top=t.pageY+"px",t.pageX+n>o&&(d=t.pageX+n-o),t.pageY+s>r&&(p=t.pageY+s-r),e.style.width=n-d+"px",e.style.height=s-p+"px";const b=l.clientHeight,g=l.clientWidth,h=a+l.getBoundingClientRect().top,y=i+l.getBoundingClientRect().left;u.on(E=>{E.intervalId.clear(),E.dragging&&f&&(a+$l>=b?E.intervalId.set(lk(c)):a-$l<=0?E.intervalId.set(ik(c)):i+$l>=g?E.intervalId.set(ak(c)):i-$l<=0?E.intervalId.set(rk(c)):h+Fl>=window.innerHeight?E.intervalId.set(lk(window)):h-Fl<=0?E.intervalId.set(ik(window)):y+Fl>=window.innerWidth?E.intervalId.set(ak(window)):y-Fl<=0&&E.intervalId.set(rk(window)))})},ck=e=>{e&&e.parentNode&&e.parentNode.removeChild(e)},Cq=(e,t)=>{const n=e.getParent(t.parentNode,e.isBlock);ck(t),n&&n!==e.getRoot()&&e.isEmpty(n)&&ls(C.fromDom(n))},yq=e=>e.button===0,vq=(e,t)=>({pageX:t.pageX-e.relX,pageY:t.pageY+5}),Eq=(e,t)=>n=>{if(yq(n)){const s=Ye(t.dom.getParents(n.target),dq).getOr(null);if(M(s)&&mq(t.dom,t.getBody(),s)){const o=t.dom.getPos(s),r=t.getBody(),a=t.getDoc().documentElement;e.set({element:s,dataTransfer:gm(),dragging:!1,screenX:n.screenX,screenY:n.screenY,maxX:(t.inline?r.scrollWidth:a.offsetWidth)-2,maxY:(t.inline?r.scrollHeight:a.offsetHeight)-2,relX:n.pageX-o.x,relY:n.pageY-o.y,width:s.offsetWidth,height:s.offsetHeight,ghost:pq(t,s,s.offsetWidth,s.offsetHeight),intervalId:qA(fq)})}}},Sq=(e,t,n)=>{e._selectionOverrides.hideFakeCaret(),tk(e.getBody(),t,n).fold(()=>e.selection.placeCaretAt(t,n),s=>{const o=e._selectionOverrides.showCaret(1,s.node,s.position===tr.Before,!1);o?e.selection.setRng(o):e.selection.placeCaretAt(t,n)})},Ia=(e,t,n,s,o)=>{t==="dragstart"&&Dw(s,e.dom.getOuterHTML(n));const r=uq(t,n,s,o);return e.dispatch(t,r)},wq=(e,t)=>{const n=yi((o,r)=>Sq(t,o,r),0);t.on("remove",n.cancel);const s=e;return o=>e.on(r=>{const a=Math.max(Math.abs(o.screenX-r.screenX),Math.abs(o.screenY-r.screenY));if(!r.dragging&&a>10){const i=Ia(t,"dragstart",r.element,r.dataTransfer,o);if(M(i.dataTransfer)&&(r.dataTransfer=i.dataTransfer),i.isDefaultPrevented())return;r.dragging=!0,t.focus()}if(r.dragging){const i=o.currentTarget===t.getDoc().documentElement,l=vq(r,aq(t,o));hq(r.ghost,t.getBody()),bq(r.ghost,l,r.width,r.height,r.maxX,r.maxY,o.clientY,o.clientX,t.getContentAreaContainer(),t.getWin(),s,i),n.throttle(o.clientX,o.clientY)}})},kq=e=>{const t=e.getSel();if(M(t)){const s=t.getRangeAt(0).startContainer;return B(s)?s.parentNode:s}else return null},xq=(e,t)=>n=>{e.on(s=>{var o;if(s.intervalId.clear(),s.dragging){if(gq(t,kq(t.selection),s.element)){const r=(o=t.getDoc().elementFromPoint(n.clientX,n.clientY))!==null&&o!==void 0?o:t.getBody();Ia(t,"drop",r,s.dataTransfer,n).isDefaultPrevented()||t.undoManager.transact(()=>{Cq(t.dom,s.element),D8(s.dataTransfer).each(i=>t.insertContent(i)),t._selectionOverrides.hideFakeCaret()})}Ia(t,"dragend",t.getBody(),s.dataTransfer,n)}}),fk(e)},uk=(e,t,n)=>{e.on(s=>{s.intervalId.clear(),s.dragging&&n.fold(()=>Ia(t,"dragend",s.element,s.dataTransfer),o=>Ia(t,"dragend",s.element,s.dataTransfer,o))}),fk(e)},_q=(e,t)=>n=>uk(e,t,m.some(n)),fk=e=>{e.on(t=>{t.intervalId.clear(),ck(t.ghost)}),e.clear()},Nq=e=>{const t=ms(),n=Ae.DOM,s=document,o=Eq(t,e),r=wq(t,e),a=xq(t,e),i=_q(t,e);e.on("mousedown",o),e.on("mousemove",r),e.on("mouseup",a),n.bind(s,"mousemove",r),n.bind(s,"mouseup",i),e.on("remove",()=>{n.unbind(s,"mousemove",r),n.unbind(s,"mouseup",i)}),e.on("keydown",l=>{l.keyCode===H.ESC&&uk(t,e,m.none())})},Aq=e=>{const t=o=>{if(!o.isDefaultPrevented()){const r=o.dataTransfer;r&&(Ne(r.types,"Files")||r.files.length>0)&&(o.preventDefault(),o.type==="drop"&&ll(e,"Dropped file type is not supported"))}},n=o=>{Hi(e,o.target)&&t(o)},s=()=>{const o=Ae.DOM,r=e.dom,a=document,i=e.inline?e.getBody():e.getDoc(),l=["drop","dragover"];P(l,c=>{o.bind(a,c,n),r.bind(i,c,t)}),e.on("remove",()=>{P(l,c=>{o.unbind(a,c,n),r.unbind(i,c,t)})})};e.on("init",()=>{Gt.setEditorTimeout(e,s,0)})},Tq=e=>{Nq(e),_R(e)&&Aq(e)},Rq=e=>{const t=yi(()=>{if(!e.removed&&e.getBody().contains(document.activeElement)){const n=e.selection.getRng();if(n.collapsed){const s=kd(e,n,!1);e.selection.setRng(s)}}},0);e.on("focus",()=>{t.throttle()}),e.on("blur",()=>{t.cancel()})},Pq=e=>{e.on("init",()=>{e.on("focusin",t=>{const n=t.target;if(Rn(n)){const s=oo(e.getBody(),n),o=Be(s)?s:n;e.selection.getNode()!==o&&Sa(e,o).each(r=>e.selection.setRng(r))}})})},La=Be,dk=(e,t)=>oo(e.getBody(),t),Dq=e=>{const t=e.selection,n=e.dom,s=e.getBody(),o=yP(e,s,n.isBlock,()=>to(e)),r="sel-"+n.uniqueId(),a="data-mce-selected";let i;const l=U=>M(U)&&n.hasClass(U,"mce-offscreen-selection"),c=U=>U!==s&&(La(U)||Rn(U))&&n.isChildOf(U,s)&&n.isEditable(U.parentNode),u=U=>{U&&t.setRng(U)},f=(U,A,x,T=!0)=>e.dispatch("ShowCaret",{target:A,direction:U,before:x}).isDefaultPrevented()?null:(T&&t.scrollIntoView(A,U===-1),o.show(x,A)),d=U=>{U.hasAttribute("data-mce-caret")&&(zc(U),t.scrollIntoView(U))},p=()=>{e.on("click",A=>{n.isEditable(A.target)||(A.preventDefault(),e.focus())}),e.on("blur NewBlock",S),e.on("ResizeWindow FullscreenStateChanged",o.reposition),e.on("tap",A=>{const x=A.target,T=dk(e,x);La(T)?(A.preventDefault(),Sa(e,T).each(v)):c(x)&&Sa(e,x).each(v)},!0),e.on("mousedown",A=>{const x=A.target;if(x!==s&&x.nodeName!=="HTML"&&!n.isChildOf(x,s)||!kU(e,A.clientX,A.clientY))return;S(),O();const T=dk(e,x);La(T)?(A.preventDefault(),Sa(e,T).each(v)):tk(s,A.clientX,A.clientY).each(V=>{A.preventDefault();const Z=f(1,V.node,V.position===tr.Before,!1);u(Z),Xn(T)?T.focus():e.getBody().focus()})}),e.on("keypress",A=>{H.modifierPressed(A)||La(t.getNode())&&A.preventDefault()}),e.on("GetSelectionRange",A=>{let x=A.range;if(i){if(!i.parentNode){i=null;return}x=x.cloneRange(),x.selectNode(i),A.range=x}}),e.on("SetSelectionRange",A=>{A.range=h(A.range);const x=v(A.range,A.forward);x&&(A.range=x)});const U=A=>G(A)&&A.id==="mcepastebin";e.on("AfterSetSelectionRange",A=>{const x=A.range,T=x.startContainer.parentElement;!g(x)&&!U(T)&&O(),l(T)||S()}),Tq(e),Rq(e),Pq(e)},b=U=>Wt(U)||ui(U)||fi(U),g=U=>b(U.startContainer)||b(U.endContainer),h=U=>{const A=e.schema.getVoidElements(),x=n.createRng(),T=U.startContainer,V=U.startOffset,Z=U.endContainer,ae=U.endOffset;return re(A,T.nodeName.toLowerCase())?V===0?x.setStartBefore(T):x.setStartAfter(T):x.setStart(T,V),re(A,Z.nodeName.toLowerCase())?ae===0?x.setEndBefore(Z):x.setEndAfter(Z):x.setEnd(Z,ae),x},y=(U,A)=>{const x=C.fromDom(e.getBody()),T=e.getDoc(),V=Nr(x,"#"+r).getOrThunk(()=>{const ie=C.fromHtml('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>',T);return st(ie,"id",r),Ve(x,ie),ie}),Z=n.createRng();No(V),Ls(V,[C.fromText(Je,T),C.fromDom(A),C.fromText(Je,T)]),Z.setStart(V.dom.firstChild,1),Z.setEnd(V.dom.lastChild,0),ei(V,{top:n.getPos(U,e.getBody()).y+"px"}),hC(V);const ae=t.getSel();return ae&&(ae.removeAllRanges(),ae.addRange(Z)),Z},E=U=>{const A=U.cloneNode(!0),x=e.dispatch("ObjectSelected",{target:U,targetClone:A});if(x.isDefaultPrevented())return null;const T=y(U,x.targetClone),V=C.fromDom(U);return P(gt(C.fromDom(e.getBody()),`*[${a}]`),Z=>{ve(V,Z)||ot(Z,a)}),n.getAttrib(U,a)||U.setAttribute(a,"1"),i=U,O(),T},v=(U,A)=>{if(!U)return null;if(U.collapsed){if(!g(U)){const Z=A?1:-1,ae=na(Z,s,U),ie=ae.getNode(!A);if(M(ie)){if(Qr(ie))return f(Z,ie,A?!ae.isAtEnd():!1,!1);if(cs(ie)&&Be(ie.nextSibling)){const xe=n.createRng();return xe.setStart(ie,0),xe.setEnd(ie,0),xe}}const Ce=ae.getNode(A);if(M(Ce)){if(Qr(Ce))return f(Z,Ce,A?!1:!ae.isAtEnd(),!1);if(cs(Ce)&&Be(Ce.previousSibling)){const xe=n.createRng();return xe.setStart(Ce,1),xe.setEnd(Ce,1),xe}}}return null}let x=U.startContainer,T=U.startOffset;const V=U.endOffset;if(B(x)&&T===0&&La(x.parentNode)&&(x=x.parentNode,T=n.nodeIndex(x),x=x.parentNode),!G(x))return null;if(V===T+1&&x===U.endContainer){const Z=x.childNodes[T];if(c(Z))return E(Z)}return null},S=()=>{i&&i.removeAttribute(a),Nr(C.fromDom(e.getBody()),"#"+r).each(De),i=null},R=()=>{o.destroy(),i=null},O=()=>{o.hide()};return $n(e)||p(),{showCaret:f,showBlockCaretContainer:d,hideFakeCaret:O,destroy:R}},Bq=(e,t)=>{let n=t;for(let s=e.previousSibling;B(s);s=s.previousSibling)n+=s.data.length;return n},mk=(e,t,n,s,o)=>{if(B(n)&&(s<0||s>n.data.length))return[];const r=o&&B(n)?[Bq(n,s)]:[s];let a=n;for(;a!==t&&a.parentNode;)r.push(e.nodeIndex(a,o)),a=a.parentNode;return a===t?r.reverse():[]},Sm=(e,t,n,s,o,r,a=!1)=>{const i=mk(e,t,n,s,a),l=mk(e,t,o,r,a);return{start:i,end:l}},gk=(e,t)=>{const n=t.slice(),s=n.pop();return dn(s)?Tt(n,(r,a)=>r.bind(i=>m.from(i.childNodes[a])),m.some(e)).bind(r=>B(r)&&(s<0||s>r.data.length)?m.none():m.some({node:r,offset:s})):m.none()},pk=(e,t)=>gk(e,t.start).bind(({node:n,offset:s})=>gk(e,t.end).map(({node:o,offset:r})=>{const a=document.createRange();return a.setStart(n,s),a.setEnd(o,r),a})),Oq=(e,t,n,s=!1)=>Sm(e,t,n.startContainer,n.startOffset,n.endContainer,n.endOffset,s),nr=(e,t,n)=>{if(t&&e.isEmpty(t)&&!n(t)){const s=t.parentNode;e.remove(t,B(t.firstChild)&&us(t.firstChild.data)),nr(e,s,n)}},Ul=(e,t,n,s=!0)=>{const o=t.startContainer.parentNode,r=t.endContainer.parentNode;t.deleteContents(),s&&!n(t.startContainer)&&(B(t.startContainer)&&t.startContainer.data.length===0&&e.remove(t.startContainer),B(t.endContainer)&&t.endContainer.data.length===0&&e.remove(t.endContainer),nr(e,o,n),o!==r&&nr(e,r,n))},wm=(e,t)=>m.from(e.dom.getParent(t.startContainer,e.dom.isBlock)),hk=(e,t,n)=>{const s=e.dynamicPatternsLookup({text:n,block:t});return{...e,blockPatterns:Ph(s).concat(e.blockPatterns),inlinePatterns:Dh(s).concat(e.inlinePatterns)}},bk=(e,t,n,s)=>{const o=e.createRng();return o.setStart(t,0),o.setEnd(n,s),o.toString()},Iq=e=>/^\s[^\s]/.test(e),Ck=(e,t,n)=>{PW(t,0,t).each(o=>{const r=o.container;k0(r,n.start.length,t).each(l=>{const c=e.createRng();c.setStart(r,0),c.setEnd(l.container,l.offset),Ul(e,c,u=>u===t)});const a=C.fromDom(r),i=ii(a);Iq(i)&&oN(a,i.slice(1))})},Lq=(e,t)=>{const n=e.dom,s=t.pattern,o=pk(n.getRoot(),t.range).getOrDie("Unable to resolve path range"),r=(a,i)=>{const l=i.get(a);return Ge(l)&&Rt(l).exists(c=>re(c,"block"))};return wm(e,o).each(a=>{s.type==="block-format"?r(s.format,e.formatter)&&e.undoManager.transact(()=>{Ck(e.dom,a,s),e.formatter.apply(s.format)}):s.type==="block-command"&&e.undoManager.transact(()=>{Ck(e.dom,a,s),e.execCommand(s.cmd,!1,s.value)})}),!0},$q=e=>Ns(e,(t,n)=>n.start.length-t.start.length),Fq=(e,t)=>{const n=$q(e),s=t.replace(Je," ");return Ye(n,o=>t.indexOf(o.start)===0||s.indexOf(o.start)===0)},Mq=(e,t,n,s)=>{var o;const r=e.dom,a=pt(e);if(!r.is(t,a))return[];const i=(o=t.textContent)!==null&&o!==void 0?o:"";return Fq(n.blockPatterns,i).map(l=>$.trim(i).length===l.start.length?[]:[{pattern:l,range:Sm(r,r.getRoot(),t,0,t,0,s)}]).getOr([])},Uq=(e,t)=>{if(t.length===0)return;const n=e.selection.getBookmark();P(t,s=>Lq(e,s)),e.selection.moveToBookmark(n)},yk=(e,t)=>e.create("span",{"data-mce-type":"bookmark",id:t}),zl=(e,t)=>{const n=e.createRng();return n.setStartAfter(t.start),n.setEndBefore(t.end),n},vk=(e,t,n)=>{const s=pk(e.getRoot(),n).getOrDie("Unable to resolve path range"),o=s.startContainer,r=s.endContainer,a=s.endOffset===0?r:r.splitText(s.endOffset),i=s.startOffset===0?o:o.splitText(s.startOffset),l=i.parentNode,c=a.parentNode;return{prefix:t,end:c.insertBefore(yk(e,t+"-end"),a),start:l.insertBefore(yk(e,t+"-start"),i)}},Ek=(e,t,n)=>{nr(e,e.get(t.prefix+"-end"),n),nr(e,e.get(t.prefix+"-start"),n)},km=e=>e.start.length===0,zq=e=>(t,n)=>{const o=t.data.substring(0,n),r=o.lastIndexOf(e.charAt(e.length-1)),a=o.lastIndexOf(e);return a!==-1?a+e.length:r!==-1?r+1:-1},Sk=(e,t,n,s)=>{const o=t.start;return Kd(e,s.container,s.offset,zq(o),n).bind(a=>{var i,l;const c=(l=(i=n.textContent)===null||i===void 0?void 0:i.indexOf(o))!==null&&l!==void 0?l:-1;if(c!==-1&&a.offset>=c+o.length){const f=e.createRng();return f.setStart(a.container,a.offset-o.length),f.setEnd(a.container,a.offset),m.some(f)}else{const f=a.offset-o.length;return qd(a.container,f,n).map(d=>{const p=e.createRng();return p.setStart(d.container,d.offset),p.setEnd(a.container,a.offset),p}).filter(d=>d.toString()===o).orThunk(()=>Sk(e,t,n,vn(a.container,0)))}})},Hq=(e,t,n,s,o,r=!1)=>{if(t.start.length===0&&!r){const a=e.createRng();return a.setStart(n,s),a.setEnd(n,s),m.some(a)}return jd(n,s,o).bind(a=>Sk(e,t,o,a).bind(l=>{var c;if(r){if(l.endContainer===a.container&&l.endOffset===a.offset)return m.none();if(a.offset===0&&((c=l.endContainer.textContent)===null||c===void 0?void 0:c.length)===l.endOffset)return m.none()}return m.some(l)}))},Wq=(e,t,n,s)=>{const o=e.dom,r=o.getRoot(),a=n.pattern,i=n.position.container,l=n.position.offset;return qd(i,l-n.pattern.end.length,t).bind(c=>{const u=Sm(o,r,c.container,c.offset,i,l,s);if(km(a))return m.some({matches:[{pattern:a,startRng:u,endRng:u}],position:c});{const f=Hl(e,n.remainingPatterns,c.container,c.offset,t,s),d=f.getOr({matches:[],position:c}),p=d.position;return Hq(o,a,p.container,p.offset,t,f.isNone()).map(g=>{const h=Oq(o,r,g,s);return{matches:d.matches.concat([{pattern:a,startRng:h,endRng:u}]),position:vn(g.startContainer,g.startOffset)}})}})},Hl=(e,t,n,s,o,r)=>{const a=e.dom;return jd(n,s,a.getRoot()).bind(i=>{const l=bk(a,o,n,s);for(let c=0;c<t.length;c++){const u=t[c];if(!bc(l,u.end))continue;const f=t.slice();f.splice(c,1);const d=Wq(e,o,{pattern:u,remainingPatterns:f,position:i},r);if(d.isNone()&&s>0)return Hl(e,t,n,s-1,o,r);if(d.isSome())return d}return m.none()})},wk=(e,t,n)=>{e.selection.setRng(n),t.type==="inline-format"?P(t.format,s=>{e.formatter.apply(s)}):e.execCommand(t.cmd,!1,t.value)},Vq=(e,t,n,s)=>{const o=zl(e.dom,n);Ul(e.dom,o,s),wk(e,t,o)},jq=(e,t,n,s,o)=>{const r=e.dom,a=zl(r,s),i=zl(r,n);Ul(r,i,o),Ul(r,a,o);const l={prefix:n.prefix,start:n.end,end:s.start},c=zl(r,l);wk(e,t,c)},qq=(e,t)=>{const n=Vr("mce_textpattern"),s=dr(t,(o,r)=>{const a=vk(e,n+`_end${o.length}`,r.endRng);return o.concat([{...r,endMarker:a}])},[]);return dr(s,(o,r)=>{const a=s.length-o.length-1,i=km(r.pattern)?r.endMarker:vk(e,n+`_start${a}`,r.startRng);return o.concat([{...r,startMarker:i}])},[])},Kq=e=>Ns(e,(t,n)=>n.end.length-t.end.length),Gq=(e,t)=>{const n=rs(e,s=>Ue(t,o=>s.pattern.start===o.pattern.start&&s.pattern.end===o.pattern.end));return e.length===t.length?n?e:t:e.length>t.length?e:t},kk=(e,t,n,s,o,r)=>{const a=Hl(e,o.inlinePatterns,n,s,t,r).fold(()=>[],l=>l.matches),i=Hl(e,Kq(o.inlinePatterns),n,s,t,r).fold(()=>[],l=>l.matches);return Gq(a,i)},xk=(e,t)=>{if(t.length===0)return;const n=e.dom,s=e.selection.getBookmark(),o=qq(n,t);P(o,r=>{const a=n.getParent(r.startMarker.start,n.isBlock),i=l=>l===a;km(r.pattern)?Vq(e,r.pattern,r.endMarker,i):jq(e,r.pattern,r.startMarker,r.endMarker,i),Ek(n,r.endMarker,i),Ek(n,r.startMarker,i)}),e.selection.moveToBookmark(s)},Yq=(e,t)=>{const n=e.selection.getRng();return wm(e,n).map(s=>{var o;const r=Math.max(0,n.startOffset),a=hk(t,s,(o=s.textContent)!==null&&o!==void 0?o:""),i=kk(e,s,n.startContainer,r,a,!0),l=Mq(e,s,a,!0);return l.length>0||i.length>0?(e.undoManager.add(),e.undoManager.extra(()=>{e.execCommand("mceInsertNewLine")},()=>{hN(e),xk(e,i),Uq(e,l);const c=e.selection.getRng(),u=jd(c.startContainer,c.startOffset,e.dom.getRoot());e.execCommand("mceInsertNewLine"),u.each(f=>{const d=f.container;d.data.charAt(f.offset-1)===Pr&&(d.deleteData(f.offset-1,1),nr(e.dom,d.parentNode,p=>p===e.dom.getRoot()))})}),!0):!1}).getOr(!1)},Xq=(e,t)=>{const n=e.selection.getRng();wm(e,n).map(s=>{const o=Math.max(0,n.startOffset-1),r=bk(e.dom,s,n.startContainer,o),a=hk(t,s,r),i=kk(e,s,n.startContainer,o,a,!1);i.length>0&&e.undoManager.transact(()=>{xk(e,i)})})},_k=(e,t,n)=>{for(let s=0;s<e.length;s++)if(n(e[s],t))return!0;return!1},Zq=(e,t)=>_k(e,t,(n,s)=>n===s.keyCode&&!H.modifierPressed(s)),Qq=(e,t)=>_k(e,t,(n,s)=>n.charCodeAt(0)===s.charCode),Jq=e=>{const t=[",",".",";",":","!","?"],n=[32],s=()=>BT(KR(e),GR(e)),o=()=>eP(e);e.on("keydown",a=>{if(a.keyCode===13&&!H.modifierPressed(a)&&e.selection.isCollapsed()){const i=s();(i.inlinePatterns.length>0||i.blockPatterns.length>0||o())&&Yq(e,i)&&a.preventDefault()}},!0);const r=()=>{if(e.selection.isCollapsed()){const a=s();(a.inlinePatterns.length>0||o())&&Xq(e,a)}};e.on("keyup",a=>{Zq(n,a)&&r()}),e.on("keypress",a=>{Qq(t,a)&&Gt.setEditorTimeout(e,r)})},e6=e=>{Jq(e)},t6=e=>{const t=$.each,n=H.BACKSPACE,s=H.DELETE,o=e.dom,r=e.selection,a=e.parser,i=be.browser,l=i.isFirefox(),c=i.isChromium()||i.isSafari(),u=be.deviceType.isiPhone()||be.deviceType.isiPad(),f=be.os.isMacOS()||be.os.isiOS(),d=(j,ee)=>{try{e.getDoc().execCommand(j,!1,String(ee))}catch{}},p=j=>j.isDefaultPrevented(),b=()=>{const j=I=>{const te=o.create("body"),de=I.cloneContents();return te.appendChild(de),r.serializer.serialize(te,{format:"html"})},ee=I=>{const te=j(I),de=o.createRng();de.selectNode(e.getBody());const we=j(de);return te===we};e.on("keydown",I=>{const te=I.keyCode;if(!p(I)&&(te===s||te===n)&&e.selection.isEditable()){const de=e.selection.isCollapsed(),we=e.getBody();if(de&&!ze(C.fromDom(we))||!de&&!ee(e.selection.getRng()))return;I.preventDefault(),e.setContent(""),we.firstChild&&o.isBlock(we.firstChild)?e.selection.setCursorLocation(we.firstChild,0):e.selection.setCursorLocation(we,0),e.nodeChanged()}})},g=()=>{e.shortcuts.add("meta+a",null,"SelectAll")},h=()=>{e.inline||o.bind(e.getDoc(),"mousedown mouseup",j=>{let ee;if(j.target===e.getDoc().documentElement)if(ee=r.getRng(),e.getBody().focus(),j.type==="mousedown"){if(Wt(ee.startContainer))return;r.placeCaretAt(j.clientX,j.clientY)}else r.setRng(ee)})},y=()=>{e.on("keydown",j=>{if(!p(j)&&j.keyCode===n){if(!e.getBody().getElementsByTagName("hr").length)return;if(r.isCollapsed()&&r.getRng().startOffset===0){const ee=r.getNode(),I=ee.previousSibling;if(ee.nodeName==="HR"){o.remove(ee),j.preventDefault();return}I&&I.nodeName&&I.nodeName.toLowerCase()==="hr"&&(o.remove(I),j.preventDefault())}}})},E=()=>{Range.prototype.getClientRects||e.on("mousedown",j=>{if(!p(j)&&j.target.nodeName==="HTML"){const ee=e.getBody();ee.blur(),Gt.setEditorTimeout(e,()=>{ee.focus()})}})},v=()=>{const j=Gh(e);e.on("click",ee=>{const I=ee.target;/^(IMG|HR)$/.test(I.nodeName)&&o.isEditable(I)&&(ee.preventDefault(),e.selection.select(I),e.nodeChanged()),I.nodeName==="A"&&o.hasClass(I,j)&&I.childNodes.length===0&&o.isEditable(I.parentNode)&&(ee.preventDefault(),r.select(I))})},S=()=>{const j=()=>{const I=o.getAttribs(r.getStart().cloneNode(!1));return()=>{const te=r.getStart();te!==e.getBody()&&(o.setAttrib(te,"style",null),t(I,de=>{te.setAttributeNode(de.cloneNode(!0))}))}},ee=()=>!r.isCollapsed()&&o.getParent(r.getStart(),o.isBlock)!==o.getParent(r.getEnd(),o.isBlock);e.on("keypress",I=>{let te;return!p(I)&&(I.keyCode===8||I.keyCode===46)&&ee()?(te=j(),e.getDoc().execCommand("delete",!1),te(),I.preventDefault(),!1):!0}),o.bind(e.getDoc(),"cut",I=>{if(!p(I)&&ee()){const te=j();Gt.setEditorTimeout(e,()=>{te()})}})},R=()=>{e.on("keydown",j=>{if(!p(j)&&j.keyCode===n&&r.isCollapsed()&&r.getRng().startOffset===0){const ee=r.getNode().previousSibling;if(ee&&ee.nodeName&&ee.nodeName.toLowerCase()==="table")return j.preventDefault(),!1}return!0})},O=()=>{e.on("keydown",j=>{if(p(j)||j.keyCode!==H.BACKSPACE)return;let ee=r.getRng();const I=ee.startContainer,te=ee.startOffset,de=o.getRoot();let we=I;if(!(!ee.collapsed||te!==0)){for(;we.parentNode&&we.parentNode.firstChild===we&&we.parentNode!==de;)we=we.parentNode;we.nodeName==="BLOCKQUOTE"&&(e.formatter.toggle("blockquote",void 0,we),ee=o.createRng(),ee.setStart(I,0),ee.setEnd(I,0),r.setRng(ee))}})},U=()=>{const j=()=>{d("StyleWithCSS",!1),d("enableInlineTableEditing",!1),Vh(e)||d("enableObjectResizing",!1)};qh(e)||e.on("BeforeExecCommand mousedown",j)},A=()=>{const j=()=>{t(o.select("a:not([data-mce-block])"),ee=>{var I;let te=ee.parentNode;const de=o.getRoot();if((te==null?void 0:te.lastChild)===ee){for(;te&&!o.isBlock(te);){if(((I=te.parentNode)===null||I===void 0?void 0:I.lastChild)!==te||te===de)return;te=te.parentNode}o.add(te,"br",{"data-mce-bogus":1})}})};e.on("SetContent ExecCommand",ee=>{(ee.type==="setcontent"||ee.command==="mceInsertLink")&&j()})},x=()=>{e.on("init",()=>{d("DefaultParagraphSeparator",pt(e))})},T=j=>{const ee=j.getBody(),I=j.selection.getRng();return I.startContainer===I.endContainer&&I.startContainer===ee&&I.startOffset===0&&I.endOffset===ee.childNodes.length},V=()=>{e.on("keyup focusin mouseup",j=>{!H.modifierPressed(j)&&!T(e)&&r.normalize()},!0)},Z=()=>{e.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},ae=()=>{e.inline||e.on("keydown",()=>{document.activeElement===document.body&&e.getWin().focus()})},ie=()=>{e.inline||(e.contentStyles.push("body {min-height: 150px}"),e.on("click",j=>{let ee;j.target.nodeName==="HTML"&&(ee=e.selection.getRng(),e.getBody().focus(),e.selection.setRng(ee),e.selection.normalize(),e.nodeChanged())}))},Ce=()=>{f&&e.on("keydown",j=>{H.metaKeyPressed(j)&&!j.shiftKey&&(j.keyCode===37||j.keyCode===39)&&(j.preventDefault(),e.selection.getSel().modify("move",j.keyCode===37?"backward":"forward","lineboundary"))})},xe=()=>{e.on("click",j=>{let ee=j.target;do if(ee.tagName==="A"){j.preventDefault();return}while(ee=ee.parentNode)}),e.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},Ie=()=>{e.on("init",()=>{e.dom.bind(e.getBody(),"submit",j=>{j.preventDefault()})})},nt=()=>{a.addNodeFilter("br",j=>{let ee=j.length;for(;ee--;)j[ee].attr("class")==="Apple-interchange-newline"&&j[ee].remove()})},ye=ce,F=()=>{if(!l||e.removed)return!1;const j=e.selection.getSel();return!j||!j.rangeCount||j.rangeCount===0},Y=()=>{c&&(h(),v(),Ie(),g(),u&&(ae(),ie(),xe())),l&&(E(),U(),Z(),Ce())},me=()=>{e.on("drop",j=>{var ee;const I=(ee=j.dataTransfer)===null||ee===void 0?void 0:ee.getData("text/html");Q(I)&&/^<img[^>]*>$/.test(I)&&e.dispatch("dragend",new window.DragEvent("dragend",j))})},ue=()=>{O(),b(),be.windowsPhone||V(),c&&(h(),v(),x(),Ie(),R(),nt(),u?(ae(),ie(),xe()):g()),l&&(y(),E(),S(),U(),A(),Z(),Ce(),R(),me())};return $n(e)?Y():ue(),{refreshContentEditable:ye,isHidden:F}},xm=Ae.DOM,n6=(e,t)=>{const n=C.fromDom(e.getBody()),s=Nc(as(n)),o=C.fromTag("style");st(o,"type","text/css"),Ve(o,C.fromText(t)),Ve(s,o),e.on("remove",()=>{De(o)})},s6=e=>e.inline?e.getElement().nodeName.toLowerCase():void 0,_m=e=>pr(e,t=>lt(t)===!1),Nk=e=>{const t=e.options.get,n=e.editorUpload.blobCache;return _m({allow_conditional_comments:t("allow_conditional_comments"),allow_html_data_urls:t("allow_html_data_urls"),allow_svg_data_urls:t("allow_svg_data_urls"),allow_html_in_named_anchor:t("allow_html_in_named_anchor"),allow_script_urls:t("allow_script_urls"),allow_unsafe_link_target:t("allow_unsafe_link_target"),convert_unsafe_embeds:t("convert_unsafe_embeds"),convert_fonts_to_spans:t("convert_fonts_to_spans"),fix_list_elements:t("fix_list_elements"),font_size_legacy_values:t("font_size_legacy_values"),forced_root_block:t("forced_root_block"),forced_root_block_attrs:t("forced_root_block_attrs"),preserve_cdata:t("preserve_cdata"),inline_styles:t("inline_styles"),root_name:s6(e),sandbox_iframes:t("sandbox_iframes"),sanitize:t("xss_sanitization"),validate:!0,blob_cache:n,document:e.getDoc()})},Ak=e=>{const t=e.options.get;return _m({custom_elements:t("custom_elements"),extended_valid_elements:t("extended_valid_elements"),invalid_elements:t("invalid_elements"),invalid_styles:t("invalid_styles"),schema:t("schema"),valid_children:t("valid_children"),valid_classes:t("valid_classes"),valid_elements:t("valid_elements"),valid_styles:t("valid_styles"),verify_html:t("verify_html"),padd_empty_block_inline_children:t("format_empty_lines")})},o6=e=>{const t=e.options.get;return{...Nk(e),...Ak(e),..._m({remove_trailing_brs:t("remove_trailing_brs"),pad_empty_with_br:t("pad_empty_with_br"),url_converter:t("url_converter"),url_converter_scope:t("url_converter_scope"),element_format:t("element_format"),entities:t("entities"),entity_encoding:t("entity_encoding"),indent:t("indent"),indent_after:t("indent_after"),indent_before:t("indent_before")})}},r6=e=>{const t=Ko(Nk(e),e.schema);return t.addAttributeFilter("src,href,style,tabindex",(n,s)=>{const o=e.dom,r="data-mce-"+s;let a=n.length;for(;a--;){const i=n[a];let l=i.attr(s);if(l&&!i.attr(r)){if(l.indexOf("data:")===0||l.indexOf("blob:")===0)continue;s==="style"?(l=o.serializeStyle(o.parseStyle(l),i.name),l.length||(l=null),i.attr(r,l),i.attr(s,l)):s==="tabindex"?(i.attr(r,l),i.attr(s,null)):i.attr(r,e.convertURL(l,s,i.name))}}}),t.addNodeFilter("script",n=>{let s=n.length;for(;s--;){const o=n[s],r=o.attr("type")||"no/type";r.indexOf("mce-")!==0&&o.attr("type","mce-"+r)}}),ZR(e)&&t.addNodeFilter("#cdata",n=>{var s;let o=n.length;for(;o--;){const r=n[o];r.type=8,r.name="#comment",r.value="[CDATA["+e.dom.encode((s=r.value)!==null&&s!==void 0?s:"")+"]]"}}),t.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",n=>{let s=n.length;const o=e.schema.getNonEmptyElements();for(;s--;){const r=n[s];r.isEmpty(o)&&r.getAll("br").length===0&&r.append(new vt("br",1))}}),t},a6=e=>{const t=BR(e);t&&Gt.setEditorTimeout(e,()=>{let n;t===!0?n=e:n=e.editorManager.get(t),n&&!n.destroyed&&(n.focus(),n.selection.scrollIntoView())},100)},i6=e=>{const t=e.dom.getRoot();!e.inline&&(!Di(e)||e.selection.getStart(!0)===t)&&ht(t).each(n=>{const s=n.getNode(),o=Zn(s)?ht(s).getOr(n):n;e.selection.setRng(o.toRange())})},l6=e=>{e.bindPendingEventDelegates(),e.initialized=!0,RD(e),e.focus(!0),i6(e),e.nodeChanged({initial:!0});const t=PR(e);ke(t)&&t.call(e,e),a6(e)},Nm=e=>e.inline?e.ui.styleSheetLoader:e.dom.styleSheetLoader,c6=(e,t,n)=>{const{pass:s,fail:o}=Co(t,i=>tinymce.Resource.has(yd(i))),a=[...s.map(i=>{const l=tinymce.Resource.get(yd(i));return Q(l)?Promise.resolve(Nm(e).loadRawCss(i,l)):Promise.resolve()}),Nm(e).loadAll(o)];return e.inline?a:a.concat([e.ui.styleSheetLoader.loadAll(n)])},Tk=e=>{const t=Nm(e),n=Wh(e),s=e.contentCSS,o=()=>{t.unloadAll(s),e.inline||e.ui.styleSheetLoader.unloadAll(n)},r=()=>{e.removed?o():e.on("remove",o)};if(e.contentStyles.length>0){let l="";$.each(e.contentStyles,c=>{l+=c+`\r
`}),e.dom.addStyle(l)}const a=Promise.all(c6(e,s,n)).then(r).catch(r),i=rR(e);return i&&n6(e,i),a},u6=e=>{const t=e.getDoc(),n=e.getBody();AD(e),OR(e)||(t.body.spellcheck=!1,xm.setAttrib(n,"spellcheck","false")),e.quirks=t6(e),TD(e);const s=aR(e);s!==void 0&&(n.dir=s);const o=IR(e);o&&e.on("BeforeSetContent",r=>{$.each(o,a=>{r.content=r.content.replace(a,i=>"<!--mce:protected "+escape(i)+"-->")})}),e.on("SetContent",()=>{e.addVisual(e.getBody())}),e.on("compositionstart compositionend",r=>{e.composing=r.type==="compositionstart"})},f6=e=>{$n(e)||e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"})},Am=e=>{e.removed!==!0&&(f6(e),l6(e))},d6=e=>{let t=!1;const n=setTimeout(()=>{t||e.setProgressState(!0)},500);return()=>{clearTimeout(n),t=!0,e.setProgressState(!1)}},Rk=e=>{const t=e.getElement();let n=e.getDoc();e.inline&&(xm.addClass(t,"mce-content-body"),e.contentDocument=n=document,e.contentWindow=window,e.bodyElement=t,e.contentAreaContainer=t);const s=e.getBody();s.disabled=!0,e.readonly=qh(e),e._editableRoot=kR(e),!e.readonly&&e.hasEditableRoot()&&(e.inline&&xm.getStyle(s,"position",!0)==="static"&&(s.style.position="relative"),s.contentEditable="true"),s.disabled=!1,e.editorUpload=ZU(e),e.schema=ds(Ak(e)),e.dom=Ae(n,{keep_values:!0,url_converter:e.convertURL,url_converter_scope:e,update_styles:!0,root_element:e.inline?e.getBody():null,collect:e.inline,schema:e.schema,contentCssCors:tR(e),referrerPolicy:yu(e),onSetAttrib:a=>{e.dispatch("SetAttrib",a)},force_hex_color:iP(e)}),e.parser=r6(e),e.serializer=EE(o6(e),e),e.selection=vE(e.dom,e.getWin(),e.serializer,e),e.annotator=Wb(e),e.formatter=LE(e),e.undoManager=FE(e),e._nodeChangeDispatcher=new b8(e),e._selectionOverrides=Dq(e),w2(e),$j(e),P2(e),$n(e)||(Vj(e),e6(e));const o=h8(e);v2(e,o),A2(e),dz(e),Oj(e);const r=eM(e);u6(e),r.fold(()=>{const a=d6(e);Tk(e).then(()=>{Am(e),a()})},a=>{e.setProgressState(!0),Tk(e).then(()=>{a().then(i=>{e.setProgressState(!1),Am(e),pE(e)},i=>{e.notificationManager.open({type:"error",text:String(i)}),Am(e),pE(e)})})})},m6=We,g6=(e,t,n)=>W_(e,t,m6,n),Tm=Ae.DOM,p6=(e,t,n,s)=>{const o=C.fromTag("iframe");return s.each(r=>st(o,"tabindex",r)),Wn(o,n),Wn(o,{id:e+"_ifr",frameBorder:"0",allowTransparency:"true",title:t}),ko(o,"tox-edit-area__iframe"),o},h6=e=>{let t=UT(e)+"<html><head>";Lh(e)!==e.documentBaseUrl&&(t+='<base href="'+e.documentBaseURI.getURI()+'" />'),t+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';const n=zT(e),s=HT(e),o=e.translate(TR(e));return $h(e)&&(t+='<meta http-equiv="Content-Security-Policy" content="'+$h(e)+'" />'),t+=`</head><body id="${n}" class="mce-content-body ${s}" data-id="${e.id}" aria-label="${o}"><br></body></html>`,t},b6=(e,t)=>{const n=e.translate("Rich Text Area"),s=Vn(C.fromDom(e.getElement()),"tabindex").bind(Ya),o=p6(e.id,n,MT(e),s).dom;o.onload=()=>{o.onload=null,e.dispatch("load")},e.contentAreaContainer=t.iframeContainer,e.iframeElement=o,e.iframeHTML=h6(e),Tm.add(t.iframeContainer,o)},C6=e=>{const t=e.iframeElement,n=()=>{e.contentDocument=t.contentDocument,Rk(e)};if(JR(e)||be.browser.isFirefox()){const s=e.getDoc();s.open(),s.write(e.iframeHTML),s.close(),n()}else{const s=g6(C.fromDom(t),"load",()=>{s.unbind(),n()});t.srcdoc=e.iframeHTML}},y6=(e,t)=>{b6(e,t),t.editorContainer&&(t.editorContainer.style.display=e.orgDisplay,e.hidden=Tm.isHidden(t.editorContainer)),e.getElement().style.display="none",Tm.setAttrib(e.id,"aria-hidden","true"),e.getElement().style.visibility=e.orgVisibility,C6(e)},Pk=Ae.DOM,v6=(e,t,n)=>{const s=Yo.get(n),o=Yo.urls[n]||e.documentBaseUrl.replace(/\/$/,"");if(n=$.trim(n),s&&$.inArray(t,n)===-1){if(e.plugins[n])return;try{const r=s(e,o)||{};e.plugins[n]=r,ke(r.init)&&(r.init(e,o),t.push(n))}catch(r){IU(e,n,r)}}},E6=e=>e.replace(/^\-/,""),S6=e=>{const t=[];P(ki(e),n=>{v6(e,t,E6(n))})},w6=e=>{const t=$.trim(Uh(e)),n=e.ui.registry.getAll().icons,s={...il.get("default").icons,...il.get(t).icons};Te(s,(o,r)=>{re(n,r)||e.ui.registry.addIcon(r,o)})},k6=e=>{const t=Io(e);if(Q(t)){const n=ao.get(t);e.theme=n(e,ao.urls[t])||{},ke(e.theme.init)&&e.theme.init(e,ao.urls[t]||e.documentBaseUrl.replace(/\/$/,""))}else e.theme={}},x6=e=>{const t=vu(e),n=Go.get(t);e.model=n(e,Go.urls[t])},_6=e=>{const t=e.theme.renderUI;return t?t():Bk(e)},N6=e=>{const t=e.getElement(),s=Io(e)(e,t);return s.editorContainer.nodeType&&(s.editorContainer.id=s.editorContainer.id||e.id+"_parent"),s.iframeContainer&&s.iframeContainer.nodeType&&(s.iframeContainer.id=s.iframeContainer.id||e.id+"_iframecontainer"),s.height=s.iframeHeight?s.iframeHeight:t.offsetHeight,s},Dk=(e,t)=>({editorContainer:e,iframeContainer:t,api:{}}),A6=e=>{const t=Pk.create("div");return Pk.insertAfter(t,e),Dk(t,t)},Bk=e=>{const t=e.getElement();return e.inline?Dk(null):A6(t)},T6=e=>{const t=e.getElement();return e.orgDisplay=t.style.display,Q(Io(e))?_6(e):ke(Io(e))?N6(e):Bk(e)},R6=(e,t)=>{const n={show:m.from(t.show).getOr(ce),hide:m.from(t.hide).getOr(ce),isEnabled:m.from(t.isEnabled).getOr(We),setEnabled:s=>{e.mode.isReadOnly()||m.from(t.setEnabled).each(o=>o(s))}};e.ui={...e.ui,...n}},P6=async e=>{e.dispatch("ScriptsLoaded"),w6(e),k6(e),x6(e),S6(e);const t=await T6(e);R6(e,m.from(t.api).getOr({})),e.editorContainer=t.editorContainer,UU(e),e.inline?Rk(e):y6(e,{editorContainer:t.editorContainer,iframeContainer:t.iframeContainer})},lo=Ae.DOM,Ok=e=>e.charAt(0)==="-",D6=(e,t)=>{const n=zh(t),s=nR(t);if(!hn.hasCode(n)&&n!=="en"){const o=xn(s)?s:`${t.editorManager.baseURL}/langs/${n}.js`;e.add(o).catch(()=>{DU(t,o,n)})}},B6=(e,t)=>{const n=Io(e);if(Q(n)&&!Ok(n)&&!re(ao.urls,n)){const s=fR(e),o=s?e.documentBaseURI.toAbsolute(s):`themes/${n}/theme${t}.js`;ao.load(n,o).catch(()=>{BU(e,o,n)})}},O6=(e,t)=>{const n=vu(e);if(n!=="plugin"&&!re(Go.urls,n)){const s=dR(e),o=Q(s)?e.documentBaseURI.toAbsolute(s):`models/${n}/model${t}.js`;Go.load(n,o).catch(()=>{OU(e,o,n)})}},I6=e=>m.from(XT(e)).filter(xn).map(t=>({url:t,name:m.none()})),Ik=(e,t,n)=>m.from(t).filter(s=>xn(s)&&!il.has(s)).map(s=>({url:`${e.editorManager.baseURL}/icons/${s}/icons${n}.js`,name:m.some(s)})),L6=(e,t,n)=>{const s=Ik(t,"default",n),o=I6(t).orThunk(()=>Ik(t,Uh(t),""));P(Jx([s,o]),r=>{e.add(r.url).catch(()=>{PU(t,r.url,r.name.getOrUndefined())})})},$6=(e,t)=>{const n=(s,o)=>{Yo.load(s,o).catch(()=>{RU(e,o,s)})};Te(xR(e),(s,o)=>{n(o,s),e.options.set("plugins",ki(e).concat(o))}),P(ki(e),s=>{s=$.trim(s),s&&!Yo.urls[s]&&!Ok(s)&&n(s,`plugins/${s}/plugin${t}.js`)})},F6=e=>{const t=Io(e);return!Q(t)||M(ao.get(t))},M6=e=>{const t=vu(e);return M(Go.get(t))},U6=(e,t)=>{const n=Qn.ScriptLoader,s=()=>{!e.removed&&F6(e)&&M6(e)&&P6(e)};B6(e,t),O6(e,t),D6(n,e),L6(n,e,t),$6(e,t),n.loadQueue().then(s,s)},z6=(e,t)=>Dp.forElement(e,{contentCssCors:Kh(t),referrerPolicy:yu(t)}),H6=e=>{const t=e.id;hn.setCode(zh(e));const n=()=>{lo.unbind(window,"ready",n),e.render()};if(!Ws.Event.domLoaded){lo.bind(window,"ready",n);return}if(!e.getElement())return;const s=C.fromDom(e.getElement()),o=Mg(s);e.on("remove",()=>{Qm(s.dom.attributes,a=>ot(s,a.name)),Wn(s,o)}),e.ui.styleSheetLoader=z6(s,e),Eu(e)?e.inline=!0:(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden");const r=e.getElement().form||lo.getParent(t,"form");r&&(e.formElement=r,CR(e)&&!Bc(e.getElement())&&(lo.insertAfter(lo.create("input",{type:"hidden",name:t}),t),e.hasHiddenInput=!0),e.formEventDelegate=a=>{e.dispatch(a.type,a)},lo.bind(r,"submit reset",e.formEventDelegate),e.on("reset",()=>{e.resetContent()}),yR(e)&&!r.submit.nodeType&&!r.submit.length&&!r._mceOldSubmit&&(r._mceOldSubmit=r.submit,r.submit=()=>(e.editorManager.triggerSave(),e.setDirty(!1),r._mceOldSubmit(r)))),e.windowManager=AE(e),e.notificationManager=NE(e),sP(e)&&e.on("GetContent",a=>{a.save&&(a.content=lo.encode(a.content))}),vR(e)&&e.on("submit",()=>{e.initialized&&e.save()}),ER(e)&&(e._beforeUnload=()=>{e.initialized&&!e.destroyed&&!e.isHidden()&&e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),U6(e,e.suffix)},W6=(e,t)=>{e._editableRoot!==t&&(e._editableRoot=t,e.readonly||(e.getBody().contentEditable=String(e.hasEditableRoot()),e.nodeChanged()),MD(e,t))},V6=e=>e._editableRoot,j6=(e,t)=>({sections:z(e),options:z(t)}),Lk=_n().deviceType,$k=Lk.isPhone(),q6=Lk.isTablet(),$a=e=>{if(je(e))return[];{const t=Ge(e)?e:e.split(/[ ,]/),n=he(t,Eo);return oe(n,xn)}},K6=(e,t)=>{const n=xx(t,(s,o)=>Ne(e,o));return j6(n.t,n.f)},G6=(e,t,n={})=>{const s=e.sections(),o=Pe(s,t).getOr({});return $.extend({},n,o)},Rm=(e,t)=>re(e.sections(),t),Y6=(e,t)=>Rm(e,t)?e.sections()[t]:{},X6=(e,t)=>({...{table_grid:!1,object_resizing:!1,resize:!1,toolbar_mode:Pe(e,"toolbar_mode").getOr("scrolling"),toolbar_sticky:!1},...t?{menubar:!1}:{}}),Z6=(e,t)=>{var n;const s=(n=t.external_plugins)!==null&&n!==void 0?n:{};return e&&e.external_plugins?$.extend({},e.external_plugins,s):s},Q6=(e,t)=>[...$a(e),...$a(t)],J6=(e,t,n,s)=>e&&Rm(t,"mobile")?s:n,e5=(e,t,n,s)=>{const o=$a(n.forced_plugins),r=$a(s.plugins),a=Y6(t,"mobile"),i=a.plugins?$a(a.plugins):r,l=J6(e,t,r,i),c=Q6(o,l);return $.extend(s,{forced_plugins:o,plugins:c})},t5=(e,t)=>e&&Rm(t,"mobile"),n5=(e,t,n,s,o)=>{var r;const a=e?{mobile:X6((r=o.mobile)!==null&&r!==void 0?r:{},t)}:{},i=K6(["mobile"],El(a,o)),l=$.extend(n,s,i.options(),t5(e,i)?G6(i,"mobile"):{},{external_plugins:Z6(s,i.options())});return e5(e,i,s,l)},s5=(e,t)=>n5($k||q6,$k,t,e,t),o5=(e,t)=>xM(e,t),r5=e=>{const t=(s,o)=>{e.formatter.toggle(s,o),e.nodeChanged()},n=s=>()=>{P("left,center,right,justify".split(","),o=>{s!==o&&e.formatter.remove("align"+o)}),s!=="none"&&t("align"+s)};e.editorCommands.addCommands({JustifyLeft:n("left"),JustifyCenter:n("center"),JustifyRight:n("right"),JustifyFull:n("justify"),JustifyNone:n("none")})},a5=e=>{const t=n=>()=>{const s=e.selection,o=s.isCollapsed()?[e.dom.getParent(s.getNode(),e.dom.isBlock)]:s.getSelectedBlocks();return Ue(o,r=>M(e.formatter.matchNode(r,n)))};e.editorCommands.addCommands({JustifyLeft:t("alignleft"),JustifyCenter:t("aligncenter"),JustifyRight:t("alignright"),JustifyFull:t("alignjustify")},"state")},i5=e=>{r5(e),a5(e)},l5=e=>{e.editorCommands.addCommands({"Cut,Copy,Paste":t=>{const n=e.getDoc();let s;try{n.execCommand(t)}catch{s=!0}if(t==="paste"&&!n.queryCommandEnabled(t)&&(s=!0),s||!n.queryCommandSupported(t)){let o=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");(be.os.isMacOS()||be.os.isiOS())&&(o=o.replace(/Ctrl\+/g,"⌘+")),e.notificationManager.open({text:o,type:"error"})}}})},c5=(e,t,n,s)=>{const o=C.fromDom(e.getRoot());return fa(o,N.fromRangeStart(t),s)?n=n.replace(/^ /,"&nbsp;"):n=n.replace(/^&nbsp;/," "),da(o,N.fromRangeEnd(t),s)?n=n.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):n=n.replace(/&nbsp;(<br( \/)?>)?$/," "),n},u5=e=>{if(typeof e!="string"){const t=$.extend({paste:e.paste,data:{paste:e.paste}},e);return{content:e.content,details:t}}return{content:e,details:{}}},f5=(e,t)=>{const n=e.selection,s=e.dom;return/^ | $/.test(t)?c5(s,n.getRng(),t,e.schema):t},Wl=(e,t)=>{if(e.selection.isEditable()){const{content:n,details:s}=u5(t);ld(e,{...s,content:f5(e,n),format:"html",set:!1,selection:!0}).each(o=>{const r=wM(e,o.content,s);cd(e,r,o),e.addVisual()})}},d5=e=>{e.editorCommands.addCommands({mceCleanup:()=>{const t=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(t)},insertImage:(t,n,s)=>{Wl(e,e.dom.createHTML("img",{src:s}))},insertHorizontalRule:()=>{e.execCommand("mceInsertContent",!1,"<hr>")},insertText:(t,n,s)=>{Wl(e,e.dom.encode(s))},insertHTML:(t,n,s)=>{Wl(e,s)},mceInsertContent:(t,n,s)=>{Wl(e,s)},mceSetContent:(t,n,s)=>{e.setContent(s)},mceReplaceContent:(t,n,s)=>{e.execCommand("mceInsertContent",!1,s.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceNewDocument:()=>{e.setContent(MR(e))}})},m5={"font-size":"size","font-family":"face"},g5=Qa("font"),p5=(e,t,n)=>{const s=r=>ti(r,e).orThunk(()=>g5(r)?Pe(m5,e).bind(a=>Vn(r,a)):m.none()),o=r=>ve(C.fromDom(t),r);return Uf(C.fromDom(n),r=>s(r),o)},h5=e=>e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,","),b5=(e,t)=>m.from(Ae.DOM.getStyle(t,e,!0)),Fk=e=>(t,n)=>m.from(n).map(C.fromDom).filter($t).bind(s=>p5(e,t,s.dom).or(b5(e,s.dom))).getOr(""),C5=Fk("font-size"),y5=kn(h5,Fk("font-family")),v5=e=>ht(e.getBody()).bind(t=>{const n=t.container();return m.from(B(n)?n.parentNode:n)}),E5=e=>m.from(e.selection.getRng()).bind(t=>{const n=e.getBody();return t.startContainer===n&&t.startOffset===0?m.none():m.from(e.selection.getStart(!0))}),S5=(e,t)=>E5(e).orThunk(K(v5,e)).map(C.fromDom).filter($t).bind(t),Pm=(e,t)=>S5(e,Gm(m.some,t)),Mk=(e,t)=>{if(/^[0-9.]+$/.test(t)){const n=parseInt(t,10);if(n>=1&&n<=7){const s=tP(e),o=nP(e);return o.length>0?o[n-1]||t:s[n-1]||t}else return t}else return t},w5=e=>{const t=e.split(/\s*,\s*/);return he(t,n=>n.indexOf(" ")!==-1&&!(ct(n,'"')||ct(n,"'"))?`'${n}'`:n).join(",")},k5=(e,t)=>{const n=Mk(e,t);e.formatter.toggle("fontname",{value:w5(n)}),e.nodeChanged()},x5=e=>Pm(e,t=>y5(e.getBody(),t.dom)).getOr(""),_5=(e,t)=>{e.formatter.toggle("fontsize",{value:Mk(e,t)}),e.nodeChanged()},N5=e=>Pm(e,t=>C5(e.getBody(),t.dom)).getOr(""),A5=e=>Pm(e,t=>{const n=C.fromDom(e.getBody()),s=Uf(t,r=>ti(r,"line-height"),K(ve,n)),o=()=>{const r=parseFloat(Tn(t,"line-height")),a=parseFloat(Tn(t,"font-size"));return String(r/a)};return s.getOrThunk(o)}).getOr(""),T5=(e,t)=>{e.formatter.toggle("lineheight",{value:String(t)}),e.nodeChanged()},R5=e=>{const t=(n,s)=>{e.formatter.toggle(n,s),e.nodeChanged()};e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":n=>{t(n)},"ForeColor,HiliteColor":(n,s,o)=>{t(n,{value:o})},BackColor:(n,s,o)=>{t("hilitecolor",{value:o})},FontName:(n,s,o)=>{k5(e,o)},FontSize:(n,s,o)=>{_5(e,o)},LineHeight:(n,s,o)=>{T5(e,o)},Lang:(n,s,o)=>{var r;t(n,{value:o.code,customValue:(r=o.customCode)!==null&&r!==void 0?r:null})},RemoveFormat:n=>{e.formatter.remove(n)},mceBlockQuote:()=>{t("blockquote")},FormatBlock:(n,s,o)=>{t(Q(o)?o:"p")},mceToggleFormat:(n,s,o)=>{t(o)}})},P5=e=>{const t=n=>e.formatter.match(n);e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":n=>t(n),mceBlockQuote:()=>t("blockquote")},"state"),e.editorCommands.addQueryValueHandler("FontName",()=>x5(e)),e.editorCommands.addQueryValueHandler("FontSize",()=>N5(e)),e.editorCommands.addQueryValueHandler("LineHeight",()=>A5(e))},D5=e=>{R5(e),P5(e)},B5=e=>{e.editorCommands.addCommands({mceAddUndoLevel:()=>{e.undoManager.add()},mceEndUndoLevel:()=>{e.undoManager.add()},Undo:()=>{e.undoManager.undo()},Redo:()=>{e.undoManager.redo()}})},O5=e=>{e.editorCommands.addCommands({Indent:()=>{b2(e)},Outdent:()=>{WS(e)}}),e.editorCommands.addCommands({Outdent:()=>MS(e)},"state")},I5=e=>{const t=(n,s,o)=>{const r=Q(o)?{href:o}:o,a=e.dom.getParent(e.selection.getNode(),"a");Ct(r)&&Q(r.href)&&(r.href=r.href.replace(/ /g,"%20"),(!a||!r.href)&&e.formatter.remove("link"),r.href&&e.formatter.apply("link",r,a))};e.editorCommands.addCommands({unlink:()=>{if(e.selection.isEditable()){if(e.selection.isCollapsed()){const n=e.dom.getParent(e.selection.getStart(),"a");n&&e.dom.remove(n,!0);return}e.formatter.remove("link")}},mceInsertLink:t,createLink:t})},L5=e=>{e.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":t=>{e.getDoc().execCommand(t);const n=e.dom.getParent(e.selection.getNode(),"ol,ul");if(n){const s=n.parentNode;if(s&&/^(H[1-6]|P|ADDRESS|PRE)$/.test(s.nodeName)){const o=e.selection.getBookmark();e.dom.split(s,n),e.selection.moveToBookmark(o)}}}})},$5=e=>{e.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":t=>{const n=e.dom.getParent(e.selection.getNode(),"ul,ol");return n&&(t==="insertunorderedlist"&&n.tagName==="UL"||t==="insertorderedlist"&&n.tagName==="OL")}},"state")},F5=e=>{L5(e),$5(e)},M5=(e,t,n,s)=>{const o=e.dom,r=i=>o.isBlock(i)&&i.parentElement===n,a=r(t)?t:o.getParent(s,r,n);return m.from(a).map(C.fromDom)},Uk=(e,t)=>{const n=e.dom,s=e.selection.getRng(),o=t?e.selection.getStart():e.selection.getEnd(),r=t?s.startContainer:s.endContainer,a=Da(n,r);if(!a||!a.isContentEditable)return;const i=t?Dt:Gn,l=pt(e);M5(e,o,a,r).each(c=>{const u=rw(e,r,c.dom,a,!1,l);i(c,C.fromDom(u)),e.selection.setCursorLocation(u,0),e.dispatch("NewBlock",{newBlock:u}),Pa(e,"insertParagraph")})},U5=e=>Uk(e,!0),z5=e=>Uk(e,!1),H5=e=>{e.editorCommands.addCommands({InsertNewBlockBefore:()=>{U5(e)},InsertNewBlockAfter:()=>{z5(e)}})},W5=e=>{e.editorCommands.addCommands({insertParagraph:()=>{Pl(cw,e)},mceInsertNewLine:(t,n,s)=>{hw(e,s)},InsertLineBreak:(t,n,s)=>{Pl(dw,e)}})},V5=e=>{e.editorCommands.addCommands({mceSelectNodeDepth:(t,n,s)=>{let o=0;e.dom.getParent(e.selection.getNode(),r=>G(r)&&o++===s?(e.selection.select(r),!1):!0,e.getBody())},mceSelectNode:(t,n,s)=>{e.selection.select(s)},selectAll:()=>{const t=e.dom.getParent(e.selection.getStart(),nn);if(t){const n=e.dom.createRng();n.selectNodeContents(t),e.selection.setRng(n)}}})},j5=e=>{e.editorCommands.addCommands({mceRemoveNode:(t,n,s)=>{const o=s??e.selection.getNode();if(o!==e.getBody()){const r=e.selection.getBookmark();e.dom.remove(o,!0),e.selection.moveToBookmark(r)}},mcePrint:()=>{e.getWin().print()},mceFocus:(t,n,s)=>{cB(e,s===!0)},mceToggleVisualAid:()=>{e.hasVisual=!e.hasVisual,e.addVisual()}})},q5=e=>{i5(e),l5(e),B5(e),V5(e),d5(e),I5(e),O5(e),H5(e),W5(e),F5(e),D5(e),j5(e)},K5=["toggleview"],zk=e=>Ne(K5,e.toLowerCase());class Hk{constructor(t){this.commands={state:{},exec:{},value:{}},this.editor=t}execCommand(t,n=!1,s,o){const r=this.editor,a=t.toLowerCase(),i=o==null?void 0:o.skip_focus;if(r.removed||(a!=="mcefocus"&&(!/^(mceAddUndoLevel|mceEndUndoLevel)$/i.test(a)&&!i?r.focus():W1(r)),r.dispatch("BeforeExecCommand",{command:t,ui:n,value:s}).isDefaultPrevented()))return!1;const c=this.commands.exec[a];return ke(c)?(c(a,n,s),r.dispatch("ExecCommand",{command:t,ui:n,value:s}),!0):!1}queryCommandState(t){if(!zk(t)&&this.editor.quirks.isHidden()||this.editor.removed)return!1;const n=t.toLowerCase(),s=this.commands.state[n];return ke(s)?s(n):!1}queryCommandValue(t){if(!zk(t)&&this.editor.quirks.isHidden()||this.editor.removed)return"";const n=t.toLowerCase(),s=this.commands.value[n];return ke(s)?s(n):""}addCommands(t,n="exec"){const s=this.commands;Te(t,(o,r)=>{P(r.toLowerCase().split(","),a=>{s[n][a]=o})})}addCommand(t,n,s){const o=t.toLowerCase();this.commands.exec[o]=(r,a,i)=>n.call(s??this.editor,a,i)}queryCommandSupported(t){const n=t.toLowerCase();return!!this.commands.exec[n]}addQueryStateHandler(t,n,s){this.commands.state[t.toLowerCase()]=()=>n.call(s??this.editor)}addQueryValueHandler(t,n,s){this.commands.value[t.toLowerCase()]=()=>n.call(s??this.editor)}}const co="data-mce-contenteditable",G5=(e,t,n)=>{Sc(e,t)&&!n?Sr(e,t):n&&ko(e,t)},Dm=(e,t,n)=>{try{e.getDoc().execCommand(t,!1,String(n))}catch{}},Vl=(e,t)=>{e.dom.contentEditable=t?"true":"false"},Y5=e=>{P(gt(e,'*[contenteditable="true"]'),t=>{st(t,co,"true"),Vl(t,!1)})},X5=e=>{P(gt(e,`*[${co}="true"]`),t=>{ot(t,co),Vl(t,!0)})},Z5=e=>{m.from(e.selection.getNode()).each(t=>{t.removeAttribute("data-mce-selected")})},Q5=e=>{e.selection.setRng(e.selection.getRng())},J5=(e,t)=>{const n=C.fromDom(e.getBody());G5(n,"mce-content-readonly",t),t?(e.selection.controlSelection.hideResizeRect(),e._selectionOverrides.hideFakeCaret(),Z5(e),e.readonly=!0,Vl(n,!1),Y5(n)):(e.readonly=!1,e.hasEditableRoot()&&Vl(n,!0),X5(n),Dm(e,"StyleWithCSS",!1),Dm(e,"enableInlineTableEditing",!1),Dm(e,"enableObjectResizing",!1),wC(e)&&e.focus(),Q5(e),e.nodeChanged())},uo=e=>e.readonly,Wk=e=>{e.parser.addAttributeFilter("contenteditable",t=>{uo(e)&&P(t,n=>{n.attr(co,n.attr("contenteditable")),n.attr("contenteditable","false")})}),e.serializer.addAttributeFilter(co,t=>{uo(e)&&P(t,n=>{n.attr("contenteditable",n.attr(co))})}),e.serializer.addTempAttr(co)},e4=e=>{e.serializer?Wk(e):e.on("PreInit",()=>{Wk(e)})},t4=e=>e.type==="click",n4=["copy"],s4=e=>Ne(n4,e.type),o4=(e,t)=>Os(t,"a",s=>ve(s,C.fromDom(e.getBody()))).bind(s=>Vn(s,"href")),r4=(e,t)=>{if(t4(t)&&!H.metaKeyPressed(t)){const n=C.fromDom(t.target);o4(e,n).each(s=>{if(t.preventDefault(),/^#/.test(s)){const o=e.dom.select(`${s},[name="${lg(s,"#")}"]`);o.length&&e.selection.scrollIntoView(o[0],!0)}else window.open(s,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")})}else s4(t)&&e.dispatch(t.type,t)},a4=e=>{e.on("ShowCaret",t=>{uo(e)&&t.preventDefault()}),e.on("ObjectSelected",t=>{uo(e)&&t.preventDefault()})},i4=$.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," ");class Bm{static isNative(t){return!!i4[t.toLowerCase()]}constructor(t){this.bindings={},this.settings=t||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||$e}fire(t,n){return this.dispatch(t,n)}dispatch(t,n){const s=t.toLowerCase(),o=su(s,n??{},this.scope);this.settings.beforeFire&&this.settings.beforeFire(o);const r=this.bindings[s];if(r)for(let a=0,i=r.length;a<i;a++){const l=r[a];if(!l.removed){if(l.once&&this.off(s,l.func),o.isImmediatePropagationStopped())return o;if(l.func.call(this.scope,o)===!1)return o.preventDefault(),o}}return o}on(t,n,s,o){if(n===!1&&(n=$e),n){const r={func:n,removed:!1};o&&$.extend(r,o);const a=t.toLowerCase().split(" ");let i=a.length;for(;i--;){const l=a[i];let c=this.bindings[l];c||(c=[],this.toggleEvent(l,!0)),s?c=[r,...c]:c=[...c,r],this.bindings[l]=c}}return this}off(t,n){if(t){const s=t.toLowerCase().split(" ");let o=s.length;for(;o--;){const r=s[o];let a=this.bindings[r];if(!r)return Te(this.bindings,(i,l)=>{this.toggleEvent(l,!1),delete this.bindings[l]}),this;if(a){if(!n)a.length=0;else{const i=Co(a,l=>l.func===n);a=i.fail,this.bindings[r]=a,P(i.pass,l=>{l.removed=!0})}a.length||(this.toggleEvent(t,!1),delete this.bindings[r])}}}else Te(this.bindings,(s,o)=>{this.toggleEvent(o,!1)}),this.bindings={};return this}once(t,n,s){return this.on(t,n,s,{once:!0})}has(t){t=t.toLowerCase();const n=this.bindings[t];return!(!n||n.length===0)}}const Fa=e=>(e._eventDispatcher||(e._eventDispatcher=new Bm({scope:e,toggleEvent:(t,n)=>{Bm.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}})),e._eventDispatcher),Om={fire(e,t,n){return this.dispatch(e,t,n)},dispatch(e,t,n){const s=this;if(s.removed&&e!=="remove"&&e!=="detach")return su(e.toLowerCase(),t??{},s);const o=Fa(s).dispatch(e,t);if(n!==!1&&s.parent){let r=s.parent();for(;r&&!o.isPropagationStopped();)r.dispatch(e,o,!1),r=r.parent?r.parent():void 0}return o},on(e,t,n){return Fa(this).on(e,t,n)},off(e,t){return Fa(this).off(e,t)},once(e,t){return Fa(this).once(e,t)},hasEventListeners(e){return Fa(this).has(e)}},jl=Ae.DOM;let fo;const ql=(e,t)=>{if(t==="selectionchange")return e.getDoc();if(!e.inline&&/^(?:mouse|touch|click|contextmenu|drop|dragover|dragend)/.test(t))return e.getDoc().documentElement;const n=jh(e);return n?(e.eventRoot||(e.eventRoot=jl.select(n)[0]),e.eventRoot):e.getBody()},l4=e=>!e.hidden&&!uo(e),Vk=(e,t,n)=>{l4(e)?e.dispatch(t,n):uo(e)&&r4(e,n)},jk=(e,t)=>{if(e.delegates||(e.delegates={}),e.delegates[t]||e.removed)return;const n=ql(e,t);if(jh(e)){if(fo||(fo={},e.editorManager.on("removeEditor",()=>{e.editorManager.activeEditor||fo&&(Te(fo,(o,r)=>{e.dom.unbind(ql(e,r))}),fo=null)})),fo[t])return;const s=o=>{const r=o.target,a=e.editorManager.get();let i=a.length;for(;i--;){const l=a[i].getBody();(l===r||jl.isChildOf(r,l))&&Vk(a[i],t,o)}};fo[t]=s,jl.bind(n,t,s)}else{const s=o=>{Vk(e,t,o)};jl.bind(n,t,s),e.delegates[t]=s}},qk={...Om,bindPendingEventDelegates(){const e=this;$.each(e._pendingNativeEvents,t=>{jk(e,t)})},toggleNativeEvent(e,t){const n=this;e==="focus"||e==="blur"||n.removed||(t?n.initialized?jk(n,e):n._pendingNativeEvents?n._pendingNativeEvents.push(e):n._pendingNativeEvents=[e]:n.initialized&&n.delegates&&(n.dom.unbind(ql(n,e),e,n.delegates[e]),delete n.delegates[e]))},unbindAllNativeEvents(){const e=this,t=e.getBody(),n=e.dom;e.delegates&&(Te(e.delegates,(s,o)=>{e.dom.unbind(ql(e,o),o,s)}),delete e.delegates),!e.inline&&t&&n&&(t.onload=null,n.unbind(e.getWin()),n.unbind(e.getDoc())),n&&(n.unbind(t),n.unbind(e.getContainer()))}},c4=e=>Q(e)?{value:e.split(/[ ,]/),valid:!0}:bo(e,Q)?{value:e,valid:!0}:{valid:!1,message:"The value must be a string[] or a comma/space separated string."},u4=e=>{const t=(()=>{switch(e){case"array":return Ge;case"boolean":return _s;case"function":return ke;case"number":return dn;case"object":return Ct;case"string":return Q;case"string[]":return c4;case"object[]":return n=>bo(n,Ct);case"regexp":return n=>Ha(n,RegExp);default:return We}})();return n=>Im(n,t,`The value must be a ${e}.`)},f4=e=>Q(e.processor),Kk=(e,t)=>{const n=Cr(t.message)?"":`. ${t.message}`;return e+n},Gk=e=>e.valid,Im=(e,t,n="")=>{const s=t(e);return _s(s)?s?{value:e,valid:!0}:{valid:!1,message:n}:s},d4=(e,t,n)=>{if(!lt(t)){const s=Im(t,n);if(Gk(s))return s.value;console.error(Kk(`Invalid default value passed for the "${e}" option`,s))}},m4=(e,t)=>{const n={},s={},o=(f,d,p)=>{const b=Im(d,p);return Gk(b)?(s[f]=b.value,!0):(console.warn(Kk(`Invalid value passed for the ${f} option`,b)),!1)},r=(f,d)=>{const p=f4(d)?u4(d.processor):d.processor,b=d4(f,d.default,p);n[f]={...d,default:b,processor:p},Pe(s,f).orThunk(()=>Pe(t,f)).each(h=>o(f,h,p))},a=f=>re(n,f);return{register:r,isRegistered:a,get:f=>Pe(s,f).orThunk(()=>Pe(n,f).map(d=>d.default)).getOrUndefined(),set:(f,d)=>{if(a(f)){const p=n[f];return p.immutable?(console.error(`"${f}" is an immutable option and cannot be updated`),!1):o(f,d,p.processor)}else return console.warn(`"${f}" is not a registered option. Ensure the option has been registered before setting a value.`),!1},unset:f=>{const d=a(f);return d&&delete s[f],d},isSet:f=>re(s,f)}},g4=["design","readonly"],Yk=(e,t,n,s)=>{const o=n[t.get()],r=n[s];try{r.activate()}catch(a){console.error(`problem while activating editor mode ${s}:`,a);return}o.deactivate(),o.editorReadOnly!==r.editorReadOnly&&J5(e,r.editorReadOnly),t.set(s),xD(e,s)},p4=(e,t,n,s)=>{if(s!==n.get()){if(!re(t,s))throw new Error(`Editor mode '${s}' is invalid`);e.initialized?Yk(e,n,t,s):e.on("init",()=>Yk(e,n,t,s))}},h4=(e,t,n)=>{if(Ne(g4,t))throw new Error(`Cannot override default mode ${t}`);return{...e,[t]:{...n,deactivate:()=>{try{n.deactivate()}catch(s){console.error(`problem while deactivating editor mode ${t}:`,s)}}}}},b4=e=>{const t=et("design"),n=et({design:{activate:ce,deactivate:ce,editorReadOnly:!1},readonly:{activate:ce,deactivate:ce,editorReadOnly:!0}});return e4(e),a4(e),{isReadOnly:()=>uo(e),set:s=>p4(e,n.get(),t,s),get:()=>t.get(),register:(s,o)=>{n.set(h4(n.get(),s,o))}}},Lm=$.each,$m=$.explode,C4={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},Xk=$.makeMap("alt,ctrl,shift,meta,access"),y4=e=>e in Xk,v4=e=>{const t={},n=be.os.isMacOS()||be.os.isiOS();Lm($m(e.toLowerCase(),"+"),r=>{y4(r)?t[r]=!0:/^[0-9]{2,}$/.test(r)?t.keyCode=parseInt(r,10):(t.charCode=r.charCodeAt(0),t.keyCode=C4[r]||r.toUpperCase().charCodeAt(0))});const s=[t.keyCode];let o;for(o in Xk)t[o]?s.push(o):t[o]=!1;return t.id=s.join(","),t.access&&(t.alt=!0,n?t.ctrl=!0:t.shift=!0),t.meta&&(n?t.meta=!0:(t.ctrl=!0,t.meta=!1)),t};class Zk{constructor(t){this.shortcuts={},this.pendingPatterns=[],this.editor=t;const n=this;t.on("keyup keypress keydown",s=>{(n.hasModifier(s)||n.isFunctionKey(s))&&!s.isDefaultPrevented()&&(Lm(n.shortcuts,o=>{n.matchShortcut(s,o)&&(n.pendingPatterns=o.subpatterns.slice(0),s.type==="keydown"&&n.executeShortcutAction(o))}),n.matchShortcut(s,n.pendingPatterns[0])&&(n.pendingPatterns.length===1&&s.type==="keydown"&&n.executeShortcutAction(n.pendingPatterns[0]),n.pendingPatterns.shift()))})}add(t,n,s,o){const r=this,a=r.normalizeCommandFunc(s);return Lm($m($.trim(t)),i=>{const l=r.createShortcut(i,n,a,o);r.shortcuts[l.id]=l}),!0}remove(t){const n=this.createShortcut(t);return this.shortcuts[n.id]?(delete this.shortcuts[n.id],!0):!1}normalizeCommandFunc(t){const n=this,s=t;return typeof s=="string"?()=>{n.editor.execCommand(s,!1,null)}:$.isArray(s)?()=>{n.editor.execCommand(s[0],s[1],s[2])}:s}createShortcut(t,n,s,o){const r=$.map($m(t,">"),v4);return r[r.length-1]=$.extend(r[r.length-1],{func:s,scope:o||this.editor}),$.extend(r[0],{desc:this.editor.translate(n),subpatterns:r.slice(1)})}hasModifier(t){return t.altKey||t.ctrlKey||t.metaKey}isFunctionKey(t){return t.type==="keydown"&&t.keyCode>=112&&t.keyCode<=123}matchShortcut(t,n){return!n||n.ctrl!==t.ctrlKey||n.meta!==t.metaKey||n.alt!==t.altKey||n.shift!==t.shiftKey?!1:t.keyCode===n.keyCode||t.charCode&&t.charCode===n.charCode?(t.preventDefault(),!0):!1}executeShortcutAction(t){return t.func?t.func.call(t.scope):null}}const E4=()=>{const e={},t={},n={},s={},o={},r={},a={},i={},l=(u,f)=>(d,p)=>{u[d.toLowerCase()]={...p,type:f}},c=(u,f)=>s[u.toLowerCase()]=f;return{addButton:l(e,"button"),addGroupToolbarButton:l(e,"grouptoolbarbutton"),addToggleButton:l(e,"togglebutton"),addMenuButton:l(e,"menubutton"),addSplitButton:l(e,"splitbutton"),addMenuItem:l(t,"menuitem"),addNestedMenuItem:l(t,"nestedmenuitem"),addToggleMenuItem:l(t,"togglemenuitem"),addAutocompleter:l(n,"autocompleter"),addContextMenu:l(o,"contextmenu"),addContextToolbar:l(r,"contexttoolbar"),addContextForm:l(r,"contextform"),addSidebar:l(a,"sidebar"),addView:l(i,"views"),addIcon:c,getAll:()=>({buttons:e,menuItems:t,icons:s,popups:n,contextMenus:o,contextToolbars:r,sidebars:a,views:i})}},S4=()=>{const e=E4();return{addAutocompleter:e.addAutocompleter,addButton:e.addButton,addContextForm:e.addContextForm,addContextMenu:e.addContextMenu,addContextToolbar:e.addContextToolbar,addIcon:e.addIcon,addMenuButton:e.addMenuButton,addMenuItem:e.addMenuItem,addNestedMenuItem:e.addNestedMenuItem,addSidebar:e.addSidebar,addSplitButton:e.addSplitButton,addToggleButton:e.addToggleButton,addGroupToolbarButton:e.addGroupToolbarButton,addToggleMenuItem:e.addToggleMenuItem,addView:e.addView,getAll:e.getAll}},mo=Ae.DOM,Qk=$.extend,w4=$.each;class Kl{constructor(t,n,s){this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.composing=!1,this.destroyed=!1,this.hasHiddenInput=!1,this.iframeElement=null,this.initialized=!1,this.readonly=!1,this.removed=!1,this.startContent="",this._pendingNativeEvents=[],this._skinLoaded=!1,this._editableRoot=!0,this.editorManager=s,this.documentBaseUrl=s.documentBaseURL,Qk(this,qk);const o=this;this.id=t,this.hidden=!1;const r=s5(s.defaultOptions,n);this.options=m4(o,r),FT(o);const a=this.options.get;a("deprecation_warnings")&&fU(n,r);const i=a("suffix");i&&(s.suffix=i),this.suffix=s.suffix;const l=a("base_url");l&&s._setBaseUrl(l),this.baseUri=s.baseURI;const c=yu(o);c&&(Qn.ScriptLoader._setReferrerPolicy(c),Ae.DOM.styleSheetLoader._setReferrerPolicy(c));const u=Kh(o);M(u)&&Ae.DOM.styleSheetLoader._setContentCssCors(u),yt.languageLoad=a("language_load"),yt.baseURL=s.baseURL,this.setDirty(!1),this.documentBaseURI=new an(Lh(o),{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=Eu(o),this.hasVisual=NR(o),this.shortcuts=new Zk(this),this.editorCommands=new Hk(this),q5(this);const f=a("cache_suffix");f&&(be.cacheSuffix=f.replace(/^[\?\&]+/,"")),this.ui={registry:S4(),styleSheetLoader:void 0,show:ce,hide:ce,setEnabled:ce,isEnabled:We},this.mode=b4(o),s.dispatch("SetupEditor",{editor:this});const d=RR(o);ke(d)&&d.call(o,o)}render(){H6(this)}focus(t){this.execCommand("mceFocus",!1,t)}hasFocus(){return to(this)}translate(t){return hn.translate(t)}getParam(t,n,s){const o=this.options;return o.isRegistered(t)||(M(s)?o.register(t,{processor:s,default:n}):o.register(t,{processor:We,default:n})),!o.isSet(t)&&!lt(n)?n:o.get(t)}hasPlugin(t,n){return Ne(ki(this),t)?n?Yo.get(t)!==void 0:!0:!1}nodeChanged(t){this._nodeChangeDispatcher.nodeChanged(t)}addCommand(t,n,s){this.editorCommands.addCommand(t,n,s)}addQueryStateHandler(t,n,s){this.editorCommands.addQueryStateHandler(t,n,s)}addQueryValueHandler(t,n,s){this.editorCommands.addQueryValueHandler(t,n,s)}addShortcut(t,n,s,o){this.shortcuts.add(t,n,s,o)}execCommand(t,n,s,o){return this.editorCommands.execCommand(t,n,s,o)}queryCommandState(t){return this.editorCommands.queryCommandState(t)}queryCommandValue(t){return this.editorCommands.queryCommandValue(t)}queryCommandSupported(t){return this.editorCommands.queryCommandSupported(t)}show(){const t=this;t.hidden&&(t.hidden=!1,t.inline?t.getBody().contentEditable="true":(mo.show(t.getContainer()),mo.hide(t.id)),t.load(),t.dispatch("show"))}hide(){const t=this;t.hidden||(t.save(),t.inline?(t.getBody().contentEditable="false",t===t.editorManager.focusedEditor&&(t.editorManager.focusedEditor=null)):(mo.hide(t.getContainer()),mo.setStyle(t.id,"display",t.orgDisplay)),t.hidden=!0,t.dispatch("hide"))}isHidden(){return this.hidden}setProgressState(t,n){this.dispatch("ProgressState",{state:t,time:n})}load(t={}){const n=this,s=n.getElement();if(n.removed)return"";if(s){const o={...t,load:!0},r=Bc(s)?s.value:s.innerHTML,a=n.setContent(r,o);return o.no_events||n.dispatch("LoadContent",{...o,element:s}),a}else return""}save(t={}){const n=this;let s=n.getElement();if(!s||!n.initialized||n.removed)return"";const o={...t,save:!0,element:s};let r=n.getContent(o);const a={...o,content:r};if(a.no_events||n.dispatch("SaveContent",a),a.format==="raw"&&n.dispatch("RawSaveContent",a),r=a.content,Bc(s))s.value=r;else{(t.is_removing||!n.inline)&&(s.innerHTML=r);const i=mo.getParent(n.id,"form");i&&w4(i.elements,l=>l.name===n.id?(l.value=r,!1):!0)}return a.element=o.element=s=null,a.set_dirty!==!1&&n.setDirty(!1),r}setContent(t,n){return Cd(this,t,n)}getContent(t){return QM(this,t)}insertContent(t,n){n&&(t=Qk({content:t},n)),this.execCommand("mceInsertContent",!1,t)}resetContent(t){t===void 0?Cd(this,this.startContent,{format:"raw"}):Cd(this,t),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()}isDirty(){return!this.isNotDirty}setDirty(t){const n=!this.isNotDirty;this.isNotDirty=!t,t&&t!==n&&this.dispatch("dirty")}getContainer(){const t=this;return t.container||(t.container=t.editorContainer||mo.get(t.id+"_parent")),t.container}getContentAreaContainer(){return this.contentAreaContainer}getElement(){return this.targetElm||(this.targetElm=mo.get(this.id)),this.targetElm}getWin(){const t=this;if(!t.contentWindow){const n=t.iframeElement;n&&(t.contentWindow=n.contentWindow)}return t.contentWindow}getDoc(){const t=this;if(!t.contentDocument){const n=t.getWin();n&&(t.contentDocument=n.document)}return t.contentDocument}getBody(){var t,n;const s=this.getDoc();return(n=(t=this.bodyElement)!==null&&t!==void 0?t:s==null?void 0:s.body)!==null&&n!==void 0?n:null}convertURL(t,n,s){const o=this,r=o.options.get,a=DR(o);if(ke(a))return a.call(o,t,s,!0,n);if(!r("convert_urls")||s==="link"||Ct(s)&&s.nodeName==="LINK"||t.indexOf("file:")===0||t.length===0)return t;const i=new an(t);return i.protocol!=="http"&&i.protocol!=="https"&&i.protocol!==""?t:r("relative_urls")?o.documentBaseURI.toRelative(t):(t=o.documentBaseURI.toAbsolute(t,r("remove_script_host")),t)}addVisual(t){o5(this,t)}setEditableRoot(t){W6(this,t)}hasEditableRoot(){return V6(this)}remove(){pU(this)}destroy(t){hU(this,t)}uploadImages(){return this.editorUpload.uploadImages()}_scanForImages(){return this.editorUpload.scanForImages()}}const sr=Ae.DOM,Gl=$.each;let Jk=!1,Yl,Nt=[];const Xl=e=>{const t=e.type;Gl(ks.get(),n=>{switch(t){case"scroll":n.dispatch("ScrollWindow",e);break;case"resize":n.dispatch("ResizeWindow",e);break}})},ex=e=>{if(e!==Jk){const t=Ae.DOM;e?(t.bind(window,"resize",Xl),t.bind(window,"scroll",Xl)):(t.unbind(window,"resize",Xl),t.unbind(window,"scroll",Xl)),Jk=e}},tx=e=>{const t=Nt;return Nt=oe(Nt,n=>e!==n),ks.activeEditor===e&&(ks.activeEditor=Nt.length>0?Nt[0]:null),ks.focusedEditor===e&&(ks.focusedEditor=null),t.length!==Nt.length},k4=e=>{e&&e.initialized&&!(e.getContainer()||e.getBody()).parentNode&&(tx(e),e.unbindAllNativeEvents(),e.destroy(!0),e.removed=!0)},x4=document.compatMode!=="CSS1Compat",ks={...Om,baseURI:null,baseURL:null,defaultOptions:{},documentBaseURL:null,suffix:null,majorVersion:"6",minorVersion:"8.0",releaseDate:"2023-11-22",i18n:hn,activeEditor:null,focusedEditor:null,setup(){const e=this;let t="",n="",s=an.getDocumentBaseUrl(document.location);/^[^:]+:\/\/\/?[^\/]+\//.test(s)&&(s=s.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(s)||(s+="/"));const o=window.tinymce||window.tinyMCEPreInit;if(o)t=o.base||o.baseURL,n=o.suffix;else{const r=document.getElementsByTagName("script");for(let a=0;a<r.length;a++){const i=r[a].src||"";if(i==="")continue;const l=i.substring(i.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(i)){l.indexOf(".min")!==-1&&(n=".min"),t=i.substring(0,i.lastIndexOf("/"));break}}if(!t&&document.currentScript){const a=document.currentScript.src;a.indexOf(".min")!==-1&&(n=".min"),t=a.substring(0,a.lastIndexOf("/"))}}e.baseURL=new an(s).toAbsolute(t),e.documentBaseURL=s,e.baseURI=new an(e.baseURL),e.suffix=n,eB(e)},overrideDefaults(e){const t=e.base_url;t&&this._setBaseUrl(t);const n=e.suffix;n&&(this.suffix=n),this.defaultOptions=e;const s=e.plugin_base_urls;s!==void 0&&Te(s,(o,r)=>{yt.PluginManager.urls[r]=o})},init(e){const t=this;let n;const s=$.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),o=(u,f)=>u.inline&&f.tagName.toLowerCase()in s,r=u=>{let f=u.id;return f||(f=Pe(u,"name").filter(d=>!sr.get(d)).getOrThunk(sr.uniqueId),u.setAttribute("id",f)),f},a=u=>{const f=e[u];if(f)return f.apply(t,[])},i=u=>be.browser.isIE()||be.browser.isEdge()?(cl("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tiny.cloud/docs/tinymce/6/support/#supportedwebbrowsers"),[]):x4?(cl("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[]):Q(u.selector)?sr.select(u.selector):M(u.target)?[u.target]:[];let l=u=>{n=u};const c=()=>{let u=0;const f=[];let d;const p=(b,g,h)=>{const y=new Kl(b,g,t);f.push(y),y.on("init",()=>{++u===d.length&&l(f)}),y.targetElm=y.targetElm||h,y.render()};sr.unbind(window,"ready",c),a("onpageload"),d=Sx(i(e)),$.each(d,b=>{k4(t.get(b.id))}),d=$.grep(d,b=>!t.get(b.id)),d.length===0?l([]):Gl(d,b=>{o(e,b)?cl("Could not initialize inline editor on invalid inline target element",b):p(r(b),e,b)})};return sr.bind(window,"ready",c),new Promise(u=>{n?u(n):l=f=>{u(f)}})},get(e){return arguments.length===0?Nt.slice(0):Q(e)?Ye(Nt,t=>t.id===e).getOr(null):dn(e)&&Nt[e]?Nt[e]:null},add(e){const t=this,n=t.get(e.id);return n===e||(n===null&&Nt.push(e),ex(!0),t.activeEditor=e,t.dispatch("AddEditor",{editor:e}),Yl||(Yl=s=>{const o=t.dispatch("BeforeUnload");if(o.returnValue)return s.preventDefault(),s.returnValue=o.returnValue,o.returnValue},window.addEventListener("beforeunload",Yl))),e},createEditor(e,t){return this.add(new Kl(e,t,this))},remove(e){const t=this;let n;if(!e){for(let s=Nt.length-1;s>=0;s--)t.remove(Nt[s]);return}if(Q(e)){Gl(sr.select(e),s=>{n=t.get(s.id),n&&t.remove(n)});return}return n=e,wt(t.get(n.id))?null:(tx(n)&&t.dispatch("RemoveEditor",{editor:n}),Nt.length===0&&window.removeEventListener("beforeunload",Yl),n.remove(),ex(Nt.length>0),n)},execCommand(e,t,n){var s;const o=this,r=Ct(n)?(s=n.id)!==null&&s!==void 0?s:n.index:n;switch(e){case"mceAddEditor":{if(!o.get(r)){const a=n.options;new Kl(r,a,o).render()}return!0}case"mceRemoveEditor":{const a=o.get(r);return a&&a.remove(),!0}case"mceToggleEditor":{const a=o.get(r);return a?(a.isHidden()?a.show():a.hide(),!0):(o.execCommand("mceAddEditor",!1,n),!0)}}return o.activeEditor?o.activeEditor.execCommand(e,t,n):!1},triggerSave:()=>{Gl(Nt,e=>{e.save()})},addI18n:(e,t)=>{hn.add(e,t)},translate:e=>hn.translate(e),setActive(e){const t=this.activeEditor;this.activeEditor!==e&&(t&&t.dispatch("deactivate",{relatedTarget:e}),e.dispatch("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl(e){this.baseURL=new an(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new an(this.baseURL)}};ks.setup();const _4=(()=>{const e=ms(),t=r=>({items:r,types:Pt(r),getType:a=>Pe(r,a).getOrUndefined()}),n=r=>{e.set(r)},s=()=>e.get().getOrUndefined(),o=e.clear;return{FakeClipboardItem:t,write:n,read:s,clear:o}})(),nx=Math.min,or=Math.max,Zl=Math.round,sx=(e,t,n)=>{let s=t.x,o=t.y;const r=e.w,a=e.h,i=t.w,l=t.h,c=(n||"").split("");return c[0]==="b"&&(o+=l),c[1]==="r"&&(s+=i),c[0]==="c"&&(o+=Zl(l/2)),c[1]==="c"&&(s+=Zl(i/2)),c[3]==="b"&&(o-=a),c[4]==="r"&&(s-=r),c[3]==="c"&&(o-=Zl(a/2)),c[4]==="c"&&(s-=Zl(r/2)),rr(s,o,r,a)},N4=(e,t,n,s)=>{for(let o=0;o<s.length;o++){const r=sx(e,t,s[o]);if(r.x>=n.x&&r.x+r.w<=n.w+n.x&&r.y>=n.y&&r.y+r.h<=n.h+n.y)return s[o]}return null},A4=(e,t,n)=>rr(e.x-t,e.y-n,e.w+t*2,e.h+n*2),T4=(e,t)=>{const n=or(e.x,t.x),s=or(e.y,t.y),o=nx(e.x+e.w,t.x+t.w),r=nx(e.y+e.h,t.y+t.h);return o-n<0||r-s<0?null:rr(n,s,o-n,r-s)},R4=(e,t,n)=>{let s=e.x,o=e.y,r=e.x+e.w,a=e.y+e.h;const i=t.x+t.w,l=t.y+t.h,c=or(0,t.x-s),u=or(0,t.y-o),f=or(0,r-i),d=or(0,a-l);return s+=c,o+=u,n&&(r+=c,a+=u,s-=f,o-=d),r-=f,a-=d,rr(s,o,r-s,a-o)},rr=(e,t,n,s)=>({x:e,y:t,w:n,h:s}),P4={inflate:A4,relativePosition:sx,findBestRelativePosition:N4,intersect:T4,clamp:R4,create:rr,fromClientRect:e=>rr(e.left,e.top,e.width,e.height)},D4=(e,t,n=1e3)=>{let s=!1,o=null;const r=c=>(...u)=>{s||(s=!0,o!==null&&(clearTimeout(o),o=null),c.apply(null,u))},a=r(e),i=r(t);return{start:(...c)=>{!s&&o===null&&(o=setTimeout(()=>i.apply(null,c),n))},resolve:a,reject:i}},B4=(()=>{const e={},t={},n={};return{load:(l,c)=>{const u=`Script at URL "${c}" failed to load`,f=`Script at URL "${c}" did not call \`tinymce.Resource.add('${l}', data)\` within 1 second`;if(e[l]!==void 0)return e[l];{const d=new Promise((p,b)=>{const g=D4(p,b);t[l]=g.resolve,Qn.ScriptLoader.loadScript(c).then(()=>g.start(f),()=>g.reject(u))});return e[l]=d,d}},add:(l,c)=>{t[l]!==void 0&&(t[l](c),delete t[l]),e[l]=Promise.resolve(c),n[l]=c},has:l=>l in n,get:l=>n[l],unload:l=>{delete e[l]}}})(),O4=()=>(()=>{let e={},t=[];const n={getItem:s=>{const o=e[s];return o||null},setItem:(s,o)=>{t.push(s),e[s]=String(o)},key:s=>t[s],removeItem:s=>{t=t.filter(o=>o===s),delete e[s]},clear:()=>{t=[],e={}},length:0};return Object.defineProperty(n,"length",{get:()=>t.length,configurable:!1,enumerable:!1}),n})();let Ma;try{const e="__storage_test__";Ma=window.localStorage,Ma.setItem(e,e),Ma.removeItem(e)}catch{Ma=O4()}var I4=Ma;const L4={geom:{Rect:P4},util:{Delay:Gt,Tools:$,VK:H,URI:an,EventDispatcher:Bm,Observable:Om,I18n:hn,LocalStorage:I4,ImageUploader:GU},dom:{EventUtils:Ws,TreeWalker:Xe,TextSeeker:qs,DOMUtils:Ae,ScriptLoader:Qn,RangeUtils:eo,Serializer:EE,StyleSheetLoader:Pp,ControlSelection:Qb,BookmarkManager:aa,Selection:vE,Event:Ws.Event},html:{Styles:nu,Entities:fs,Node:vt,Schema:ds,DomParser:Ko,Writer:HC,Serializer:Cs},Env:be,AddOnManager:yt,Annotator:Wb,Formatter:LE,UndoManager:FE,EditorCommands:Hk,WindowManager:AE,NotificationManager:NE,EditorObservable:qk,Shortcuts:Zk,Editor:Kl,FocusManager:EC,EditorManager:ks,DOM:Ae.DOM,ScriptLoader:Qn.ScriptLoader,PluginManager:Yo,ThemeManager:ao,ModelManager:Go,IconManager:il,Resource:B4,FakeClipboard:_4,trim:$.trim,isArray:$.isArray,is:$.is,toArray:$.toArray,makeMap:$.makeMap,each:$.each,map:$.map,grep:$.grep,inArray:$.inArray,extend:$.extend,walk:$.walk,resolve:$.resolve,explode:$.explode,_addCacheSuffix:$._addCacheSuffix},ox=$.extend(ks,L4),$4=e=>{try{rc.exports=e}catch{}};(e=>{window.tinymce=e,window.tinyMCE=e})(ox),$4(ox)})()})(U4);const T9=zm;export{T9 as t};
