import"./bootstrap.min-47e23b13.js";import"./navbar-a947fc30.js";import"./aside-c7b7c768.js";import{a as t,_ as n}from"./config-4096d6dc.js";import{S as s}from"./sweetalert2.all-9c5228de.js";const P=document.querySelectorAll("#changePassword");P.forEach(r=>{r.classList.add("onThisPage")});const S=document.querySelector("#navAside");S.classList.remove("d-none");const h=document.querySelector("#oldPassword"),g=document.querySelector("#newPassword"),v=document.querySelector("#checkNewPassword"),q=JSON.parse(localStorage.getItem("userTokenAndData")),{accessToken:y,user:l}=q;document.querySelector("#changePasswordBtn");const d=document.querySelector("#changePasswordForm");console.log(d);d.addEventListener("submit",r=>{r.preventDefault();const u=l.id,w=l.email,m=h.value,c={email:w,password:m};console.log(c),t.post(`${n}/login`,c).then(e=>{console.log("驗證登入成功"),console.log(e);const a=g.value,i=v.value;a===i?(console.log("新密碼與確認新密碼核對正確"),t.patch(`${n}/600/users/${u}`,{password:a},{headers:{authorization:`Bearer ${y}`}}).then(o=>{console.log("修改密碼成功"),console.log(o),s.fire("修改密碼成功")}).catch(o=>{console.log("修改密碼失敗"),console.log(o),s.fire("修改密碼失敗"+o.response.data)})):(s.fire("確認新密碼不正確"),document.querySelector("#oldPassword").value="",document.querySelector("#newPassword").value="",document.querySelector("#checkNewPassword").value="")}).catch(e=>{console.log("驗證登入失敗"),console.log(e.response.data),e.response.data=="Incorrect password",s.fire("舊密碼輸入錯誤"),document.querySelector("#oldPassword").value="",document.querySelector("#newPassword").value="",document.querySelector("#checkNewPassword").value=""})});
