import{a as k,_ as v}from"./config-82256151.js";import"./admin_header-36cd02a6.js";import"./admin_searchBar-2a9b901d.js";import{S as y}from"./sweetalert2.all-bdf3eb51.js";import{h as S}from"./admin_config-2cf1d757.js";import{h as x}from"./moment-fbc5633a.js";let q=document.querySelector(".tbody");const M=document.querySelector(".date"),f=document.querySelector(".before"),$=document.querySelector(".after"),g=document.querySelector(".getPages");let L=`${localStorage.getItem("thisMonth")}`,m=[],e=1,i=0;const N=k.get(`${v}/660/bookings?_expand=user&_expand=room`,S);M.textContent=L;Promise.all([N]).then(([s])=>{console.log(s.data);const u=s.data;let l=0;u.forEach(function(t){if(t.checkIn.startsWith(L)){l++;const a={};a.id=t.id,a.name=t.user.name,a.checkIn=t.checkIn,a.quantity=t.quantity,a.roomName=t.room.name,a.state=t.state,a.price=t.price,a.remark=t.remark,m.push(a)}}),o(l),h(m.slice(0,8));function o(t){if(t===0)return g.innerHTML="";i=Math.ceil(t/8);let a=` <li class="page-item previous">
                        <a class="page-link py-3 px-6 previous">Previous</a>
                    </li> `,d=`<li class="page-item next">
                        <a class="page-link py-3 px-6 next">Next</a>
                    </li>`,r="";for(let n=1;n<=i;n++)r+=`<li class="page-item pageNum" data-page="${n}"><a class="page-link py-3 px-6">${n}</a></li>`;g.innerHTML=a+r+d,b()}function b(){const t=document.querySelector(".previous"),a=document.querySelector(".next"),d=document.querySelector(".pageNum"),r=document.querySelectorAll(".pageNum");e==i&&(t.classList.add("disabled"),a.classList.add("disabled"),d.classList.add("active")),t.classList.add("disabled"),d.classList.add("active"),g.addEventListener("click",function(n){n.target.classList.contains("next")?(e++,e<=i+5&&(e>=i&&(e=i),document.querySelector(".active").classList.remove("active"),r.forEach(function(c){c.dataset.page==e&&c.classList.add("active")}),e==i&&a.classList.add("disabled"),t.classList.remove("disabled"))):n.target.classList.contains("previous")?(e--,e>=-5&&(e<=1&&(e=1),document.querySelector(".active").classList.remove("active"),r.forEach(function(c){c.dataset.page==e&&c.classList.add("active")}),e==1&&t.classList.add("disabled"),a.classList.remove("disabled"))):n.target.classList.contains("page-link")&&(e=n.target.parentElement.dataset.page,document.querySelector(".active").classList.remove("active"),r.forEach(function(c){c.dataset.page==e&&c.classList.add("active")}),e==i?a.classList.add("disabled"):a.classList.remove("disabled"),e==1?t.classList.add("disabled"):t.classList.remove("disabled"));const p=e-1;h(m.slice(p*8,(p+1)*8))})}}).catch(function(s){console.log(s)});function h(s){const u=document.querySelector(".tbody");let l="";s.forEach(function(o){l+=`<tr>
                <th class="text-nowrap border-0 text-center d-flex align-items-center justify-content-center" scope="row"><a class="bookingNum adminLink" data-bookingnum="${o.id}" href="../pages/admin_updateBooking.html">${o.id}</a></th>       
                <td class="text-nowrap text-center">${o.name}</td>
                <td class="text-nowrap text-center">${o.checkIn}</td>
                <td class="text-nowrap text-center">${o.quantity}</td>
                <td class="text-nowrap text-center">${o.roomName}</td>
                <td class="text-nowrap text-center">${o.state}</td>
                <td class="text-nowrap text-center">${o.price}</td>
                <td class="text-nowrap text-start">${o.remark}</td>
            </tr>`}),u.innerHTML=l}f.addEventListener("click",function(){let s=x(localStorage.getItem("thisMonth")).add(-1,"month").format("YYYY-MM");if(s==="2023-08"){y.fire({title:"抱歉並無2023-09以前的資料",icon:"error"}),f.setAttribute("disabled",!0);return}localStorage.setItem("thisMonth",s),location.reload()});$.addEventListener("click",function(){let s=x(localStorage.getItem("thisMonth")).add(1,"month").format("YYYY-MM");localStorage.setItem("thisMonth",s),location.reload()});q.addEventListener("click",function(s){s.target.classList.contains("bookingNum")&&localStorage.setItem("bookingNum",s.target.dataset.bookingnum)});
