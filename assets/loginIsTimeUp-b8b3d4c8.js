import{S as o,a as i,_ as l}from"./sweetalert2.all-203b6da2.js";import{h as s}from"./admin_header-cdcf5a9d.js";function d(a){const e={};a==="jwt expired"?o.fire({title:"您的帳號登入已逾時, 請重新登入",input:"email",inputLabel:"您的帳號",inputPlaceholder:"Enter your email address"}).then(({value:t})=>(e.email=t,o.fire({title:"請輸入您的密碼",input:"password",inputLabel:"Password",inputPlaceholder:"Enter your password",inputAttributes:{maxlength:"20",autocapitalize:"off",autocorrect:"off"}}))).then(({value:t})=>{e.password=t,n(e)}):a==="jwt malformed"&&o.fire({title:"訪問權限不足, 請嘗試重新登入",input:"email",inputLabel:"您的帳號",inputPlaceholder:"Enter your email address"}).then(({value:t})=>(e.email=t,o.fire({title:"請輸入您的密碼",input:"password",inputLabel:"Password",inputPlaceholder:"Enter your password",inputAttributes:{maxlength:"20",autocapitalize:"off",autocorrect:"off"}}))).then(({value:t})=>{e.password=t,n(e)})}function n(a){i.post(`${l}/login`,a).then(function(e){if(console.log(e),e.data.user.role==="admin"){console.log(e.data);let t=s().format("YYYY年MM月DD日 HH:mm:ss");localStorage.setItem("userLoginTime",t),localStorage.setItem("userRole",e.data.user.role),localStorage.setItem("userName",e.data.user.name),localStorage.setItem("userId",e.data.user.id),localStorage.setItem("userLoginToken",e.data.accessToken),i.patch(`${l}/users/${e.data.user.id}`,{lastLoginTime:`${t}`}).then(function(){location.reload()}).catch(function(r){console.log(r)})}else console.log("非管理員"),o.fire({title:"你是誰?",text:"你怎麼會來這裡?",icon:"info",confirmButtonColor:"#3085d6"}).then(t=>{t.isConfirmed&&(location="index.html")})}).catch(function(e){console.log(e.response.data)})}export{d as r};
