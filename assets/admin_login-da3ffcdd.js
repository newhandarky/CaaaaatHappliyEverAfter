import{a,_ as o}from"./sweetalert2.all-203b6da2.js";import{h as u}from"./admin_header-cdcf5a9d.js";const r=document.querySelector(".errorText"),t=document.querySelector("#adminLoginAccount"),n=document.querySelector("#adminLoginPassword"),m=document.querySelector(".adminLoginBtn");let s={};m.addEventListener("click",function(d){if(t.value.length>21||t.value.length<21||n.value.length>11||n.value.length<11||t.value===""||n.value===""||t.value.slice(0,11)!==n.value){r.classList.add("d-flex","align-items-center","text-danger","fs-5","mb-6"),r.innerHTML='<span class="material-symbols-outlined me-1"> error </span>信箱或密碼不正確',t.value="",n.value="";return}s.email=t.value,s.password=n.value;let l=parseInt(t.value.slice(9,11),10);a.get(`${o}/users/10${l}`).then(function(e){e.data.role!=="admin"&&(location.href="index.html")}).then(function(){a.post(`${o}/login`,s).then(function(e){const c=e.data.accessToken;localStorage.setItem("userLoginToken",c),localStorage.setItem("userName",e.data.user.name),localStorage.setItem("userId",e.data.user.id),localStorage.setItem("userRole",e.data.user.role);let i=u().format("YYYY年MM月DD日 HH:mm:ss");localStorage.setItem("userLoginTime",i),a.patch(`${o}/users/10${l}`,{lastLoginTime:`${i}`}).then(function(){location.href="admin_index.html"})}).catch(function(e){console.error("Login failed:",e.response?e.response.data:e.message)})})});
