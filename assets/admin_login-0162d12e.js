import{a as n,_ as a}from"./config-d9eb516d.js";import"./admin_header-8cd8039b.js";import"./sweetalert2.all-2959760f.js";const r=document.querySelector(".errorText"),t=document.querySelector("#adminLoginAccount"),o=document.querySelector("#adminLoginPassword"),m=document.querySelector(".adminLoginBtn");let l={};m.addEventListener("click",function(){if(t.value.length>21||t.value.length<21||o.value.length>11||o.value.length<11||t.value===""||o.value===""||t.value.slice(0,11)!==o.value){r.classList.add("d-flex","align-items-center","text-danger","fs-5","mb-6"),r.innerHTML='<span class="material-symbols-outlined me-1"> error </span>信箱或密碼不正確',t.value="",o.value="";return}l.email=t.value,l.password=o.value;let i=parseInt(t.value.slice(9,11));n.get(`${a}/users/10${i}`).then(function(e){console.log(e),e.data.role!=="admin"&&(location.href="index.html")}).then(function(){n.post(`${a}/login`,l).then(function(e){console.log(e),console.log(e.data);const c=e.data.accessToken;localStorage.setItem("userLoginToken",c),localStorage.setItem("userName",e.data.user.name),localStorage.setItem("userId",e.data.user.id),localStorage.setItem("userRole",e.data.user.role),location.href="admin_index.html";var u=new Date,s=u.toISOString();localStorage.setItem("userLoginTime",s),n.patch(`${a}/users/${i}`,{lastLoginTime:`${s}`})}).catch(function(e){console.error("Login failed:",e.response?e.response.data:e.message)})})});
